var __define=this.__define||function(t,e,i,a){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i,set:a})},dragonBones;!function(t){var e=function(){function e(t){this._animationStateCount=0,this._armature=t,this._animationList=[],this._animationStateList=[],this._timeScale=1,this._isPlaying=!1,this.tweenEnabled=!0}var i=__define,a=e;return p=a.prototype,p.dispose=function(){this._armature&&(this._resetAnimationStateList(),this._animationList.length=0,this._armature=null,this._animationDataList=null,this._animationList=null,this._animationStateList=null)},p._resetAnimationStateList=function(){for(var e,i=this._animationStateList.length;i--;)e=this._animationStateList[i],e._resetTimelineStateList(),t.AnimationState._returnObject(e);this._animationStateList.length=0},p.gotoAndPlay=function(i,a,n,s,r,o,l,h,u){if(void 0===a&&(a=-1),void 0===n&&(n=-1),void 0===s&&(s=0/0),void 0===r&&(r=0),void 0===o&&(o=null),void 0===l&&(l=e.SAME_LAYER_AND_GROUP),void 0===h&&(h=!0),void 0===u&&(u=!0),!this._animationDataList)return null;for(var _,m=this._animationDataList.length;m--;)if(this._animationDataList[m].name==i){_=this._animationDataList[m];break}if(!_)return null;this._isPlaying=!0,this._isFading=!0,a=0>a?_.fadeTime<0?.3:_.fadeTime:a;var f;f=0>n?_.scale<0?1:_.scale:1e3*n/_.duration,s=isNaN(s)?_.playTimes:s;var d;switch(l){case e.NONE:break;case e.SAME_LAYER:for(m=this._animationStateList.length;m--;)d=this._animationStateList[m],d.layer==r&&d.fadeOut(a,h);break;case e.SAME_GROUP:for(m=this._animationStateList.length;m--;)d=this._animationStateList[m],d.group==o&&d.fadeOut(a,h);break;case e.ALL:for(m=this._animationStateList.length;m--;)d=this._animationStateList[m],d.fadeOut(a,h);break;case e.SAME_LAYER_AND_GROUP:default:for(m=this._animationStateList.length;m--;)d=this._animationStateList[m],d.layer==r&&d.group==o&&d.fadeOut(a,h)}this._lastAnimationState=t.AnimationState._borrowObject(),this._lastAnimationState._layer=r,this._lastAnimationState._group=o,this._lastAnimationState.autoTween=this.tweenEnabled,this._lastAnimationState._fadeIn(this._armature,_,a,1/f,s,u),this.addState(this._lastAnimationState);var p=this._armature.getSlots(!1);for(m=p.length;m--;){var c=p[m];c.childArmature&&c.childArmature.animation.gotoAndPlay(i,a)}return this._lastAnimationState},p.gotoAndStop=function(t,i,a,n,s,r,o,l){void 0===a&&(a=-1),void 0===n&&(n=0),void 0===s&&(s=-1),void 0===r&&(r=0),void 0===o&&(o=null),void 0===l&&(l=e.ALL);var h=this.getState(t,r);return h||(h=this.gotoAndPlay(t,n,s,0/0,r,o,l)),h.setCurrentTime(a>=0?h.totalTime*a:i),h.stop(),h},p.play=function(){this._animationDataList&&0!=this._animationDataList.length&&(this._lastAnimationState?this._isPlaying?this.gotoAndPlay(this._lastAnimationState.name):this._isPlaying=!0:this.gotoAndPlay(this._animationDataList[0].name))},p.stop=function(){this._isPlaying=!1},p.getState=function(t,e){void 0===e&&(e=0);for(var i=this._animationStateList.length;i--;){var a=this._animationStateList[i];if(a.name==t&&a.layer==e)return a}return null},p.hasAnimation=function(t){for(var e=this._animationDataList.length;e--;)if(this._animationDataList[e].name==t)return!0;return!1},p._advanceTime=function(t){if(this._isPlaying){var e=!1;t*=this._timeScale;for(var i=this._animationStateList.length;i--;){var a=this._animationStateList[i];a._advanceTime(t)?this.removeState(a):1!=a.fadeState&&(e=!0)}this._isFading=e}},p._updateAnimationStates=function(){for(var t=this._animationStateList.length;t--;)this._animationStateList[t]._updateTimelineStates()},p.addState=function(t){this._animationStateList.indexOf(t)<0&&(this._animationStateList.unshift(t),this._animationStateCount=this._animationStateList.length)},p.removeState=function(e){var i=this._animationStateList.indexOf(e);i>=0&&(this._animationStateList.splice(i,1),t.AnimationState._returnObject(e),this._lastAnimationState==e&&(this._lastAnimationState=this._animationStateList.length>0?this._animationStateList[0]:null),this._animationStateCount=this._animationStateList.length)},i(p,"movementList",function(){return this._animationList}),i(p,"movementID",function(){return this.lastAnimationName}),i(p,"lastAnimationState",function(){return this._lastAnimationState}),i(p,"lastAnimationName",function(){return this._lastAnimationState?this._lastAnimationState.name:null}),i(p,"animationList",function(){return this._animationList}),i(p,"isPlaying",function(){return this._isPlaying&&!this.isComplete}),i(p,"isComplete",function(){if(this._lastAnimationState){if(!this._lastAnimationState.isComplete)return!1;for(var t=this._animationStateList.length;t--;)if(!this._animationStateList[t].isComplete)return!1;return!0}return!0}),i(p,"timeScale",function(){return this._timeScale},function(t){(isNaN(t)||0>t)&&(t=1),this._timeScale=t}),i(p,"animationDataList",function(){return this._animationDataList},function(t){this._animationDataList=t,this._animationList.length=0;for(var e=0,i=this._animationDataList.length;i>e;e++){var a=this._animationDataList[e];this._animationList[this._animationList.length]=a.name}}),e.NONE="none",e.SAME_LAYER="sameLayer",e.SAME_GROUP="sameGroup",e.SAME_LAYER_AND_GROUP="sameLayerAndGroup",e.ALL="all",e}();t.Animation=e,egret.registerClass(e,"dragonBones.Animation")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._layer=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._currentPlayTimes=0,this._totalTime=0,this._currentTime=0,this._lastTime=0,this._fadeState=0,this._playTimes=0,this._timelineStateList=[],this._slotTimelineStateList=[],this._boneMasks=[]}var i=__define,a=e;return p=a.prototype,e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){t.clear(),e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t)},e._clear=function(){for(var i=e._pool.length;i--;)e._pool[i].clear();e._pool.length=0,t.TimelineState._clear()},p.clear=function(){this._resetTimelineStateList(),this._boneMasks.length=0,this._armature=null,this._clip=null},p._resetTimelineStateList=function(){for(var e=this._timelineStateList.length;e--;)t.TimelineState._returnObject(this._timelineStateList[e]);for(this._timelineStateList.length=0,e=this._slotTimelineStateList.length;e--;)t.SlotTimelineState._returnObject(this._slotTimelineStateList[e]);this._slotTimelineStateList.length=0},p.containsBoneMask=function(t){return 0==this._boneMasks.length||this._boneMasks.indexOf(t)>=0},p.addBoneMask=function(t,e){if(void 0===e&&(e=!0),this.addBoneToBoneMask(t),e){var i=this._armature.getBone(t);if(i)for(var a=this._armature.getBones(!1),n=a.length;n--;){var s=a[n];i.contains(s)&&this.addBoneToBoneMask(s.name)}}return this._updateTimelineStates(),this},p.removeBoneMask=function(t,e){if(void 0===e&&(e=!0),this.removeBoneFromBoneMask(t),e){var i=this._armature.getBone(t);if(i)for(var a=this._armature.getBones(!1),n=a.length;n--;){var s=a[n];i.contains(s)&&this.removeBoneFromBoneMask(s.name)}}return this._updateTimelineStates(),this},p.removeAllMixingTransform=function(){return this._boneMasks.length=0,this._updateTimelineStates(),this},p.addBoneToBoneMask=function(t){this._clip.getTimeline(t)&&this._boneMasks.indexOf(t)<0&&this._boneMasks.push(t)},p.removeBoneFromBoneMask=function(t){var e=this._boneMasks.indexOf(t);e>=0&&this._boneMasks.splice(e,1)},p._updateTimelineStates=function(){for(var t,e,i,a=this._timelineStateList.length;a--;)t=this._timelineStateList[a],this._armature.getBone(t.name)||this.removeTimelineState(t);for(a=this._slotTimelineStateList.length;a--;)e=this._slotTimelineStateList[a],this._armature.getSlot(e.name)||this.removeSlotTimelineState(e);if(this._boneMasks.length>0){for(a=this._timelineStateList.length;a--;)t=this._timelineStateList[a],this._boneMasks.indexOf(t.name)<0&&this.removeTimelineState(t);for(a=0,i=this._boneMasks.length;i>a;a++){var n=this._boneMasks[a];this.addTimelineState(n)}}else for(a=0,i=this._clip.timelineList.length;i>a;a++){var s=this._clip.timelineList[a];this.addTimelineState(s.name)}for(a=0,i=this._clip.slotTimelineList.length;i>a;a++){var r=this._clip.slotTimelineList[a];this.addSlotTimelineState(r.name)}},p.addTimelineState=function(e){var i=this._armature.getBone(e);if(i){for(var a=0,n=this._timelineStateList.length;n>a;a++){var s=this._timelineStateList[a];if(s.name==e)return}var r=t.TimelineState._borrowObject();r._fadeIn(i,this,this._clip.getTimeline(e)),this._timelineStateList.push(r)}},p.removeTimelineState=function(e){var i=this._timelineStateList.indexOf(e);this._timelineStateList.splice(i,1),t.TimelineState._returnObject(e)},p.addSlotTimelineState=function(e){var i=this._armature.getSlot(e);if(i){for(var a=0,n=this._slotTimelineStateList.length;n>a;a++){var s=this._slotTimelineStateList[a];if(s.name==e)return}var r=t.SlotTimelineState._borrowObject();r._fadeIn(i,this,this._clip.getSlotTimeline(e)),this._slotTimelineStateList.push(r)}},p.removeSlotTimelineState=function(e){var i=this._slotTimelineStateList.indexOf(e);this._slotTimelineStateList.splice(i,1),t.SlotTimelineState._returnObject(e)},p.play=function(){return this._isPlaying=!0,this},p.stop=function(){return this._isPlaying=!1,this},p._fadeIn=function(t,e,i,a,n,s){return this._armature=t,this._clip=e,this._pausePlayheadInFade=s,this._name=this._clip.name,this._totalTime=this._clip.duration,this.autoTween=this._clip.autoTween,this.setTimeScale(a),this.setPlayTimes(n),this._isComplete=!1,this._currentFrameIndex=-1,this._currentPlayTimes=-1,this._currentTime=Math.round(this._totalTime*this._clip.frameRate*.001)<2||1/0==a?this._totalTime:-1,this._time=0,this._boneMasks.length=0,this._isFadeOut=!1,this._fadeWeight=0,this._fadeTotalWeight=1,this._fadeState=-1,this._fadeCurrentTime=0,this._fadeBeginTime=this._fadeCurrentTime,this._fadeTotalTime=i*this._timeScale,this._isPlaying=!0,this.displayControl=!0,this.lastFrameAutoTween=!0,this.additiveBlending=!1,this.weight=1,this.fadeOutTime=i,this._updateTimelineStates(),this},p.fadeOut=function(t,e){if(!this._armature)return null;if((isNaN(t)||0>t)&&(t=0),this._pausePlayheadInFade=e,this._isFadeOut){if(t>this._fadeTotalTime/this._timeScale-(this._fadeCurrentTime-this._fadeBeginTime))return this}else for(var i=0,a=this._timelineStateList.length;a>i;i++){var n=this._timelineStateList[i];n._fadeOut()}return this._isFadeOut=!0,this._fadeTotalWeight=this._fadeWeight,this._fadeState=-1,this._fadeBeginTime=this._fadeCurrentTime,this._fadeTotalTime=this._fadeTotalWeight>=0?t*this._timeScale:0,this.displayControl=!1,this},p._advanceTime=function(t){return t*=this._timeScale,this.advanceFadeTime(t),this._fadeWeight&&this.advanceTimelinesTime(t),this._isFadeOut&&1==this._fadeState},p.advanceFadeTime=function(e){var i=!1,a=!1;if(this._fadeBeginTime>=0){var n=this._fadeState;this._fadeCurrentTime+=0>e?-e:e,this._fadeCurrentTime>=this._fadeBeginTime+this._fadeTotalTime?((1==this._fadeWeight||0==this._fadeWeight)&&(n=1,this._pausePlayheadInFade&&(this._pausePlayheadInFade=!1,this._currentTime=-1)),this._fadeWeight=this._isFadeOut?0:1):this._fadeCurrentTime>=this._fadeBeginTime?(n=0,this._fadeWeight=(this._fadeCurrentTime-this._fadeBeginTime)/this._fadeTotalTime*this._fadeTotalWeight,this._isFadeOut&&(this._fadeWeight=this._fadeTotalWeight-this._fadeWeight)):(n=-1,this._fadeWeight=this._isFadeOut?1:0),this._fadeState!=n&&(-1==this._fadeState&&(i=!0),1==n&&(a=!0),this._fadeState=n)}var s;i&&(this._isFadeOut?this._armature.hasEventListener(t.AnimationEvent.FADE_OUT)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_OUT),s.animationState=this,this._armature._eventList.push(s)):(this.hideBones(),this._armature.hasEventListener(t.AnimationEvent.FADE_IN)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_IN),s.animationState=this,this._armature._eventList.push(s)))),a&&(this._isFadeOut?this._armature.hasEventListener(t.AnimationEvent.FADE_OUT_COMPLETE)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_OUT_COMPLETE),s.animationState=this,this._armature._eventList.push(s)):this._armature.hasEventListener(t.AnimationEvent.FADE_IN_COMPLETE)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_IN_COMPLETE),s.animationState=this,this._armature._eventList.push(s)))},p.advanceTimelinesTime=function(e){this._isPlaying&&!this._pausePlayheadInFade&&(this._time+=e);var i=!1,a=!1,n=!1,s=!1,r=0,o=1e3*this._time;if(0==this._playTimes)s=!1,r=Math.ceil(Math.abs(o)/this._totalTime)||1,o-=o>=0?Math.floor(o/this._totalTime)*this._totalTime:Math.ceil(o/this._totalTime)*this._totalTime,0>o&&(o+=this._totalTime);else{var l=this._playTimes*this._totalTime;o>=l?(o=l,s=!0):-l>=o?(o=-l,s=!0):s=!1,0>o&&(o+=l),r=Math.ceil(o/this._totalTime)||1,o-=o>=0?Math.floor(o/this._totalTime)*this._totalTime:Math.ceil(o/this._totalTime)*this._totalTime,s&&(o=this._totalTime)}this._isComplete=s;var h=1e3*this._time/this._totalTime,u=0,_=0;for(u=0,_=this._timelineStateList.length;_>u;u++){var m=this._timelineStateList[u];m._update(h),this._isComplete=m._isComplete&&this._isComplete}for(u=0,_=this._slotTimelineStateList.length;_>u;u++){var f=this._slotTimelineStateList[u];f._update(h),this._isComplete=m._isComplete&&this._isComplete}this._currentTime!=o&&(this._currentPlayTimes!=r&&(this._currentPlayTimes>0&&r>1&&(n=!0),this._currentPlayTimes=r),this._currentTime<0&&(i=!0),this._isComplete&&(a=!0),this._lastTime=this._currentTime,this._currentTime=o,this.updateMainTimeline(s));var d;i&&this._armature.hasEventListener(t.AnimationEvent.START)&&(d=new t.AnimationEvent(t.AnimationEvent.START),d.animationState=this,this._armature._eventList.push(d)),a?(this._armature.hasEventListener(t.AnimationEvent.COMPLETE)&&(d=new t.AnimationEvent(t.AnimationEvent.COMPLETE),d.animationState=this,this._armature._eventList.push(d)),this.autoFadeOut&&this.fadeOut(this.fadeOutTime,!0)):n&&this._armature.hasEventListener(t.AnimationEvent.LOOP_COMPLETE)&&(d=new t.AnimationEvent(t.AnimationEvent.LOOP_COMPLETE),d.animationState=this,this._armature._eventList.push(d))},p.updateMainTimeline=function(t){var e=this._clip.frameList;if(e.length>0){for(var i,a,n=0,s=this._clip.frameList.length;s>n;++n){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._currentFrameIndex++,this._lastTime=this._currentTime,this._currentFrameIndex>=e.length){if(t){this._currentFrameIndex--;break}this._currentFrameIndex=0}}a=e[this._currentFrameIndex],i&&this._armature._arriveAtFrame(i,null,this,!0),this._currentFrameDuration=a.duration,this._currentFramePosition=a.position,i=a}a&&this._armature._arriveAtFrame(a,null,this,!1)}},p.hideBones=function(){for(var t=0,e=this._clip.hideTimelineNameMap.length;e>t;t++){var i=this._clip.hideTimelineNameMap[t],a=this._armature.getBone(i);a&&a._hideSlots()}},p.setAdditiveBlending=function(t){return this.additiveBlending=t,this},p.setAutoFadeOut=function(t,e){return void 0===e&&(e=-1),this.autoFadeOut=t,e>=0&&(this.fadeOutTime=e*this._timeScale),this},p.setWeight=function(t){return(isNaN(t)||0>t)&&(t=1),this.weight=t,this},p.setFrameTween=function(t,e){return this.autoTween=t,this.lastFrameAutoTween=e,this},p.setCurrentTime=function(t){return(0>t||isNaN(t))&&(t=0),this._time=t,this._currentTime=1e3*this._time,this},p.setTimeScale=function(t){return(isNaN(t)||1/0==t)&&(t=1),this._timeScale=t,this},p.setPlayTimes=function(t){return void 0===t&&(t=0),this._playTimes=Math.round(.001*this._totalTime*this._clip.frameRate)<2?0>t?-1:1:0>t?-t:t,this.autoFadeOut=0>t?!0:!1,this},i(p,"name",function(){return this._name}),i(p,"layer",function(){return this._layer}),i(p,"group",function(){return this._group}),i(p,"clip",function(){return this._clip}),i(p,"isComplete",function(){return this._isComplete}),i(p,"isPlaying",function(){return this._isPlaying&&!this._isComplete}),i(p,"currentPlayTimes",function(){return this._currentPlayTimes<0?0:this._currentPlayTimes}),i(p,"totalTime",function(){return.001*this._totalTime}),i(p,"currentTime",function(){return this._currentTime<0?0:.001*this._currentTime}),i(p,"fadeWeight",function(){return this._fadeWeight}),i(p,"fadeState",function(){return this._fadeState}),i(p,"fadeTotalTime",function(){return this._fadeTotalTime}),i(p,"timeScale",function(){return this._timeScale}),i(p,"playTimes",function(){return this._playTimes}),e._pool=[],e}();t.AnimationState=e,egret.registerClass(e,"dragonBones.AnimationState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._durationColor=new t.ColorTransform}var i=e;return p=i.prototype,e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e._clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},p.clear=function(){this._slot&&(this._slot._removeState(this),this._slot=null),this._armature=null,this._animation=null,this._animationState=null,this._timelineData=null},p._fadeIn=function(t,e,i){switch(this._slot=t,this._armature=this._slot.armature,this._animation=this._armature.animation,this._animationState=e,this._timelineData=i,this.name=i.name,this._totalTime=this._timelineData.duration,this._rawAnimationScale=this._animationState.clip.scale,this._isComplete=!1,this._blendEnabled=!1,this._tweenColor=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._weight=1,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}this._slot._addState(this)},p._fadeOut=function(){},p._update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},p.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration))break;if(this._currentFrameIndex++,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._slot._arriveAtFrame(s,this,this._animationState,!0),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._slot._arriveAtFrame(r,this,this._animationState,!1),this._blendEnabled=r.displayIndex>=0,this._blendEnabled?this.updateToNextFrame(e):(this._tweenEasing=0/0,this._tweenColor=!1)),this._blendEnabled&&this.updateTween()}},p.updateToNextFrame=function(t){void 0===t&&(t=0);var e=this._currentFrameIndex+1;e>=this._timelineData.frameList.length&&(e=0);var i=this._timelineData.frameList[this._currentFrameIndex],a=this._timelineData.frameList[e],n=!1;0==e&&(!this._animationState.lastFrameAutoTween||this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+t-this._timelineData.offset)*this._timelineData.scale>.999999)?(this._tweenEasing=0/0,n=!1):i.displayIndex<0||a.displayIndex<0?(this._tweenEasing=0/0,n=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=i.tweenEasing,this._tweenCurve=i.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?n=!1:(10==this._tweenEasing&&(this._tweenEasing=0),n=!0)):n=!0):(this._tweenEasing=i.tweenEasing,this._tweenCurve=i.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?n=!0:(this._tweenEasing=0/0,n=!1)),n?i.color&&a.color?(this._durationColor.alphaOffset=a.color.alphaOffset-i.color.alphaOffset,this._durationColor.redOffset=a.color.redOffset-i.color.redOffset,this._durationColor.greenOffset=a.color.greenOffset-i.color.greenOffset,this._durationColor.blueOffset=a.color.blueOffset-i.color.blueOffset,this._durationColor.alphaMultiplier=a.color.alphaMultiplier-i.color.alphaMultiplier,this._durationColor.redMultiplier=a.color.redMultiplier-i.color.redMultiplier,this._durationColor.greenMultiplier=a.color.greenMultiplier-i.color.greenMultiplier,this._durationColor.blueMultiplier=a.color.blueMultiplier-i.color.blueMultiplier,this._tweenColor=this._durationColor.alphaOffset||this._durationColor.redOffset||this._durationColor.greenOffset||this._durationColor.blueOffset||this._durationColor.alphaMultiplier||this._durationColor.redMultiplier||this._durationColor.greenMultiplier||this._durationColor.blueMultiplier?!0:!1):i.color?(this._tweenColor=!0,this._durationColor.alphaOffset=-i.color.alphaOffset,this._durationColor.redOffset=-i.color.redOffset,this._durationColor.greenOffset=-i.color.greenOffset,this._durationColor.blueOffset=-i.color.blueOffset,this._durationColor.alphaMultiplier=1-i.color.alphaMultiplier,this._durationColor.redMultiplier=1-i.color.redMultiplier,this._durationColor.greenMultiplier=1-i.color.greenMultiplier,this._durationColor.blueMultiplier=1-i.color.blueMultiplier):a.color?(this._tweenColor=!0,this._durationColor.alphaOffset=a.color.alphaOffset,this._durationColor.redOffset=a.color.redOffset,this._durationColor.greenOffset=a.color.greenOffset,this._durationColor.blueOffset=a.color.blueOffset,this._durationColor.alphaMultiplier=a.color.alphaMultiplier-1,this._durationColor.redMultiplier=a.color.redMultiplier-1,this._durationColor.greenMultiplier=a.color.greenMultiplier-1,this._durationColor.blueMultiplier=a.color.blueMultiplier-1):this._tweenColor=!1:this._tweenColor=!1,!this._tweenColor&&this._animationState.displayControl&&(i.color?this._slot._updateDisplayColor(i.color.alphaOffset,i.color.redOffset,i.color.greenOffset,i.color.blueOffset,i.color.alphaMultiplier,i.color.redMultiplier,i.color.greenMultiplier,i.color.blueMultiplier,!0):this._slot._isColorChanged&&this._slot._updateDisplayColor(0,0,0,0,1,1,1,1,!1))},p.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];if(this._tweenColor&&this._animationState.displayControl){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve?i=this._tweenCurve.getValueByProgress(i):this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing)),e.color?this._slot._updateDisplayColor(e.color.alphaOffset+this._durationColor.alphaOffset*i,e.color.redOffset+this._durationColor.redOffset*i,e.color.greenOffset+this._durationColor.greenOffset*i,e.color.blueOffset+this._durationColor.blueOffset*i,e.color.alphaMultiplier+this._durationColor.alphaMultiplier*i,e.color.redMultiplier+this._durationColor.redMultiplier*i,e.color.greenMultiplier+this._durationColor.greenMultiplier*i,e.color.blueMultiplier+this._durationColor.blueMultiplier*i,!0):this._slot._updateDisplayColor(this._durationColor.alphaOffset*i,this._durationColor.redOffset*i,this._durationColor.greenOffset*i,this._durationColor.blueOffset*i,1+this._durationColor.alphaMultiplier*i,1+this._durationColor.redMultiplier*i,1+this._durationColor.greenMultiplier*i,1+this._durationColor.blueMultiplier*i,!0)}},p.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._slot._arriveAtFrame(t,this,this._animationState,!1),this._isComplete=!0,this._tweenEasing=0/0,this._tweenColor=!1,this._blendEnabled=t.displayIndex>=0,this._blendEnabled&&this._animationState.displayControl&&(t.color?this._slot._updateDisplayColor(t.color.alphaOffset,t.color.redOffset,t.color.greenOffset,t.color.blueOffset,t.color.alphaMultiplier,t.color.redMultiplier,t.color.greenMultiplier,t.color.blueMultiplier,!0):this._slot._isColorChanged&&this._slot._updateDisplayColor(0,0,0,0,1,1,1,1,!1))},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._pool=[],e}();t.SlotTimelineState=e,egret.registerClass(e,"dragonBones.SlotTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._lastTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._transform=new t.DBTransform,this._pivot=new t.Point,this._durationTransform=new t.DBTransform,this._durationPivot=new t.Point,this._durationColor=new t.ColorTransform}var i=e;return p=i.prototype,e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e._clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},p.clear=function(){this._bone&&(this._bone._removeState(this),this._bone=null),this._armature=null,this._animation=null,this._animationState=null,this._timelineData=null,this._originTransform=null,this._originPivot=null},p._fadeIn=function(t,e,i){switch(this._bone=t,this._armature=this._bone.armature,this._animation=this._armature.animation,this._animationState=e,this._timelineData=i,this._originTransform=this._timelineData.originTransform,this._originPivot=this._timelineData.originPivot,this.name=i.name,this._totalTime=this._timelineData.duration,this._rawAnimationScale=this._animationState.clip.scale,this._isComplete=!1,this._blendEnabled=!1,this._tweenTransform=!1,this._tweenScale=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._weight=1,this._transform.x=0,this._transform.y=0,this._transform.scaleX=1,this._transform.scaleY=1,this._transform.skewX=0,this._transform.skewY=0,this._pivot.x=0,this._pivot.y=0,this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.scaleX=1,this._durationTransform.scaleY=1,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationPivot.x=0,this._durationPivot.y=0,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}this._bone._addState(this)},p._fadeOut=function(){this._transform.skewX=t.TransformUtil.formatRadian(this._transform.skewX),this._transform.skewY=t.TransformUtil.formatRadian(this._transform.skewY)},p._update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},p.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._lastTime=this._currentTime,this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._currentFrameIndex++,this._lastTime=this._currentTime,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._bone._arriveAtFrame(s,this,this._animationState,!0),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._bone._arriveAtFrame(r,this,this._animationState,!1),this._blendEnabled=!isNaN(r.tweenEasing),this._blendEnabled?this.updateToNextFrame(e):(this._tweenEasing=0/0,this._tweenTransform=!1,this._tweenScale=!1,this._tweenColor=!1)),this._blendEnabled&&this.updateTween()}},p.updateToNextFrame=function(e){void 0===e&&(e=0);var i=this._currentFrameIndex+1;i>=this._timelineData.frameList.length&&(i=0);var a=this._timelineData.frameList[this._currentFrameIndex],n=this._timelineData.frameList[i],s=!1;0==i&&(!this._animationState.lastFrameAutoTween||this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timelineData.offset)*this._timelineData.scale>.999999)?(this._tweenEasing=0/0,s=!1):a.displayIndex<0||n.displayIndex<0?(this._tweenEasing=0/0,s=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?s=!1:(10==this._tweenEasing&&(this._tweenEasing=0),s=!0)):s=!0):(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?s=!0:(this._tweenEasing=0/0,s=!1)),s?(this._durationTransform.x=n.transform.x-a.transform.x,this._durationTransform.y=n.transform.y-a.transform.y,this._durationTransform.skewX=n.transform.skewX-a.transform.skewX,this._durationTransform.skewY=n.transform.skewY-a.transform.skewY,this._durationTransform.scaleX=n.transform.scaleX-a.transform.scaleX+n.scaleOffset.x,this._durationTransform.scaleY=n.transform.scaleY-a.transform.scaleY+n.scaleOffset.y,this._durationTransform.normalizeRotation(),0==i&&(this._durationTransform.skewX=t.TransformUtil.formatRadian(this._durationTransform.skewX),this._durationTransform.skewY=t.TransformUtil.formatRadian(this._durationTransform.skewY)),this._durationPivot.x=n.pivot.x-a.pivot.x,this._durationPivot.y=n.pivot.y-a.pivot.y,this._durationTransform.x||this._durationTransform.y||this._durationTransform.skewX||this._durationTransform.skewY||this._durationTransform.scaleX||this._durationTransform.scaleY||this._durationPivot.x||this._durationPivot.y?(this._tweenTransform=!0,this._tweenScale=a.tweenScale):(this._tweenTransform=!1,this._tweenScale=!1)):(this._tweenTransform=!1,this._tweenScale=!1),this._tweenTransform?this._tweenScale||(this._animationState.additiveBlending?(this._transform.scaleX=a.transform.scaleX,this._transform.scaleY=a.transform.scaleY):(this._transform.scaleX=this._originTransform.scaleX*a.transform.scaleX,this._transform.scaleY=this._originTransform.scaleY*a.transform.scaleY)):(this._animationState.additiveBlending?(this._transform.x=a.transform.x,this._transform.y=a.transform.y,this._transform.skewX=a.transform.skewX,this._transform.skewY=a.transform.skewY,this._transform.scaleX=a.transform.scaleX,this._transform.scaleY=a.transform.scaleY,this._pivot.x=a.pivot.x,this._pivot.y=a.pivot.y):(this._transform.x=this._originTransform.x+a.transform.x,this._transform.y=this._originTransform.y+a.transform.y,this._transform.skewX=this._originTransform.skewX+a.transform.skewX,this._transform.skewY=this._originTransform.skewY+a.transform.skewY,this._transform.scaleX=this._originTransform.scaleX*a.transform.scaleX,this._transform.scaleY=this._originTransform.scaleY*a.transform.scaleY,this._pivot.x=this._originPivot.x+a.pivot.x,this._pivot.y=this._originPivot.y+a.pivot.y),this._bone.invalidUpdate())},p.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];
if(this._tweenTransform){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve?i=this._tweenCurve.getValueByProgress(i):this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing));var a=e.transform,n=e.pivot;this._animationState.additiveBlending?(this._transform.x=a.x+this._durationTransform.x*i,this._transform.y=a.y+this._durationTransform.y*i,this._transform.skewX=a.skewX+this._durationTransform.skewX*i,this._transform.skewY=a.skewY+this._durationTransform.skewY*i,this._tweenScale&&(this._transform.scaleX=a.scaleX+this._durationTransform.scaleX*i,this._transform.scaleY=a.scaleY+this._durationTransform.scaleY*i),this._pivot.x=n.x+this._durationPivot.x*i,this._pivot.y=n.y+this._durationPivot.y*i):(this._transform.x=this._originTransform.x+a.x+this._durationTransform.x*i,this._transform.y=this._originTransform.y+a.y+this._durationTransform.y*i,this._transform.skewX=this._originTransform.skewX+a.skewX+this._durationTransform.skewX*i,this._transform.skewY=this._originTransform.skewY+a.skewY+this._durationTransform.skewY*i,this._tweenScale&&(this._transform.scaleX=this._originTransform.scaleX*a.scaleX+this._durationTransform.scaleX*i,this._transform.scaleY=this._originTransform.scaleY*a.scaleY+this._durationTransform.scaleY*i),this._pivot.x=this._originPivot.x+n.x+this._durationPivot.x*i,this._pivot.y=this._originPivot.y+n.y+this._durationPivot.y*i),this._bone.invalidUpdate()}},p.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._bone._arriveAtFrame(t,this,this._animationState,!1),this._isComplete=!0,this._tweenEasing=0/0,this._tweenTransform=!1,this._tweenScale=!1,this._tweenColor=!1,this._blendEnabled=t.displayIndex>=0,this._blendEnabled&&(this._animationState.additiveBlending?(this._transform.x=t.transform.x,this._transform.y=t.transform.y,this._transform.skewX=t.transform.skewX,this._transform.skewY=t.transform.skewY,this._transform.scaleX=t.transform.scaleX,this._transform.scaleY=t.transform.scaleY,this._pivot.x=t.pivot.x,this._pivot.y=t.pivot.y):(this._transform.x=this._originTransform.x+t.transform.x,this._transform.y=this._originTransform.y+t.transform.y,this._transform.skewX=this._originTransform.skewX+t.transform.skewX,this._transform.skewY=this._originTransform.skewY+t.transform.skewY,this._transform.scaleX=this._originTransform.scaleX*t.transform.scaleX,this._transform.scaleY=this._originTransform.scaleY*t.transform.scaleY,this._pivot.x=this._originPivot.x+t.pivot.x,this._pivot.y=this._originPivot.y+t.pivot.y),this._bone.invalidUpdate())},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._pool=[],e}();t.TimelineState=e,egret.registerClass(e,"dragonBones.TimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=-1),void 0===e&&(e=1),this._time=t>=0?t:.001*(new Date).getTime(),this._timeScale=isNaN(e)?1:e,this._animatableList=[]}var e=__define,i=t;return p=i.prototype,e(p,"time",function(){return this._time}),e(p,"timeScale",function(){return this._timeScale},function(t){(isNaN(t)||0>t)&&(t=1),this._timeScale=t}),p.contains=function(t){return this._animatableList.indexOf(t)>=0},p.add=function(t){t&&-1==this._animatableList.indexOf(t)&&this._animatableList.push(t)},p.remove=function(t){var e=this._animatableList.indexOf(t);e>=0&&(this._animatableList[e]=null)},p.clear=function(){this._animatableList.length=0},p.advanceTime=function(t){void 0===t&&(t=-1),0>t&&(t=(new Date).getTime()-this._time),t*=this._timeScale,this._time+=t;var e=this._animatableList.length;if(0!=e){for(var i=0,a=0;e>a;a++){var n=this._animatableList[a];n&&(i!=a&&(this._animatableList[i]=n,this._animatableList[a]=null),n.advanceTime(t),i++)}if(i!=a){for(e=this._animatableList.length;e>a;)this._animatableList[i++]=this._animatableList[a++];this._animatableList.length=i}}},t.clock=new t,t}();t.WorldClock=e,egret.registerClass(e,"dragonBones.WorldClock",["dragonBones.IAnimatable"])}(dragonBones||(dragonBones={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);i.prototype=e.prototype,t.prototype=new i},dragonBones;!function(t){var e=function(t){function e(e){void 0===e&&(e=null),t.call(this,e)}__extends(e,t);var i=e;return p=i.prototype,e}(egret.EventDispatcher);t.EventDispatcher=e,egret.registerClass(e,"dragonBones.EventDispatcher")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){if(t.call(this),e._instance)throw new Error("Singleton already constructed!")}__extends(e,t);var i=e;return p=i.prototype,e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(t.EventDispatcher);t.SoundEventManager=e,egret.registerClass(e,"dragonBones.SoundEventManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){e.call(this),this._display=i,this._animation=new t.Animation(this),this._slotsZOrderChanged=!1,this._slotList=[],this._boneList=[],this._eventList=[],this._delayDispose=!1,this._lockDispose=!1,this._armatureData=null}__extends(i,e);var a=__define,n=i;return p=n.prototype,a(p,"armatureData",function(){return this._armatureData}),a(p,"display",function(){return this._display}),p.getDisplay=function(){return this._display},a(p,"animation",function(){return this._animation}),p.dispose=function(){if(this._delayDispose=!0,this._animation&&!this._lockDispose){this.userData=null,this._animation.dispose();for(var t=this._slotList.length;t--;)this._slotList[t].dispose();for(t=this._boneList.length;t--;)this._boneList[t].dispose();this._armatureData=null,this._animation=null,this._slotList=null,this._boneList=null,this._eventList=null}},p.invalidUpdate=function(t){if(void 0===t&&(t=null),t){var e=this.getBone(t);e&&e.invalidUpdate()}else for(var i=this._boneList.length;i--;)this._boneList[i].invalidUpdate()},p.advanceTime=function(e){this._lockDispose=!0,this._animation._advanceTime(e),e*=this._animation.timeScale;for(var i=this._animation._isFading,a=this._boneList.length;a--;){var n=this._boneList[a];n._update(i)}for(a=this._slotList.length;a--;){var s=this._slotList[a];if(s._update(),s._isShowDisplay){var r=s.childArmature;r&&r.advanceTime(e)}}if(this._slotsZOrderChanged&&(this.updateSlotsZOrder(),this.hasEventListener(t.ArmatureEvent.Z_ORDER_UPDATED)&&this.dispatchEvent(new t.ArmatureEvent(t.ArmatureEvent.Z_ORDER_UPDATED))),this._eventList.length>0){for(var a=0,o=this._eventList.length;o>a;a++){var l=this._eventList[a];this.dispatchEvent(l)}this._eventList.length=0}this._lockDispose=!1,this._delayDispose&&this.dispose()},p.resetAnimation=function(){this.animation.stop(),this.animation._resetAnimationStateList();for(var t=0,e=this._boneList.length;e>t;t++)this._boneList[t]._removeAllStates()},p.getSlots=function(t){return void 0===t&&(t=!0),t?this._slotList.concat():this._slotList},p.getSlot=function(t){for(var e=this._slotList.length,i=0;e>i;i++){var a=this._slotList[i];if(a.name==t)return a}return null},p.getSlotByDisplay=function(t){if(t)for(var e=this._slotList.length,i=0;e>i;i++){var a=this._slotList[i];if(a.display==t)return a}return null},p.addSlot=function(t,e){var i=this.getBone(e);if(!i)throw new Error;i.addSlot(t)},p.removeSlot=function(t){if(!t||t.armature!=this)throw new Error;t.parent.removeSlot(t)},p.removeSlotByName=function(t){var e=this.getSlot(t);return e&&this.removeSlot(e),e},p.getBones=function(t){return void 0===t&&(t=!0),t?this._boneList.concat():this._boneList},p.getBone=function(t){for(var e=this._boneList.length,i=0;e>i;i++){var a=this._boneList[i];if(a.name==t)return a}return null},p.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},p.addBone=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1);var a;if(e&&(a=this.getBone(e),!a))throw new Error;a?a.addChildBone(t,i):(t.parent&&t.parent.removeChildBone(t,i),t._setArmature(this),i||this._updateAnimationAfterBoneListChanged())},p.removeBone=function(t,e){if(void 0===e&&(e=!1),!t||t.armature!=this)throw new Error;t.parent?t.parent.removeChildBone(t,e):(t._setArmature(null),e||this._updateAnimationAfterBoneListChanged(!1))},p.removeBoneByName=function(t){var e=this.getBone(t);return e&&this.removeBone(e),e},p._addBoneToBoneList=function(t){this._boneList.indexOf(t)<0&&(this._boneList[this._boneList.length]=t)},p._removeBoneFromBoneList=function(t){var e=this._boneList.indexOf(t);e>=0&&this._boneList.splice(e,1)},p._addSlotToSlotList=function(t){this._slotList.indexOf(t)<0&&(this._slotList[this._slotList.length]=t)},p._removeSlotFromSlotList=function(t){var e=this._slotList.indexOf(t);e>=0&&this._slotList.splice(e,1)},p.updateSlotsZOrder=function(){this._slotList.sort(this.sortSlot);for(var t=this._slotList.length;t--;){var e=this._slotList[t];e._isShowDisplay&&e._addDisplayToContainer(this._display)}this._slotsZOrderChanged=!1},p._updateAnimationAfterBoneListChanged=function(t){void 0===t&&(t=!0),t&&this.sortBoneList(),this._animation._updateAnimationStates()},p.sortBoneList=function(){var e=this._boneList.length;if(0!=e){for(var i=[];e--;){for(var a=0,n=this._boneList[e],s=n;s;)a++,s=s.parent;i[e]=[a,n]}for(i.sort(t.ArmatureData.sortBoneDataHelpArrayDescending),e=i.length;e--;)this._boneList[e]=i[e][1];i.length=0}},p._arriveAtFrame=function(e,a,n){if(e.event&&this.hasEventListener(t.FrameEvent.ANIMATION_FRAME_EVENT)){var s=new t.FrameEvent(t.FrameEvent.ANIMATION_FRAME_EVENT);s.animationState=n,s.frameLabel=e.event,this._eventList.push(s)}if(e.sound&&i._soundManager.hasEventListener(t.SoundEvent.SOUND)){var r=new t.SoundEvent(t.SoundEvent.SOUND);r.armature=this,r.animationState=n,r.sound=e.sound,i._soundManager.dispatchEvent(r)}e.action&&n.displayControl&&this.animation.gotoAndPlay(e.action)},p.sortSlot=function(t,e){return t.zOrder<e.zOrder?1:-1},p.getAnimation=function(){return this._animation},i._soundManager=t.SoundEventManager.getInstance(),i}(t.EventDispatcher);t.Armature=e,egret.registerClass(e,"dragonBones.Armature",["dragonBones.IAnimatable"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var e=t;return p=e.prototype,p.invert=function(){var t=this.a,e=this.b,i=this.c,a=this.d,n=this.tx,s=t*a-e*i;this.a=a/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-a*n)/s,this.ty=-(t*this.ty-e*n)/s},p.concat=function(t){var e=t.a,i=t.b,a=t.c,n=t.d,s=this.tx,r=this.ty;if(1!=e||0!=i||0!=a||1!=n){var o=this.a,l=this.b,h=this.c,u=this.d;this.a=o*e+l*a,this.b=o*i+l*n,this.c=h*e+u*a,this.d=h*i+u*n}this.tx=s*e+r*a+t.tx,this.ty=s*i+r*n+t.ty},p.copyFrom=function(t){this.tx=t.tx,this.ty=t.ty,this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d},t}();t.Matrix=e,egret.registerClass(e,"dragonBones.Matrix")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1}var i=__define,a=e;return p=a.prototype,i(p,"rotation",function(){return this.skewX},function(t){this.skewX=this.skewY=t}),p.copy=function(t){this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY},p.add=function(t){this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY},p.minus=function(t){this.x-=t.x,this.y-=t.y,this.skewX-=t.skewX,this.skewY-=t.skewY,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY},p.normalizeRotation=function(){this.skewX=t.TransformUtil.normalizeRotation(this.skewX),this.skewY=t.TransformUtil.normalizeRotation(this.skewY)},p.toString=function(){var t="x:"+this.x+" y:"+this.y+" skewX:"+this.skewX+" skewY:"+this.skewY+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY;return t},e}();t.DBTransform=e,egret.registerClass(e,"dragonBones.DBTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._globalTransformMatrix=new t.Matrix,this._global=new t.DBTransform,this._origin=new t.DBTransform,this._offset=new t.DBTransform,this._offset.scaleX=this._offset.scaleY=1,this._visible=!0,this._armature=null,this._parent=null,this.userData=null,this.inheritRotation=!0,this.inheritScale=!0,this.inheritTranslation=!0}var i=__define,a=e;return p=a.prototype,i(p,"global",function(){return this._global}),i(p,"origin",function(){return this._origin}),i(p,"offset",function(){return this._offset}),i(p,"armature",function(){return this._armature}),p._setArmature=function(t){this._armature=t},i(p,"parent",function(){return this._parent}),p._setParent=function(t){this._parent=t},p.dispose=function(){this.userData=null,this._globalTransformMatrix=null,this._global=null,this._origin=null,this._offset=null,this._armature=null,this._parent=null},p._calculateRelativeParentTransform=function(){},p._calculateParentTransform=function(){if(this.parent&&(this.inheritTranslation||this.inheritRotation||this.inheritScale)){var i=this._parent._globalTransformForChild,a=this._parent._globalTransformMatrixForChild;return this.inheritTranslation&&this.inheritRotation&&this.inheritScale||(i=e._tempParentGlobalTransform,i.copy(this._parent._globalTransformForChild),this.inheritTranslation||(i.x=0,i.y=0),this.inheritScale||(i.scaleX=1,i.scaleY=1),this.inheritRotation||(i.skewX=0,i.skewY=0),a=e._tempParentGlobalTransformMatrix,t.TransformUtil.transformToMatrix(i,a,!0)),{parentGlobalTransform:i,parentGlobalTransformMatrix:a}}return null},p._updateGlobal=function(){this._calculateRelativeParentTransform();var e=this._calculateParentTransform();if(null!=e){var i=e.parentGlobalTransformMatrix,a=e.parentGlobalTransform,n=this._global.x,s=this._global.y;this._global.x=i.a*n+i.c*s+i.tx,this._global.y=i.d*s+i.b*n+i.ty,this.inheritRotation&&(this._global.skewX+=a.skewX,this._global.skewY+=a.skewY),this.inheritScale&&(this._global.scaleX*=a.scaleX,this._global.scaleY*=a.scaleY)}return t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix,!0),e},e._tempParentGlobalTransformMatrix=new t.Matrix,e._tempParentGlobalTransform=new t.DBTransform,e}();t.DBObject=e,egret.registerClass(e,"dragonBones.DBObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.applyOffsetTranslationToChild=!0,this.applyOffsetRotationToChild=!0,this.applyOffsetScaleToChild=!1,this._needUpdate=0,this._tween=new t.DBTransform,this._tweenPivot=new t.Point,this._tween.scaleX=this._tween.scaleY=1,this._boneList=[],this._slotList=[],this._timelineStateList=[],this._needUpdate=2,this._isColorChanged=!1}__extends(i,e);var a=__define,n=i;return p=n.prototype,i.initWithBoneData=function(t){var e=new i;return e.name=t.name,e.inheritRotation=t.inheritRotation,e.inheritScale=t.inheritScale,e.origin.copy(t.transform),e},p.dispose=function(){if(this._boneList){e.prototype.dispose.call(this);for(var t=this._boneList.length;t--;)this._boneList[t].dispose();for(t=this._slotList.length;t--;)this._slotList[t].dispose();this._tween=null,this._tweenPivot=null,this._boneList=null,this._slotList=null,this._timelineStateList=null}},p.contains=function(t){if(!t)throw new Error;if(t==this)return!1;for(var e=t;e!=this&&null!=e;)e=e.parent;return e==this},p.addChildBone=function(t,e){if(void 0===e&&(e=!1),!t)throw new Error;if(t==this||t.contains(this))throw new Error;t.parent!=this&&(t.parent&&t.parent.removeChildBone(t,e),this._boneList[this._boneList.length]=t,t._setParent(this),t._setArmature(this._armature),this._armature&&!e&&this._armature._updateAnimationAfterBoneListChanged())},p.removeChildBone=function(t,e){if(void 0===e&&(e=!1),!t)throw new Error;var i=this._boneList.indexOf(t);if(0>i)throw new Error;this._boneList.splice(i,1),t._setParent(null),t._setArmature(null),this._armature&&!e&&this._armature._updateAnimationAfterBoneListChanged(!1)},p.addSlot=function(t){if(!t)throw new Error;t.parent&&t.parent.removeSlot(t),this._slotList[this._slotList.length]=t,t._setParent(this),t.setArmature(this._armature)},p.removeSlot=function(t){if(!t)throw new Error;var e=this._slotList.indexOf(t);if(0>e)throw new Error;this._slotList.splice(e,1),t._setParent(null),t.setArmature(null)},p._setArmature=function(t){if(this._armature!=t){this._armature&&(this._armature._removeBoneFromBoneList(this),this._armature._updateAnimationAfterBoneListChanged(!1)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this);for(var e=this._boneList.length;e--;)this._boneList[e]._setArmature(this._armature);for(e=this._slotList.length;e--;)this._slotList[e].setArmature(this._armature)}},p.getBones=function(t){return void 0===t&&(t=!0),t?this._boneList.concat():this._boneList},p.getSlots=function(t){return void 0===t&&(t=!0),t?this._slotList.concat():this._slotList},p.invalidUpdate=function(){this._needUpdate=2},p._calculateRelativeParentTransform=function(){this._global.scaleX=this._origin.scaleX*this._tween.scaleX*this._offset.scaleX,this._global.scaleY=this._origin.scaleY*this._tween.scaleY*this._offset.scaleY,this._global.skewX=this._origin.skewX+this._tween.skewX+this._offset.skewX,this._global.skewY=this._origin.skewY+this._tween.skewY+this._offset.skewY,this._global.x=this._origin.x+this._tween.x+this._offset.x,this._global.y=this._origin.y+this._tween.y+this._offset.y},p._update=function(e){if(void 0===e&&(e=!1),this._needUpdate--,e||this._needUpdate>0||this._parent&&this._parent._needUpdate>0){this._needUpdate=1,this.blendingTimeline();var i=this._updateGlobal(),a=i?i.parentGlobalTransform:null,n=i?i.parentGlobalTransformMatrix:null,s=0!=this._offset.x||0!=this._offset.y,r=0!=this._offset.scaleX||0!=this._offset.scaleY,o=0!=this._offset.skewX||0!=this._offset.skewY;s&&!this.applyOffsetTranslationToChild||r&&!this.applyOffsetScaleToChild||o&&!this.applyOffsetRotationToChild?(this._tempGlobalTransformForChild||(this._tempGlobalTransformForChild=new t.DBTransform),this._globalTransformForChild=this._tempGlobalTransformForChild,this._tempGlobalTransformMatrixForChild||(this._tempGlobalTransformMatrixForChild=new t.Matrix),this._globalTransformMatrixForChild=this._tempGlobalTransformMatrixForChild,this._globalTransformForChild.x=this._origin.x+this._tween.x,this._globalTransformForChild.y=this._origin.y+this._tween.y,this._globalTransformForChild.scaleX=this._origin.scaleX*this._tween.scaleX,this._globalTransformForChild.scaleY=this._origin.scaleY*this._tween.scaleY,this._globalTransformForChild.skewX=this._origin.skewX+this._tween.skewX,this._globalTransformForChild.skewY=this._origin.skewY+this._tween.skewY,this.applyOffsetTranslationToChild&&(this._globalTransformForChild.x+=this._offset.x,this._globalTransformForChild.y+=this._offset.y),this.applyOffsetScaleToChild&&(this._globalTransformForChild.scaleX*=this._offset.scaleX,this._globalTransformForChild.scaleY*=this._offset.scaleY),this.applyOffsetRotationToChild&&(this._globalTransformForChild.skewX+=this._offset.skewX,this._globalTransformForChild.skewY+=this._offset.skewY),t.TransformUtil.transformToMatrix(this._globalTransformForChild,this._globalTransformMatrixForChild,!0),n&&(this._globalTransformMatrixForChild.concat(n),t.TransformUtil.matrixToTransform(this._globalTransformMatrixForChild,this._globalTransformForChild,this._globalTransformForChild.scaleX*a.scaleX>=0,this._globalTransformForChild.scaleY*a.scaleY>=0))):(this._globalTransformForChild=this._global,this._globalTransformMatrixForChild=this._globalTransformMatrix)}},p._updateColor=function(t,e,i,a,n,s,r,o,l){for(var h=this._slotList.length,u=0;h>u;u++){var _=this._slotList[u];_._updateDisplayColor(t,e,i,a,n,s,r,o)}this._isColorChanged=l},p._hideSlots=function(){for(var t=this._slotList.length,e=0;t>e;e++){var i=this._slotList[e];i._changeDisplay(-1)}},p._arriveAtFrame=function(e,a,n){var s=n.displayControl&&(!this.displayController||this.displayController==n.name)&&n.containsBoneMask(this.name);if(s){{var r,o=e;o.displayIndex}if(e.event&&this._armature.hasEventListener(t.FrameEvent.BONE_FRAME_EVENT)){var l=new t.FrameEvent(t.FrameEvent.BONE_FRAME_EVENT);l.bone=this,l.animationState=n,l.frameLabel=e.event,this._armature._eventList.push(l)}if(e.sound&&i._soundManager.hasEventListener(t.SoundEvent.SOUND)){var h=new t.SoundEvent(t.SoundEvent.SOUND);h.armature=this._armature,h.animationState=n,h.sound=e.sound,i._soundManager.dispatchEvent(h)}if(e.action)for(var u=this._slotList.length,_=0;u>_;_++){r=this._slotList[_];var m=r.childArmature;m&&m.animation.gotoAndPlay(e.action)}}},p._addState=function(t){this._timelineStateList.indexOf(t)<0&&(this._timelineStateList.push(t),this._timelineStateList.sort(this.sortState))},p._removeState=function(t){var e=this._timelineStateList.indexOf(t);e>=0&&this._timelineStateList.splice(e,1)},p._removeAllStates=function(){this._timelineStateList.length=0},p.blendingTimeline=function(){var t,e,i,a,n=this._timelineStateList.length;if(1==n)t=this._timelineStateList[0],a=t._animationState.weight*t._animationState.fadeWeight,t._weight=a,e=t._transform,i=t._pivot,this._tween.x=e.x*a,this._tween.y=e.y*a,this._tween.skewX=e.skewX*a,this._tween.skewY=e.skewY*a,this._tween.scaleX=1+(e.scaleX-1)*a,this._tween.scaleY=1+(e.scaleY-1)*a,this._tweenPivot.x=i.x*a,this._tweenPivot.y=i.y*a;else if(n>1){for(var s=0,r=0,o=0,l=0,h=1,u=1,_=0,m=0,f=1,d=0,p=this._timelineStateList[n-1]._animationState.layer,c=0;n--;){if(t=this._timelineStateList[n],c=t._animationState.layer,p!=c){if(d>=f){t._weight=0;break}f-=d}p=c,a=t._animationState.weight*t._animationState.fadeWeight*f,t._weight=a,a&&t._blendEnabled&&(e=t._transform,i=t._pivot,s+=e.x*a,r+=e.y*a,o+=e.skewX*a,l+=e.skewY*a,h+=(e.scaleX-1)*a,u+=(e.scaleY-1)*a,_+=i.x*a,m+=i.y*a,d+=a)}this._tween.x=s,this._tween.y=r,this._tween.skewX=o,this._tween.skewY=l,this._tween.scaleX=h,this._tween.scaleY=u,this._tweenPivot.x=_,this._tweenPivot.y=m}},p.sortState=function(t,e){return t._animationState.layer<e._animationState.layer?-1:1},a(p,"childArmature",function(){return this.slot?this.slot.childArmature:null}),a(p,"display",function(){return this.slot?this.slot.display:null},function(t){this.slot&&(this.slot.display=t)}),a(p,"node",function(){return this._offset}),a(p,"visible",void 0,function(t){if(this._visible!=t){this._visible=t;for(var e=this._slotList.length,i=0;e>i;i++){var a=this._slotList[i];a._updateDisplayVisible(this._visible)}}}),a(p,"slot",function(){return this._slotList.length>0?this._slotList[0]:null}),i._soundManager=t.SoundEventManager.getInstance(),i}(t.DBObject);t.Bone=e,egret.registerClass(e,"dragonBones.Bone")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){if(e.call(this),this._currentDisplayIndex=0,i!=this)throw new Error(egret.getString(4001));this._displayList=[],this._timelineStateList=[],this._currentDisplayIndex=-1,this._originZOrder=0,this._tweenZOrder=0,this._offsetZOrder=0,this._isShowDisplay=!1,this._colorTransform=new t.ColorTransform,this._displayDataList=null,this._currentDisplay=null,this.inheritRotation=!0,this.inheritScale=!0}__extends(i,e);var a=__define,n=i;return p=n.prototype,p.initWithSlotData=function(t){this.name=t.name,this.blendMode=t.blendMode,this._originZOrder=t.zOrder,this._displayDataList=t.displayDataList},p.dispose=function(){this._displayList&&(e.prototype.dispose.call(this),this._displayList.length=0,this._displayDataList=null,this._displayList=null,this._currentDisplay=null)},p.sortState=function(t,e){return t._animationState.layer<e._animationState.layer?-1:1},p._addState=function(t){this._timelineStateList.indexOf(t)<0&&(this._timelineStateList.push(t),this._timelineStateList.sort(this.sortState))},p._removeState=function(t){var e=this._timelineStateList.indexOf(t);e>=0&&this._timelineStateList.splice(e,1)},p.setArmature=function(t){this._armature!=t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._armature?(this._armature._addSlotToSlotList(this),this._armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this._armature.display)):this._removeDisplayFromContainer())},p._update=function(){this._parent._needUpdate<=0||(this._updateGlobal(),this._updateTransform())},p._calculateRelativeParentTransform=function(){this._global.scaleX=this._origin.scaleX*this._offset.scaleX,this._global.scaleY=this._origin.scaleY*this._offset.scaleY,this._global.skewX=this._origin.skewX+this._offset.skewX,this._global.skewY=this._origin.skewY+this._offset.skewY,this._global.x=this._origin.x+this._offset.x+this._parent._tweenPivot.x,this._global.y=this._origin.y+this._offset.y+this._parent._tweenPivot.y},p.updateChildArmatureAnimation=function(){this.childArmature&&(this._isShowDisplay?this._armature&&this._armature.animation.lastAnimationState&&this.childArmature.animation.hasAnimation(this._armature.animation.lastAnimationState.name)?this.childArmature.animation.gotoAndPlay(this._armature.animation.lastAnimationState.name):this.childArmature.animation.play():(this.childArmature.animation.stop(),this.childArmature.animation._lastAnimationState=null))},p._changeDisplay=function(t){if(void 0===t&&(t=0),0>t)this._isShowDisplay&&(this._isShowDisplay=!1,this._removeDisplayFromContainer(),this.updateChildArmatureAnimation());else if(this._displayList.length>0){var e=this._displayList.length;t>=e&&(t=e-1),this._currentDisplayIndex!=t?(this._isShowDisplay=!0,this._currentDisplayIndex=t,this._updateSlotDisplay(),this.updateChildArmatureAnimation(),this._displayDataList&&this._displayDataList.length>0&&this._currentDisplayIndex<this._displayDataList.length&&this._origin.copy(this._displayDataList[this._currentDisplayIndex].transform)):this._isShowDisplay||(this._isShowDisplay=!0,this._armature&&(this._armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this._armature.display)),this.updateChildArmatureAnimation())}},p._updateSlotDisplay=function(){var e=-1;this._currentDisplay&&(e=this._getDisplayIndex(),this._removeDisplayFromContainer());var i=this._displayList[this._currentDisplayIndex];this._currentDisplay=i?i instanceof t.Armature?i.display:i:null,this._updateDisplay(this._currentDisplay),this._currentDisplay&&(this._armature&&this._isShowDisplay&&(0>e?(this._armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this._armature.display)):this._addDisplayToContainer(this._armature.display,e)),this._updateDisplayBlendMode(this._blendMode),this._updateDisplayColor(this._colorTransform.alphaOffset,this._colorTransform.redOffset,this._colorTransform.greenOffset,this._colorTransform.blueOffset,this._colorTransform.alphaMultiplier,this._colorTransform.redMultiplier,this._colorTransform.greenMultiplier,this._colorTransform.blueMultiplier),this._updateDisplayVisible(this._visible),this._updateTransform())},a(p,"visible",void 0,function(t){this._visible!=t&&(this._visible=t,this._updateDisplayVisible(this._visible))}),a(p,"displayList",function(){return this._displayList},function(t){if(!t)throw new Error;this._currentDisplayIndex<0&&(this._currentDisplayIndex=0);for(var e=this._displayList.length=t.length;e--;)this._displayList[e]=t[e];var i=this._currentDisplayIndex;this._currentDisplayIndex=-1,this._changeDisplay(i)}),a(p,"display",function(){return this._currentDisplay},function(t){this._currentDisplayIndex<0&&(this._currentDisplayIndex=0),this._displayList[this._currentDisplayIndex]!=t&&(this._displayList[this._currentDisplayIndex]=t,this._updateSlotDisplay(),this.updateChildArmatureAnimation(),this._updateTransform())}),p.getDisplay=function(){return this.display},p.setDisplay=function(t){this.display=t},a(p,"childArmature",function(){return this._displayList[this._currentDisplayIndex]instanceof t.Armature?this._displayList[this._currentDisplayIndex]:null},function(t){this.display=t}),a(p,"zOrder",function(){return this._originZOrder+this._tweenZOrder+this._offsetZOrder},function(t){this.zOrder!=t&&(this._offsetZOrder=t-this._originZOrder-this._tweenZOrder,this._armature&&(this._armature._slotsZOrderChanged=!0))}),a(p,"blendMode",function(){return this._blendMode},function(t){this._blendMode!=t&&(this._blendMode=t,this._updateDisplayBlendMode(this._blendMode))}),p._updateDisplay=function(){throw new Error("")},p._getDisplayIndex=function(){throw new Error(egret.getString(4001))},p._addDisplayToContainer=function(t,e){throw void 0===e&&(e=-1),new Error(egret.getString(4001))},p._removeDisplayFromContainer=function(){throw new Error(egret.getString(4001))},p._updateTransform=function(){throw new Error(egret.getString(4001))},p._updateDisplayVisible=function(){throw new Error(egret.getString(4001))},p._updateDisplayColor=function(t,e,i,a,n,s,r,o,l){void 0===l&&(l=!1),this._colorTransform.alphaOffset=t,this._colorTransform.redOffset=e,this._colorTransform.greenOffset=i,this._colorTransform.blueOffset=a,this._colorTransform.alphaMultiplier=n,this._colorTransform.redMultiplier=s,this._colorTransform.greenMultiplier=r,this._colorTransform.blueMultiplier=o,this._isColorChanged=l},p._updateDisplayBlendMode=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._arriveAtFrame=function(t,e,i){var a=i.displayControl&&i.containsBoneMask(this.parent.name);if(a){var n=t,s=n.displayIndex;this._changeDisplay(s),this._updateDisplayVisible(n.visible),s>=0&&(isNaN(n.zOrder)||n.zOrder==this._tweenZOrder||(this._tweenZOrder=n.zOrder,this._armature._slotsZOrderChanged=!0)),t.action&&this.childArmature&&this.childArmature.animation.gotoAndPlay(t.action)}},p._updateGlobal=function(){this._calculateRelativeParentTransform(),t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix,!0);var e=this._calculateParentTransform();return e&&(this._globalTransformMatrix.concat(e.parentGlobalTransformMatrix),t.TransformUtil.matrixToTransform(this._globalTransformMatrix,this._global,this._global.scaleX*e.parentGlobalTransform.scaleX>=0,this._global.scaleY*e.parentGlobalTransform.scaleY>=0)),e},i}(t.DBObject);t.Slot=e,egret.registerClass(e,"dragonBones.Slot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.slotTimelineCacheList=[],this.slotTimelineCacheDic={},this.frameNum=0}var i=e;return p=i.prototype,e.initWithAnimationData=function(i,a){var n=new e;n.name=i.name;for(var s,r,o,l,h=i.timelineList,u=0,_=h.length;_>u;u++){s=h[u].name;for(var m=0,f=a.slotDataList.length;f>m;m++)r=a.slotDataList[m],l=r.name,r.parent==s&&null==n.slotTimelineCacheDic[l]&&(o=new t.SlotTimelineCache,o.name=l,n.slotTimelineCacheList.push(o),n.slotTimelineCacheDic[l]=o)}return n},p.initSlotTimelineCacheDic=function(t,e){var i;for(var a in this.slotTimelineCacheDic){var n=this.slotTimelineCacheDic[a];i=n.name,n.cacheGenerator=t[i],n.currentFrameCache=e[i]}},p.bindCacheUserSlotDic=function(t){for(var e in t)this.slotTimelineCacheDic[e].bindCacheUser(t[e])},p.addFrame=function(){this.frameNum++;for(var t,e=0,i=this.slotTimelineCacheList.length;i>e;e++)t=this.slotTimelineCacheList[e],t.addFrame()},p.update=function(t){for(var e,i=Math.floor(t*(this.frameNum-1)),a=0,n=this.slotTimelineCacheList.length;n>a;a++)e=this.slotTimelineCacheList[a],e.update(i)},e}();t.AnimationCache=e,egret.registerClass(e,"dragonBones.AnimationCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.animationCacheDic={},this.slotFrameCacheDic={}}var i=e;return p=i.prototype,e.initWithArmatureData=function(t,i){void 0===i&&(i=0);var a=new e;if(a.armatureData=t,0>=i){var n=t.animationDataList[0];n&&(a.frameRate=n.frameRate)}else a.frameRate=i;return a},p.initAllAnimationCache=function(){for(var e=this.armatureData.animationDataList.length,i=0;e>i;i++){var a=this.armatureData.animationDataList[i];this.animationCacheDic[a.name]=t.AnimationCache.initWithAnimationData(a,this.armatureData)}},p.initAnimationCache=function(e){this.animationCacheDic[e]=t.AnimationCache.initWithAnimationData(this.armatureData.getAnimationData(e),this.armatureData)},p.bindCacheUserArmatures=function(t){for(var e=t.length,i=0;e>i;i++){var a=t[i];this.bindCacheUserArmature(a)}},p.bindCacheUserArmature=function(t){t.animation.animationCacheManager=this;
var e;for(var i in t._slotDic)e=t._slotDic[i],e.frameCache=this.slotFrameCacheDic[e.name]},p.setCacheGeneratorArmature=function(e){this.cacheGeneratorArmature=e;var i;for(var a in e._slotDic)i=e._slotDic[a],this.slotFrameCacheDic[i.name]=new t.SlotFrameCache;for(var n in this.animationCacheDic){var s=this.animationCacheDic[n];s.initSlotTimelineCacheDic(e._slotDic,this.slotFrameCacheDic)}},p.generateAllAnimationCache=function(t){for(var e in this.animationCacheDic){var i=this.animationCacheDic[e];this.generateAnimationCache(i.name,t)}},p.generateAnimationCache=function(t,e){var i=this.cacheGeneratorArmature.enableCache;this.cacheGeneratorArmature.enableCache=!1;var a=this.animationCacheDic[t];if(a){var n=this.cacheGeneratorArmature.getAnimation().animationState,s=1/this.frameRate;e?this.cacheGeneratorArmature.getAnimation().gotoAndPlay(t,0,-1,0):this.cacheGeneratorArmature.getAnimation().gotoAndPlay(t,0,-1,1);var r=this.cacheGeneratorArmature.enableEventDispatch;this.cacheGeneratorArmature.enableEventDispatch=!1;var o;do o=n.progress,this.cacheGeneratorArmature.advanceTime(s),a.addFrame();while(n.progress>=o&&n.progress<1);this.cacheGeneratorArmature.enableEventDispatch=r,this.resetCacheGeneratorArmature(),this.cacheGeneratorArmature.enableCache=i}},p.resetCacheGeneratorArmature=function(){this.cacheGeneratorArmature.resetAnimation()},p.getAnimationCache=function(t){return this.animationCacheDic[t]},e}();t.AnimationCacheManager=e,egret.registerClass(e,"dragonBones.AnimationCacheManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.globalTransform=new t.DBTransform,this.globalTransformMatrix=new t.Matrix}var i=e;return p=i.prototype,p.copy=function(t){this.globalTransform=t.globalTransform,this.globalTransformMatrix=t.globalTransformMatrix},p.clear=function(){this.globalTransform=e.ORIGIN_TRAMSFORM,this.globalTransformMatrix=e.ORIGIN_MATRIX},e.ORIGIN_TRAMSFORM=new t.DBTransform,e.ORIGIN_MATRIX=new t.Matrix,e}();t.FrameCache=e,egret.registerClass(e,"dragonBones.FrameCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.displayIndex=-1}__extends(e,t);var i=e;return p=i.prototype,p.copy=function(e){t.prototype.copy.call(this,e),this.colorTransform=e.colorTransform,this.displayIndex=e.displayIndex},p.clear=function(){t.prototype.clear.call(this),this.colorTransform=null,this.displayIndex=-1},e}(t.FrameCache);t.SlotFrameCache=e,egret.registerClass(e,"dragonBones.SlotFrameCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.frameCacheList=new Array}var e=t;return p=e.prototype,p.addFrame=function(){},p.update=function(t){void 0===t&&(t=0),this.currentFrameCache.copy(this.frameCacheList[t])},p.bindCacheUser=function(t){t.frameCache=this.currentFrameCache},t}();t.TimelineCache=e,egret.registerClass(e,"dragonBones.TimelineCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var a=i;return p=a.prototype,p.addFrame=function(){var e=new t.SlotFrameCache;e.globalTransform.copy(this.cacheGenerator.global),e.globalTransformMatrix.copyFrom(this.cacheGenerator.globalTransformMatrix),this.cacheGenerator.colorChanged&&(e.colorTransform=t.ColorTransformUtil.cloneColor(this.cacheGenerator.colorTransform)),e.displayIndex=this.cacheGenerator.displayIndex,this.frameCacheList.push(e)},i}(t.TimelineCache);t.SlotTimelineCache=e,egret.registerClass(e,"dragonBones.SlotTimelineCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=t;return p=e.prototype,t.DATA_VERSION="4.0",t.PARENT_COORDINATE_DATA_VERSION="3.0",t.VERSION="4.1",t}();t.DragonBones=e,egret.registerClass(e,"dragonBones.DragonBones")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i,a){void 0===i&&(i=!1),void 0===a&&(a=!1),t.call(this,e,i,a)}__extends(e,t);var i=e;return p=i.prototype,e}(egret.Event);t.Event=e,egret.registerClass(e,"dragonBones.Event")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1),t.call(this,e)}__extends(e,t);var i=__define,a=e;return p=a.prototype,i(e,"MOVEMENT_CHANGE",function(){return e.FADE_IN}),i(p,"movementID",function(){return this.animationName}),i(p,"armature",function(){return this.target}),i(p,"animationName",function(){return this.animationState.name}),e.FADE_IN="fadeIn",e.FADE_OUT="fadeOut",e.START="start",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT_COMPLETE="fadeOutComplete",e}(t.Event);t.AnimationEvent=e,egret.registerClass(e,"dragonBones.AnimationEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=e;return p=i.prototype,e.Z_ORDER_UPDATED="zOrderUpdated",e}(t.Event);t.ArmatureEvent=e,egret.registerClass(e,"dragonBones.ArmatureEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1),t.call(this,e)}__extends(e,t);var i=__define,a=e;return p=a.prototype,i(e,"MOVEMENT_FRAME_EVENT",function(){return e.ANIMATION_FRAME_EVENT}),i(p,"armature",function(){return this.target}),e.ANIMATION_FRAME_EVENT="animationFrameEvent",e.BONE_FRAME_EVENT="boneFrameEvent",e}(t.Event);t.FrameEvent=e,egret.registerClass(e,"dragonBones.FrameEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1),t.call(this,e)}__extends(e,t);var i=e;return p=i.prototype,e.SOUND="sound",e}(t.Event);t.SoundEvent=e,egret.registerClass(e,"dragonBones.SoundEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(t){if(e.call(this),this.dragonBonesDataDic={},this.textureAtlasDic={},t!=this)throw new Error(egret.getString(4001))}__extends(a,e);var n=a;return p=n.prototype,p.dispose=function(t){if(void 0===t&&(t=!0),t){for(var e in this.dragonBonesDataDic)this.dragonBonesDataDic[e].dispose(),delete this.dragonBonesDataDic[e];for(var i in this.textureAtlasDic)this.textureAtlasDic[i].dispose(),delete this.textureAtlasDic[i]}this.dragonBonesDataDic=null,this.textureAtlasDic=null},p.getDragonBonesData=function(t){return this.dragonBonesDataDic[t]},p.getSkeletonData=function(t){return this.getDragonBonesData(t)},p.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(e=e||t.name,!e)throw new Error(egret.getString(4002));this.dragonBonesDataDic[e]=t},p.addSkeletonData=function(t,e){void 0===e&&(e=null),this.addDragonBonesData(t,e)},p.removeDragonBonesData=function(t){delete this.dragonBonesDataDic[t]},p.removeSkeletonData=function(t){delete this.dragonBonesDataDic[t]},p.getTextureAtlas=function(t){return this.textureAtlasDic[t]},p.addTextureAtlas=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(!e&&t.hasOwnProperty("name")&&(e=t.name),!e)throw new Error(egret.getString(4002));this.textureAtlasDic[e]=t},p.removeTextureAtlas=function(t){delete this.textureAtlasDic[t]},p.getTextureDisplay=function(t,e,i,a){void 0===e&&(e=null),void 0===i&&(i=0/0),void 0===a&&(a=0/0);var n;if(e)n=this.textureAtlasDic[e];else for(e in this.textureAtlasDic){if(n=this.textureAtlasDic[e],n.getRegion(t))break;n=null}if(!n)return null;if(isNaN(i)||isNaN(a)){var s=this.dragonBonesDataDic[e];if(s=s?s:this.findFirstDragonBonesData()){var r=s.getDisplayDataByName(t);r&&(i=r.pivot.x,a=r.pivot.y)}}return this._generateDisplay(n,t,i,a)},p.buildArmature=function(t,e,i,a){void 0===e&&(e=null),void 0===i&&(i=null),void 0===a&&(a=null);var n={};this.fillBuildArmatureDataPackageArmatureInfo(t,e,n)&&this.fillBuildArmatureDataPackageTextureInfo(i,n);var s=n.dragonBonesData,r=n.armatureData,o=n.textureAtlas;return r&&o?this.buildArmatureUsingArmatureDataFromTextureAtlas(s,r,o,a):null},p.buildFastArmature=function(t,e,a,n){void 0===e&&(e=null),void 0===a&&(a=null),void 0===n&&(n=null);var s=new i;this.fillBuildArmatureDataPackageArmatureInfo(t,e,s)&&this.fillBuildArmatureDataPackageTextureInfo(a,s);var r=s.dragonBonesData,o=s.armatureData,l=s.textureAtlas;return o&&l?this.buildFastArmatureUsingArmatureDataFromTextureAtlas(r,o,l,n):null},p.buildArmatureUsingArmatureDataFromTextureAtlas=function(t,e,i,a){void 0===a&&(a=null);var n=this._generateArmature();return n.name=e.name,n.__dragonBonesData=t,n._armatureData=e,n.animation.animationDataList=e.animationDataList,this._buildBones(n),this._buildSlots(n,a,i),n.advanceTime(0),n},p.buildFastArmatureUsingArmatureDataFromTextureAtlas=function(t,e,i,a){void 0===a&&(a=null);var n=this._generateFastArmature();return n.name=e.name,n.__dragonBonesData=t,n._armatureData=e,n.animation.animationDataList=e.animationDataList,this._buildFastBones(n),this._buildFastSlots(n,a,i),n.advanceTime(0),n},p.copyAnimationsToArmature=function(e,i,a,n){void 0===a&&(a=null),void 0===n&&(n=!0);var s={};if(!this.fillBuildArmatureDataPackageArmatureInfo(i,a,s))return!1;var r=s.armatureData;e.animation.animationDataList=r.animationDataList;for(var o,l,h,u,_,m,f=r.getSkinData(""),d=e.getSlots(!1),p=0,c=d.length,g=0;c>g;g++){h=d[g],u=h.displayList,p=u.length;for(var T=0;p>T;T++)_=u[T],_ instanceof t.Armature&&(m=_,o=f.getSlotData(h.name),l=o.displayDataList[T],l.type==t.DisplayData.ARMATURE&&this.copyAnimationsToArmature(m,l.name,s.dragonBonesDataName,n))}return!0},p.fillBuildArmatureDataPackageArmatureInfo=function(t,e,i){if(e)return i.dragonBonesDataName=e,i.dragonBonesData=this.dragonBonesDataDic[e],i.armatureData=i.dragonBonesData.getArmatureDataByName(t),!0;for(e in this.dragonBonesDataDic)if(i.dragonBonesData=this.dragonBonesDataDic[e],i.armatureData=i.dragonBonesData.getArmatureDataByName(t),i.armatureData)return i.dragonBonesDataName=e,!0;return!1},p.fillBuildArmatureDataPackageTextureInfo=function(t,e){e.textureAtlas=this.textureAtlasDic[t?t:e.dragonBonesDataName]},p.findFirstDragonBonesData=function(){for(var t in this.dragonBonesDataDic){var e=this.dragonBonesDataDic[t];if(e)return e}return null},p.findFirstTextureAtlas=function(){for(var t in this.textureAtlasDic){var e=this.textureAtlasDic[t];if(e)return e}return null},p._buildBones=function(e){for(var i,a,n,s=e.armatureData.boneDataList,r=0;r<s.length;r++)i=s[r],a=t.Bone.initWithBoneData(i),n=i.parent,n&&null==e.armatureData.getBoneData(n)&&(n=null),e.addBone(a,n,!0);e._updateAnimationAfterBoneListChanged()},p._buildSlots=function(e,i,a){var n=e.armatureData.getSkinData(i);if(n){e.armatureData.setSkinData(i);for(var s,r,o,l=[],h=e.armatureData.slotDataList,u=0;u<h.length;u++)if(s=h[u],o=e.getBone(s.parent)){r=this._generateSlot(),r.initWithSlotData(s),o.addSlot(r);for(var _=s.displayDataList.length;_--;){var m=s.displayDataList[_];switch(m.type){case t.DisplayData.ARMATURE:var f=this.buildArmatureUsingArmatureDataFromTextureAtlas(e.__dragonBonesData,e.__dragonBonesData.getArmatureDataByName(m.name),a,i);l[_]=f;break;case t.DisplayData.IMAGE:default:l[_]=this._generateDisplay(a,m.name,m.pivot.x,m.pivot.y)}}for(var d=0,p=l.length;p>d;d++){var c=l[d];if(c instanceof t.Armature&&(c=c.display),c.hasOwnProperty("name"))try{c.name=r.name}catch(g){}}r.displayList=l,r._changeDisplay(s.displayIndex)}}},p._buildFastBones=function(e){for(var i,a,n=e.armatureData.boneDataList,s=0;s<n.length;s++)i=n[s],a=t.FastBone.initWithBoneData(i),e.addBone(a,i.parent)},p._buildFastSlots=function(e,i,a){var n=e.armatureData.getSkinData(i);if(n){e.armatureData.setSkinData(i);for(var s,r,o=[],l=e.armatureData.slotDataList,h=0;h<l.length;h++){o.length=0,s=l[h],r=this._generateFastSlot(),r.initWithSlotData(s);for(var u=s.displayDataList.length;u--;){var _=s.displayDataList[u];switch(_.type){case t.DisplayData.ARMATURE:var m=this.buildFastArmatureUsingArmatureDataFromTextureAtlas(e.__dragonBonesData,e.__dragonBonesData.getArmatureDataByName(_.name),a,i);o[u]=m,r.hasChildArmature=!0;break;case t.DisplayData.IMAGE:default:o[u]=this._generateDisplay(a,_.name,_.pivot.x,_.pivot.y)}}for(var f=o.length,d=0;f>d;d++){var p=o[d];if(p instanceof t.FastArmature&&(p=p.display),p.hasOwnProperty("name"))try{p.name=r.name}catch(c){}}r.initDisplayList(o.concat()),e.addSlot(r,s.parent),r._changeDisplayIndex(s.displayIndex)}}},p._generateArmature=function(){return null},p._generateSlot=function(){return null},p._generateFastArmature=function(){return null},p._generateFastSlot=function(){return null},p._generateDisplay=function(){return null},a._helpMatrix=new t.Matrix,a}(t.EventDispatcher);t.BaseFactory=e,egret.registerClass(e,"dragonBones.BaseFactory");var i=function(){function t(){}var e=t;return p=e.prototype,t}();t.BuildArmatureDataPackage=i,egret.registerClass(i,"dragonBones.BuildArmatureDataPackage")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e){this.animationState=new t.FastAnimationState,this._armature=e,this.animationState._armature=e,this.animationList=[],this._animationDataObj={},this._isPlaying=!1,this._timeScale=1}var i=__define,a=e;return p=a.prototype,p.dispose=function(){this._armature&&(this._armature=null,this._animationDataList=null,this.animationList=null,this.animationState=null)},p.gotoAndPlay=function(t,e,i,a){if(void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=0/0),!this._animationDataList)return null;var n=this._animationDataObj[t];if(!n)return null;this._isPlaying=!0,e=0>e?n.fadeTime<0?.3:n.fadeTime:e;var s;s=0>i?n.scale<0?1:n.scale:1e3*i/n.duration,a=isNaN(a)?n.playTimes:a,this.animationState._fadeIn(n,a,1/s,e),this._armature.enableCache&&this.animationCacheManager&&(this.animationState.animationCache=this.animationCacheManager.getAnimationCache(t));for(var r=this._armature.slotHasChildArmatureList.length;r--;){var o=this._armature.slotHasChildArmatureList[r],l=o.childArmature;l&&l.getAnimation().gotoAndPlay(t)}return this.animationState},p.gotoAndStop=function(t,e,i,a,n){return void 0===i&&(i=-1),void 0===a&&(a=0),void 0===n&&(n=-1),this.animationState.name!=t&&this.gotoAndPlay(t,a,n),this.animationState.setCurrentTime(i>=0?this.animationState.totalTime*i:e),this.animationState.stop(),this.animationState},p.play=function(){this._animationDataList&&(this.animationState.name?this._isPlaying?this.gotoAndPlay(this.animationState.name):this._isPlaying=!0:this.gotoAndPlay(this._animationDataList[0].name))},p.stop=function(){this._isPlaying=!1},p.advanceTime=function(t){this._isPlaying&&this.animationState._advanceTime(t*this._timeScale)},p.hasAnimation=function(t){return null!=this._animationDataObj[t]},i(p,"timeScale",function(){return this._timeScale},function(t){(isNaN(t)||0>t)&&(t=1),this._timeScale=t}),i(p,"animationDataList",function(){return this._animationDataList},function(t){this._animationDataList=t,this.animationList.length=0;for(var e=this._animationDataList.length,i=0;e>i;i++){var a=this._animationDataList[i];this.animationList.push(a.name),this._animationDataObj[a.name]=a}}),i(p,"movementList",function(){return this.animationList}),i(p,"movementID",function(){return this.lastAnimationName}),p.isPlaying=function(){return this._isPlaying&&!this.isComplete},i(p,"isComplete",function(){return this.animationState.isComplete}),i(p,"lastAnimationState",function(){return this.animationState}),i(p,"lastAnimationName",function(){return this.animationState?this.animationState.name:null}),e}();t.FastAnimation=e,egret.registerClass(e,"dragonBones.FastAnimation")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._boneTimelineStateList=[],this._slotTimelineStateList=[],this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._currentPlayTimes=0,this._totalTime=0,this._currentTime=0,this._lastTime=0,this._playTimes=0,this._fading=!1}var i=__define,a=e;return p=a.prototype,p.dispose=function(){this._resetTimelineStateList(),this._armature=null},p.play=function(){return this._isPlaying=!0,this},p.stop=function(){return this._isPlaying=!1,this},p.setCurrentTime=function(t){return(0>t||isNaN(t))&&(t=0),this._time=t,this._currentTime=1e3*this._time,this},p._resetTimelineStateList=function(){for(var e=this._boneTimelineStateList.length;e--;)t.FastBoneTimelineState.returnObject(this._boneTimelineStateList[e]);for(this._boneTimelineStateList.length=0,e=this._slotTimelineStateList.length;e--;)t.FastSlotTimelineState.returnObject(this._slotTimelineStateList[e]);this._slotTimelineStateList.length=0,this.name=null},p._fadeIn=function(t,e,i,a){this.animationData=t,this.name=this.animationData.name,this._totalTime=this.animationData.duration,this.autoTween=t.autoTween,this.setTimeScale(i),this.setPlayTimes(e),this._isComplete=!1,this._currentFrameIndex=-1,this._currentPlayTimes=-1,this._currentTime=Math.round(this._totalTime*this.animationData.frameRate*.001)<2?this._totalTime:-1,this._fadeTotalTime=a*this._timeScale,this._fading=this._fadeTotalTime>0,this._isPlaying=!0,this._armature.enableCache&&this.animationCache&&this._fading&&this._boneTimelineStateList&&this.updateTransformTimeline(this.progress),this._time=0,this._progress=0,this._updateTimelineStateList(),this.hideBones()},p._updateTimelineStateList=function(){this._resetTimelineStateList();for(var e,i=this.animationData.timelineList.length,a=0;i>a;a++){var n=this.animationData.timelineList[a];e=n.name;var s=this._armature.getBone(e);if(s){var r=t.FastBoneTimelineState.borrowObject();r.fadeIn(s,this,n),this._boneTimelineStateList.push(r)}}for(var o=this.animationData.slotTimelineList.length,l=0;o>l;l++){var h=this.animationData.slotTimelineList[l];e=h.name;var u=this._armature.getSlot(e);if(u&&u.displayList.length>0){var _=t.FastSlotTimelineState.borrowObject();_.fadeIn(u,this,h),this._slotTimelineStateList.push(_)}}},p._advanceTime=function(t){if(t*=this._timeScale,this._fading&&(this._time+=t,this._progress=this._time/this._fadeTotalTime,this._progress>=1&&(this._progress=0,this._time=0,this._fading=!1)),this._fading){for(var e=this._boneTimelineStateList.length,i=0;e>i;i++){var a=this._boneTimelineStateList[i];a.updateFade(this.progress)}for(var n=this._slotTimelineStateList.length,s=0;n>s;s++){var r=this._slotTimelineStateList[s];r.updateFade(this.progress)}}else this.advanceTimelinesTime(t)},p.advanceTimelinesTime=function(e){this._time+=e;var i=!1,a=!1,n=!1,s=0,r=1e3*this._time;0==this._playTimes||r<this._playTimes*this._totalTime?(n=!1,this._progress=r/this._totalTime,s=Math.ceil(this.progress)||1,this._progress-=Math.floor(this.progress),r%=this._totalTime):(s=this._playTimes,r=this._totalTime,n=!0,this._progress=1),this._isComplete=n,this.isUseCache()?this.animationCache.update(this.progress):this.updateTransformTimeline(this.progress),this._currentTime!=r&&(this._currentPlayTimes!=s&&(this._currentPlayTimes>0&&s>1&&(i=!0),this._currentPlayTimes=s),this._isComplete&&(a=!0),this._lastTime=this._currentTime,this._currentTime=r,this.updateMainTimeline(n));var o;a?this._armature.hasEventListener(t.AnimationEvent.COMPLETE)&&(o=new t.AnimationEvent(t.AnimationEvent.COMPLETE),o.animationState=this,this._armature._addEvent(o)):i&&this._armature.hasEventListener(t.AnimationEvent.LOOP_COMPLETE)&&(o=new t.AnimationEvent(t.AnimationEvent.LOOP_COMPLETE),o.animationState=this,this._armature._addEvent(o))},p.updateTransformTimeline=function(t){var e,i,a=this._boneTimelineStateList.length;if(this._isComplete){for(;a--;)e=this._boneTimelineStateList[a],e.update(t),this._isComplete=e._isComplete&&this._isComplete;for(a=this._slotTimelineStateList.length;a--;)i=this._slotTimelineStateList[a],i.update(t),this._isComplete=i._isComplete&&this._isComplete}else{for(;a--;)e=this._boneTimelineStateList[a],e.update(t);for(a=this._slotTimelineStateList.length;a--;)i=this._slotTimelineStateList[a],i.update(t)}},p.updateMainTimeline=function(t){var e=this.animationData.frameList;if(e.length>0){for(var i,a,n=0,s=this.animationData.frameList.length;s>n;++n){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._lastTime=this._currentTime,this._currentFrameIndex++,this._currentFrameIndex>=e.length){if(t){this._currentFrameIndex--;break}this._currentFrameIndex=0}}a=e[this._currentFrameIndex],i&&this._armature.arriveAtFrame(i,this),this._currentFrameDuration=a.duration,this._currentFramePosition=a.position,i=a}a&&this._armature.arriveAtFrame(a,this)}},p.setTimeScale=function(t){return(isNaN(t)||1/0==t)&&(t=1),this._timeScale=t,this},p.setPlayTimes=function(t){return void 0===t&&(t=0),this._playTimes=Math.round(.001*this._totalTime*this.animationData.frameRate)<2?1:t,this},i(p,"playTimes",function(){return this._playTimes}),i(p,"currentPlayTimes",function(){return this._currentPlayTimes<0?0:this._currentPlayTimes}),i(p,"isComplete",function(){return this._isComplete}),i(p,"isPlaying",function(){return this._isPlaying&&!this._isComplete}),i(p,"totalTime",function(){return.001*this._totalTime}),i(p,"currentTime",function(){return this._currentTime<0?0:.001*this._currentTime}),p.isUseCache=function(){return this._armature.enableCache&&this.animationCache&&!this._fading},p.hideBones=function(){for(var t=this.animationData.hideTimelineNameMap.length,e=0;t>e;e++){var i=this.animationData.hideTimelineNameMap[e],a=this._armature.getSlot(i);a&&a.hideSlots()}},i(p,"progress",function(){return this._progress}),e}();t.FastAnimationState=e,egret.registerClass(e,"dragonBones.FastAnimationState",["dragonBones.IAnimationState"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._lastTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._transform=new t.DBTransform,this._durationTransform=new t.DBTransform,this._transformToFadein=new t.DBTransform}var i=e;return p=i.prototype,e.borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e.returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e.clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},p.clear=function(){this._bone&&(this._bone._timelineState=null,this._bone=null),this._animationState=null,this._timelineData=null},p.fadeIn=function(e,i,a){switch(this._bone=e,this._animationState=i,this._timelineData=a,this.name=a.name,this._totalTime=this._timelineData.duration,this._isComplete=!1,this._tweenTransform=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}if(i._fadeTotalTime>0){this._bone._timelineState?this._transformToFadein.copy(this._bone._timelineState._transform):this._transformToFadein=new t.DBTransform;var n=this._timelineData.frameList[0];this._durationTransform.copy(n.transform),this._durationTransform.minus(this._transformToFadein)}this._bone._timelineState=this},p.updateFade=function(t){this._transform.x=this._transformToFadein.x+this._durationTransform.x*t,this._transform.y=this._transformToFadein.y+this._durationTransform.y*t,this._transform.scaleX=this._transformToFadein.scaleX*(1+(this._durationTransform.scaleX-1)*t),this._transform.scaleY=this._transformToFadein.scaleX*(1+(this._durationTransform.scaleY-1)*t),this._transform.rotation=this._transformToFadein.rotation+this._durationTransform.rotation*t,this._bone.invalidUpdate()},p.update=function(t){1==this._updateMode?(this._updateMode=0,this.updateSingleFrame()):-1==this._updateMode&&this.updateMultipleFrame(t)},p.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._bone.arriveAtFrame(t,this._animationState),this._isComplete=!0,this._tweenEasing=0/0,this._tweenTransform=!1,this._transform.copy(t.transform),this._bone.invalidUpdate()},p.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=Math.floor(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=Math.floor(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._lastTime=this._currentTime,this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._currentFrameIndex++,this._lastTime=this._currentTime,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._bone.arriveAtFrame(s,this._animationState),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._bone.arriveAtFrame(r,this._animationState),this.updateToNextFrame(e)),this._tweenTransform&&this.updateTween()}},p.updateToNextFrame=function(e){void 0===e&&(e=0);var i=this._currentFrameIndex+1;i>=this._timelineData.frameList.length&&(i=0);var a=this._timelineData.frameList[this._currentFrameIndex],n=this._timelineData.frameList[i],s=!1;0==i&&this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timelineData.offset)*this._timelineData.scale>.999999?(this._tweenEasing=0/0,s=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.animationData.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?s=!1:(10==this._tweenEasing&&(this._tweenEasing=0),s=!0)):s=!0):(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?s=!0:(this._tweenEasing=0/0,s=!1)),s?(this._durationTransform.x=n.transform.x-a.transform.x,this._durationTransform.y=n.transform.y-a.transform.y,this._durationTransform.skewX=n.transform.skewX-a.transform.skewX,this._durationTransform.skewY=n.transform.skewY-a.transform.skewY,this._durationTransform.scaleX=n.transform.scaleX-a.transform.scaleX+n.scaleOffset.x,this._durationTransform.scaleY=n.transform.scaleY-a.transform.scaleY+n.scaleOffset.y,this._durationTransform.normalizeRotation(),0==i&&(this._durationTransform.skewX=t.TransformUtil.formatRadian(this._durationTransform.skewX),this._durationTransform.skewY=t.TransformUtil.formatRadian(this._durationTransform.skewY)),this._tweenTransform=this._durationTransform.x||this._durationTransform.y||this._durationTransform.skewX||this._durationTransform.skewY||1!=this._durationTransform.scaleX||1!=this._durationTransform.scaleY?!0:!1):this._tweenTransform=!1,this._tweenTransform||(this._transform.copy(a.transform),this._bone.invalidUpdate())},p.updateTween=function(){var e=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;this._tweenCurve?e=this._tweenCurve.getValueByProgress(e):this._tweenEasing&&(e=t.MathUtil.getEaseValue(e,this._tweenEasing));{var i=this._timelineData.frameList[this._currentFrameIndex],a=i.transform;i.pivot}this._transform.x=a.x+this._durationTransform.x*e,this._transform.y=a.y+this._durationTransform.y*e,this._transform.skewX=a.skewX+this._durationTransform.skewX*e,this._transform.skewY=a.skewY+this._durationTransform.skewY*e,this._transform.scaleX=a.scaleX+this._durationTransform.scaleX*e,this._transform.scaleY=a.scaleY+this._durationTransform.scaleY*e,this._bone.invalidUpdate()},e._pool=[],e}();t.FastBoneTimelineState=e,egret.registerClass(e,"dragonBones.FastBoneTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._durationColor=new t.ColorTransform}var i=e;return p=i.prototype,e.borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e.returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e.clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},p.clear=function(){this._slot=null,this._armature=null,this._animation=null,this._animationState=null,this._timelineData=null},p.fadeIn=function(t,e,i){switch(this._slot=t,this._armature=this._slot.armature,this._animation=this._armature.animation,this._animationState=e,this._timelineData=i,this.name=i.name,this._totalTime=this._timelineData.duration,this._isComplete=!1,this._blendEnabled=!1,this._tweenColor=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._weight=1,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}},p.updateFade=function(){},p.update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},p.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=Math.floor(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=Math.floor(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration))break;if(this._currentFrameIndex++,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._slot._arriveAtFrame(s,this._animationState),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._slot._arriveAtFrame(r,this._animationState),this._blendEnabled=r.displayIndex>=0,this._blendEnabled?this.updateToNextFrame(e):(this._tweenEasing=0/0,this._tweenColor=!1)),this._blendEnabled&&this.updateTween()}},p.updateToNextFrame=function(e){void 0===e&&(e=0);var i=this._currentFrameIndex+1;i>=this._timelineData.frameList.length&&(i=0);var a=this._timelineData.frameList[this._currentFrameIndex],n=this._timelineData.frameList[i],s=!1;if(0==i&&this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timelineData.offset)*this._timelineData.scale>.999999?(this._tweenEasing=0/0,s=!1):a.displayIndex<0||n.displayIndex<0?(this._tweenEasing=0/0,s=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.animationData.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?s=!1:(10==this._tweenEasing&&(this._tweenEasing=0),s=!0)):s=!0):(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?s=!0:(this._tweenEasing=0/0,s=!1)),s&&(a.color||n.color)?(t.ColorTransformUtil.minus(n.color||t.ColorTransformUtil.originalColor,a.color||t.ColorTransformUtil.originalColor,this._durationColor),this._tweenColor=0!=this._durationColor.alphaOffset||0!=this._durationColor.redOffset||0!=this._durationColor.greenOffset||0!=this._durationColor.blueOffset||0!=this._durationColor.alphaMultiplier||0!=this._durationColor.redMultiplier||0!=this._durationColor.greenMultiplier||0!=this._durationColor.blueMultiplier):this._tweenColor=!1,!this._tweenColor){var r,o;
a.color?(r=a.color,o=!0):(r=t.ColorTransformUtil.originalColor,o=!1),(this._slot._isColorChanged||o)&&(t.ColorTransformUtil.isEqual(this._slot._colorTransform,r)||this._slot._updateDisplayColor(r.alphaOffset,r.redOffset,r.greenOffset,r.blueOffset,r.alphaMultiplier,r.redMultiplier,r.greenMultiplier,r.blueMultiplier,o))}},p.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];if(this._tweenColor){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve?i=this._tweenCurve.getValueByProgress(i):this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing)),e.color?this._slot._updateDisplayColor(e.color.alphaOffset+this._durationColor.alphaOffset*i,e.color.redOffset+this._durationColor.redOffset*i,e.color.greenOffset+this._durationColor.greenOffset*i,e.color.blueOffset+this._durationColor.blueOffset*i,e.color.alphaMultiplier+this._durationColor.alphaMultiplier*i,e.color.redMultiplier+this._durationColor.redMultiplier*i,e.color.greenMultiplier+this._durationColor.greenMultiplier*i,e.color.blueMultiplier+this._durationColor.blueMultiplier*i,!0):this._slot._updateDisplayColor(this._durationColor.alphaOffset*i,this._durationColor.redOffset*i,this._durationColor.greenOffset*i,this._durationColor.blueOffset*i,this._durationColor.alphaMultiplier*i+1,this._durationColor.redMultiplier*i+1,this._durationColor.greenMultiplier*i+1,this._durationColor.blueMultiplier*i+1,!0)}},p.updateSingleFrame=function(){var e=this._timelineData.frameList[0];if(this._slot._arriveAtFrame(e,this._animationState),this._isComplete=!0,this._tweenEasing=0/0,this._tweenColor=!1,this._blendEnabled=e.displayIndex>=0,this._blendEnabled){var i,a;e.color?(i=e.color,a=!0):(i=t.ColorTransformUtil.originalColor,a=!1),(this._slot._isColorChanged||a)&&(t.ColorTransformUtil.isEqual(this._slot._colorTransform,i)||this._slot._updateDisplayColor(i.alphaOffset,i.redOffset,i.greenOffset,i.blueOffset,i.alphaMultiplier,i.redMultiplier,i.greenMultiplier,i.blueMultiplier,a))}},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._pool=[],e}();t.FastSlotTimelineState=e,egret.registerClass(e,"dragonBones.FastSlotTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){e.call(this),this.isCacheManagerExclusive=!1,this._enableEventDispatch=!0,this.useCache=!0,this._display=i,this._animation=new t.FastAnimation(this),this._slotsZOrderChanged=!1,this._armatureData=null,this.boneList=[],this._boneDic={},this.slotList=[],this._slotDic={},this.slotHasChildArmatureList=[],this._eventList=[],this._delayDispose=!1,this._lockDispose=!1}__extends(i,e);var a=__define,n=i;return p=n.prototype,p.dispose=function(){if(this._delayDispose=!0,this._animation&&!this._lockDispose){this.userData=null,this._animation.dispose();for(var t=this.slotList.length;t--;)this.slotList[t].dispose();for(t=this.boneList.length;t--;)this.boneList[t].dispose();this.slotList.length=0,this.boneList.length=0,this._armatureData=null,this._animation=null,this.slotList=null,this.boneList=null,this._eventList=null}},p.advanceTime=function(t){this._lockDispose=!0,this._animation.advanceTime(t);var e,i,a=0;if(this._animation.animationState.isUseCache())for(this.useCache||(this.useCache=!0),a=this.slotList.length;a--;)i=this.slotList[a],i.updateByCache();else{if(this.useCache)for(this.useCache=!1,a=this.slotList.length;a--;)i=this.slotList[a],i.switchTransformToBackup();for(a=this.boneList.length;a--;)e=this.boneList[a],e.update();for(a=this.slotList.length;a--;)i=this.slotList[a],i._update()}for(a=this.slotHasChildArmatureList.length;a--;){i=this.slotHasChildArmatureList[a];var n=i.childArmature;n&&n.advanceTime(t)}for(this._slotsZOrderChanged&&this.updateSlotsZOrder();this._eventList.length>0;)this.dispatchEvent(this._eventList.shift());this._lockDispose=!1,this._delayDispose&&this.dispose()},p.enableAnimationCache=function(e,i,a){void 0===i&&(i=null),void 0===a&&(a=!0);var n=t.AnimationCacheManager.initWithArmatureData(this.armatureData,e);if(i)for(var s=i.length,r=0;s>r;r++){var o=i[r];n.initAnimationCache(o)}else n.initAllAnimationCache();return n.setCacheGeneratorArmature(this),n.generateAllAnimationCache(a),n.bindCacheUserArmature(this),this.enableCache=!0,n},p.getBone=function(t){return this._boneDic[t]},p.getSlot=function(t){return this._slotDic[t]},p.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},p.getSlotByDisplay=function(t){if(t)for(var e=0,i=this.slotList.length;i>e;e++)if(this.slotList[e].display==t)return this.slotList[e];return null},p.getSlots=function(t){return void 0===t&&(t=!0),t?this.slotList.concat():this.slotList},p._updateBonesByCache=function(){for(var t,e=this.boneList.length;e--;)t=this.boneList[e],t.update()},p.addBone=function(t,e){void 0===e&&(e=null);var i;e&&(i=this.getBone(e),i.boneList.push(t)),t.armature=this,t.setParent(i),this.boneList.unshift(t),this._boneDic[t.name]=t},p.addSlot=function(t,e){var i=this.getBone(e);if(!i)throw new Error;t.armature=this,t.setParent(i),i.slotList.push(t),t._addDisplayToContainer(this.display),this.slotList.push(t),this._slotDic[t.name]=t,t.hasChildArmature&&this.slotHasChildArmatureList.push(t)},p.updateSlotsZOrder=function(){this.slotList.sort(this.sortSlot);for(var t=this.slotList.length;t--;){var e=this.slotList[t];(e._frameCache&&e._frameCache.displayIndex>=0||!e._frameCache&&e.displayIndex>=0)&&e._addDisplayToContainer(this._display)}this._slotsZOrderChanged=!1},p.sortBoneList=function(){var e=this.boneList.length;if(0!=e){for(var i=[];e--;){for(var a=0,n=this.boneList[e],s=n;s;)a++,s=s.parent;i[e]=[a,n]}for(i.sort(t.ArmatureData.sortBoneDataHelpArrayDescending),e=i.length;e--;)this.boneList[e]=i[e][1];i.length=0}},p.arriveAtFrame=function(e,i){if(e.event&&this.hasEventListener(t.FrameEvent.ANIMATION_FRAME_EVENT)){var a=new t.FrameEvent(t.FrameEvent.ANIMATION_FRAME_EVENT);a.animationState=i,a.frameLabel=e.event,this._addEvent(a)}e.action&&this.animation.gotoAndPlay(e.action)},p.invalidUpdate=function(t){if(void 0===t&&(t=null),t){var e=this.getBone(t);e&&e.invalidUpdate()}else for(var i=this.boneList.length;i--;)this.boneList[i].invalidUpdate()},p.resetAnimation=function(){this.animation.animationState._resetTimelineStateList();for(var t=this.boneList.length,e=0;t>e;e++){var i=this.boneList[e];i._timelineState=null}this.animation.stop()},p.sortSlot=function(t,e){return t.zOrder<e.zOrder?1:-1},p.getAnimation=function(){return this._animation},a(p,"armatureData",function(){return this._armatureData}),a(p,"animation",function(){return this._animation}),a(p,"display",function(){return this._display}),a(p,"enableCache",function(){return this._enableCache},function(t){this._enableCache=t}),a(p,"enableEventDispatch",function(){return this._enableEventDispatch},function(t){this._enableEventDispatch=t}),p._addEvent=function(t){this._enableEventDispatch&&this._eventList.push(t)},i}(t.EventDispatcher);t.FastArmature=e,egret.registerClass(e,"dragonBones.FastArmature",["dragonBones.ICacheableArmature","dragonBones.IArmature","dragonBones.IAnimatable"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._globalTransformMatrix=new t.Matrix,this._global=new t.DBTransform,this._origin=new t.DBTransform,this._visible=!0,this.armature=null,this._parent=null,this.userData=null,this.inheritRotation=!0,this.inheritScale=!0,this.inheritTranslation=!0}var i=__define,a=e;return p=a.prototype,p.updateByCache=function(){this._global=this._frameCache.globalTransform,this._globalTransformMatrix=this._frameCache.globalTransformMatrix},p.switchTransformToBackup=function(){this._globalBackup||(this._globalBackup=new t.DBTransform,this._globalTransformMatrixBackup=new t.Matrix),this._global=this._globalBackup,this._globalTransformMatrix=this._globalTransformMatrixBackup},p.setParent=function(t){this._parent=t},p.dispose=function(){this.userData=null,this._globalTransformMatrix=null,this._global=null,this._origin=null,this.armature=null,this._parent=null},p._calculateParentTransform=function(){if(this.parent&&(this.inheritTranslation||this.inheritRotation||this.inheritScale)){var i=this._parent._global,a=this._parent._globalTransformMatrix;return(this.inheritTranslation||0==i.x&&0==i.y)&&(this.inheritRotation||0==i.skewX&&0==i.skewY)&&(this.inheritScale||1==i.scaleX&&1==i.scaleY)||(i=e._tempParentGlobalTransform,i.copy(this._parent._global),this.inheritTranslation||(i.x=0,i.y=0),this.inheritScale||(i.scaleX=1,i.scaleY=1),this.inheritRotation||(i.skewX=0,i.skewY=0),a=t.DBObject._tempParentGlobalTransformMatrix,t.TransformUtil.transformToMatrix(i,a)),e.tempOutputObj.parentGlobalTransform=i,e.tempOutputObj.parentGlobalTransformMatrix=a,e.tempOutputObj}return null},p._updateGlobal=function(){this._calculateRelativeParentTransform();var e=this._calculateParentTransform();if(null!=e){var i=e.parentGlobalTransformMatrix,a=e.parentGlobalTransform,n=this._global.x,s=this._global.y;this._global.x=i.a*n+i.c*s+i.tx,this._global.y=i.d*s+i.b*n+i.ty,this.inheritRotation&&(this._global.skewX+=a.skewX,this._global.skewY+=a.skewY),this.inheritScale&&(this._global.scaleX*=a.scaleX,this._global.scaleY*=a.scaleY)}return t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix,!0),e},p._calculateRelativeParentTransform=function(){},i(p,"name",function(){return this._name},function(t){this._name=t}),i(p,"global",function(){return this._global}),i(p,"globalTransformMatrix",function(){return this._globalTransformMatrix}),i(p,"origin",function(){return this._origin}),i(p,"parent",function(){return this._parent}),i(p,"visible",function(){return this._visible},function(t){this._visible=t}),i(p,"frameCache",void 0,function(t){this._frameCache=t}),e._tempParentGlobalTransform=new t.DBTransform,e.tempOutputObj={},e}();t.FastDBObject=e,egret.registerClass(e,"dragonBones.FastDBObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.slotList=[],this.boneList=[],this._needUpdate=0,this._needUpdate=2}__extends(i,e);var a=__define,n=i;return p=n.prototype,i.initWithBoneData=function(t){var e=new i;return e.name=t.name,e.inheritRotation=t.inheritRotation,e.inheritScale=t.inheritScale,e.origin.copy(t.transform),e},p.getBones=function(t){return void 0===t&&(t=!0),t?this.boneList.concat():this.boneList},p.getSlots=function(t){return void 0===t&&(t=!0),t?this.slotList.concat():this.slotList},p.dispose=function(){e.prototype.dispose.call(this),this._timelineState=null},p.invalidUpdate=function(){this._needUpdate=2},p._calculateRelativeParentTransform=function(){this._global.copy(this._origin),this._timelineState&&this._global.add(this._timelineState._transform)},p.updateByCache=function(){e.prototype.updateByCache.call(this),this._global=this._frameCache.globalTransform,this._globalTransformMatrix=this._frameCache.globalTransformMatrix},p.update=function(t){void 0===t&&(t=!1),this._needUpdate--,(t||this._needUpdate>0||this._parent&&this._parent._needUpdate>0)&&(this._needUpdate=1,this._updateGlobal())},p.arriveAtFrame=function(e,i){if(e.event&&this.armature.hasEventListener(t.FrameEvent.BONE_FRAME_EVENT)){var a=new t.FrameEvent(t.FrameEvent.BONE_FRAME_EVENT);a.bone=this,a.animationState=i,a.frameLabel=e.event,this.armature._addEvent(a)}},a(p,"childArmature",function(){var t=this.slot;return t?t.childArmature:null}),a(p,"display",function(){var t=this.slot;return t?t.display:null},function(t){var e=this.slot;e&&(e.display=t)}),a(p,"visible",void 0,function(t){if(this._visible!=t){this._visible=t;for(var e=0,i=this.armature.slotList.length;i>e;e++)this.armature.slotList[e].parent==this&&this.armature.slotList[e]._updateDisplayVisible(this._visible)}}),a(p,"slot",function(){return this.slotList.length>0?this.slotList[0]:null}),i}(t.FastDBObject);t.FastBone=e,egret.registerClass(e,"dragonBones.FastBone")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){if(e.call(this),this._currentDisplayIndex=0,i!=this)throw new Error("Abstract class can not be instantiated!");this.hasChildArmature=!1,this._currentDisplayIndex=-1,this._originZOrder=0,this._tweenZOrder=0,this._offsetZOrder=0,this._colorTransform=new t.ColorTransform,this._isColorChanged=!1,this._displayDataList=null,this._currentDisplay=null,this.inheritRotation=!0,this.inheritScale=!0}__extends(i,e);var a=__define,n=i;return p=n.prototype,p.initWithSlotData=function(t){this.name=t.name,this.blendMode=t.blendMode,this._originZOrder=t.zOrder,this._displayDataList=t.displayDataList},p.dispose=function(){this._displayList&&(e.prototype.dispose.call(this),this._displayDataList=null,this._displayList=null,this._currentDisplay=null)},p.updateByCache=function(){e.prototype.updateByCache.call(this),this._updateTransform();var i=this._frameCache.colorTransform,a=null!=i;(this.colorChanged!=a||this.colorChanged&&a&&!t.ColorTransformUtil.isEqual(this._colorTransform,i))&&(i=i||t.ColorTransformUtil.originalColor,this._updateDisplayColor(i.alphaOffset,i.redOffset,i.greenOffset,i.blueOffset,i.alphaMultiplier,i.redMultiplier,i.greenMultiplier,i.blueMultiplier,a)),this._changeDisplayIndex(this._frameCache.displayIndex)},p._update=function(){this._parent._needUpdate<=0||(this._updateGlobal(),this._updateTransform())},p._calculateRelativeParentTransform=function(){this._global.copy(this._origin)},p.initDisplayList=function(t){this._displayList=t},p.clearCurrentDisplay=function(){if(this.hasChildArmature){var t=this.childArmature;t&&t.resetAnimation()}var e=this._getDisplayIndex();return this._removeDisplayFromContainer(),e},p._changeDisplayIndex=function(t){if(void 0===t&&(t=0),this._currentDisplayIndex!=t){var e=-1;this._currentDisplayIndex>=0&&(e=this.clearCurrentDisplay()),this._currentDisplayIndex=t,this._currentDisplayIndex>=0&&(this._origin.copy(this._displayDataList[this._currentDisplayIndex].transform),this.initCurrentDisplay(e))}},p.changeSlotDisplay=function(t){var e=this.clearCurrentDisplay();this._displayList[this._currentDisplayIndex]=t,this.initCurrentDisplay(e)},p.initCurrentDisplay=function(e){void 0===e&&(e=0);var i=this._displayList[this._currentDisplayIndex];if(this._currentDisplay=i?i instanceof t.FastArmature?i.display:i:null,this._updateDisplay(this._currentDisplay),this._currentDisplay&&(-1!=e?this._addDisplayToContainer(this.armature.display,e):(this.armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this.armature.display)),this._blendMode&&this._updateDisplayBlendMode(this._blendMode),this._isColorChanged&&this._updateDisplayColor(this._colorTransform.alphaOffset,this._colorTransform.redOffset,this._colorTransform.greenOffset,this._colorTransform.blueOffset,this._colorTransform.alphaMultiplier,this._colorTransform.redMultiplier,this._colorTransform.greenMultiplier,this._colorTransform.blueMultiplier,!0),this._updateTransform(),i instanceof t.FastArmature)){var a=i;this.armature&&this.armature.animation.animationState&&a.animation.hasAnimation(this.armature.animation.animationState.name)?a.animation.gotoAndPlay(this.armature.animation.animationState.name):a.animation.play()}},a(p,"visible",void 0,function(t){this._visible!=t&&(this._visible=t,this._updateDisplayVisible(this._visible))}),a(p,"displayList",function(){return this._displayList},function(t){if(!t)throw new Error;var e=t[this._currentDisplayIndex],i=this._currentDisplayIndex>=0&&this._displayList[this._currentDisplayIndex]!=e;this._displayList=t,i&&this.changeSlotDisplay(e)}),a(p,"display",function(){return this._currentDisplay},function(t){this._currentDisplayIndex<0||this._displayList[this._currentDisplayIndex]!=t&&this.changeSlotDisplay(t)}),a(p,"childArmature",function(){return this._displayList[this._currentDisplayIndex]instanceof t.Armature||this._displayList[this._currentDisplayIndex]instanceof t.FastArmature?this._displayList[this._currentDisplayIndex]:null},function(t){this.display=t}),a(p,"zOrder",function(){return this._originZOrder+this._tweenZOrder+this._offsetZOrder},function(t){this.zOrder!=t&&(this._offsetZOrder=t-this._originZOrder-this._tweenZOrder,this.armature&&(this.armature._slotsZOrderChanged=!0))}),a(p,"blendMode",function(){return this._blendMode},function(t){this._blendMode!=t&&(this._blendMode=t,this._updateDisplayBlendMode(this._blendMode))}),a(p,"colorTransform",function(){return this._colorTransform}),a(p,"displayIndex",function(){return this._currentDisplayIndex}),a(p,"colorChanged",function(){return this._isColorChanged}),p._updateDisplay=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._getDisplayIndex=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._addDisplayToContainer=function(t,e){throw void 0===e&&(e=-1),new Error("Abstract method needs to be implemented in subclass!")},p._removeDisplayFromContainer=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._updateTransform=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._updateDisplayVisible=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._updateDisplayColor=function(t,e,i,a,n,s,r,o,l){void 0===l&&(l=!1),this._colorTransform.alphaOffset=t,this._colorTransform.redOffset=e,this._colorTransform.greenOffset=i,this._colorTransform.blueOffset=a,this._colorTransform.alphaMultiplier=n,this._colorTransform.redMultiplier=s,this._colorTransform.greenMultiplier=r,this._colorTransform.blueMultiplier=o,this._isColorChanged=l},p._updateDisplayBlendMode=function(){throw new Error("Abstract method needs to be implemented in subclass!")},p._arriveAtFrame=function(t){var e=t,i=e.displayIndex;if(this._changeDisplayIndex(i),this._updateDisplayVisible(e.visible),i>=0&&(isNaN(e.zOrder)||e.zOrder==this._tweenZOrder||(this._tweenZOrder=e.zOrder,this.armature._slotsZOrderChanged=!0)),t.action){var a=this.childArmature;a&&a.getAnimation().gotoAndPlay(t.action)}},p.hideSlots=function(){this._changeDisplayIndex(-1),this._removeDisplayFromContainer(),this._frameCache&&this._frameCache.clear()},p._updateGlobal=function(){this._calculateRelativeParentTransform(),t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix,!0);var e=this._calculateParentTransform();return e&&(this._globalTransformMatrix.concat(e.parentGlobalTransformMatrix),t.TransformUtil.matrixToTransform(this._globalTransformMatrix,this._global,this._global.scaleX*e.parentGlobalTransform.scaleX>=0,this._global.scaleY*e.parentGlobalTransform.scaleY>=0)),e},i}(t.FastDBObject);t.FastSlot=e,egret.registerClass(e,"dragonBones.FastSlot",["dragonBones.ISlotCacheGenerator","dragonBones.ICacheUser"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var e=t;return p=e.prototype,p.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},t}();t.Point=e,egret.registerClass(e,"dragonBones.Point")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),this.x=t,this.y=e,this.width=i,this.height=a}var e=t;return p=e.prototype,t}();t.Rectangle=e,egret.registerClass(e,"dragonBones.Rectangle")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.duration=0,this._frameList=[],this.duration=0,this.scale=1}var e=__define,i=t;return p=i.prototype,p.dispose=function(){for(var t=this._frameList.length;t--;)this._frameList[t].dispose();this._frameList=null},p.addFrame=function(t){if(!t)throw new Error;if(!(this._frameList.indexOf(t)<0))throw new Error;this._frameList[this._frameList.length]=t},e(p,"frameList",function(){return this._frameList}),t}();t.Timeline=e,egret.registerClass(e,"dragonBones.Timeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.frameRate=0,this.playTimes=0,this.lastFrameDuration=0,this.fadeTime=0,this.playTimes=0,this.autoTween=!0,this.tweenEasing=0/0,this.hideTimelineNameMap=[],this._timelineList=[],this._slotTimelineList=[]}__extends(e,t);var i=__define,a=e;return p=a.prototype,i(p,"timelineList",function(){return this._timelineList}),i(p,"slotTimelineList",function(){return this._slotTimelineList}),p.dispose=function(){t.prototype.dispose.call(this),this.hideTimelineNameMap=null;var e=0,i=0;for(e=0,i=this._timelineList.length;i>e;e++){var a=this._timelineList[e];a.dispose()}for(this._timelineList=null,e=0,i=this._slotTimelineList.length;i>e;e++){var n=this._slotTimelineList[e];n.dispose()}this._slotTimelineList=null},p.getTimeline=function(t){for(var e=this._timelineList.length;e--;)if(this._timelineList[e].name==t)return this._timelineList[e];return null},p.addTimeline=function(t){if(!t)throw new Error;this._timelineList.indexOf(t)<0&&(this._timelineList[this._timelineList.length]=t)},p.getSlotTimeline=function(t){for(var e=this._slotTimelineList.length;e--;)if(this._slotTimelineList[e].name==t)return this._slotTimelineList[e];return null},p.addSlotTimeline=function(t){if(!t)throw new Error;this._slotTimelineList.indexOf(t)<0&&(this._slotTimelineList[this._slotTimelineList.length]=t)},e}(t.Timeline);t.AnimationData=e,egret.registerClass(e,"dragonBones.AnimationData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this._boneDataList=[],this._skinDataList=[],this._slotDataList=[],this._animationDataList=[]}var e=__define,i=t;return p=i.prototype,t.sortBoneDataHelpArray=function(t,e){return t[0]>e[0]?1:-1},t.sortBoneDataHelpArrayDescending=function(t,e){return t[0]>e[0]?-1:1},p.setSkinData=function(t){var e=0,i=this._slotDataList.length;for(e=0;i>e;e++)this._slotDataList[e].dispose();var a;if(!t&&this._skinDataList.length>0)a=this._skinDataList[0];else for(e=0,i=this._skinDataList.length;i>e;e++)if(this._skinDataList[e].name==t){a=this._skinDataList[e];break}if(a){var n;for(e=0,i=a.slotDataList.length,e=0;i>e;e++)if(n=this.getSlotData(a.slotDataList[e].name)){var s=0,r=a.slotDataList[e].displayDataList.length;for(s=0;r>s;s++)n.addDisplayData(a.slotDataList[e].displayDataList[s])}}},p.dispose=function(){for(var t=this._boneDataList.length;t--;)this._boneDataList[t].dispose();for(t=this._skinDataList.length;t--;)this._skinDataList[t].dispose();for(t=this._slotDataList.length;t--;)this._slotDataList[t].dispose();for(t=this._animationDataList.length;t--;)this._animationDataList[t].dispose();this._boneDataList=null,this._slotDataList=null,this._skinDataList=null,this._animationDataList=null},p.getBoneData=function(t){for(var e=this._boneDataList.length;e--;)if(this._boneDataList[e].name==t)return this._boneDataList[e];return null},p.getSlotData=function(t){for(var e=this._slotDataList.length;e--;)if(this._slotDataList[e].name==t)return this._slotDataList[e];return null},p.getSkinData=function(t){if(!t&&this._skinDataList.length>0)return this._skinDataList[0];for(var e=this._skinDataList.length;e--;)if(this._skinDataList[e].name==t)return this._skinDataList[e];return null},p.getAnimationData=function(t){for(var e=this._animationDataList.length;e--;)if(this._animationDataList[e].name==t)return this._animationDataList[e];return null},p.addBoneData=function(t){if(!t)throw new Error;if(!(this._boneDataList.indexOf(t)<0))throw new Error;this._boneDataList[this._boneDataList.length]=t},p.addSlotData=function(t){if(!t)throw new Error;if(!(this._slotDataList.indexOf(t)<0))throw new Error;this._slotDataList[this._slotDataList.length]=t},p.addSkinData=function(t){if(!t)throw new Error;if(!(this._skinDataList.indexOf(t)<0))throw new Error;this._skinDataList[this._skinDataList.length]=t},p.addAnimationData=function(t){if(!t)throw new Error;this._animationDataList.indexOf(t)<0&&(this._animationDataList[this._animationDataList.length]=t)},p.sortBoneDataList=function(){var e=this._boneDataList.length;if(0!=e){for(var i=[];e--;){for(var a=this._boneDataList[e],n=0,s=a;s;)n++,s=this.getBoneData(s.parent);i[e]=[n,a]}for(i.sort(t.sortBoneDataHelpArray),e=i.length;e--;)this._boneDataList[e]=i[e][1]}},e(p,"boneDataList",function(){return this._boneDataList}),e(p,"slotDataList",function(){return this._slotDataList}),e(p,"skinDataList",function(){return this._skinDataList}),e(p,"animationDataList",function(){return this._animationDataList}),t}();t.ArmatureData=e,egret.registerClass(e,"dragonBones.ArmatureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.length=0,this.global=new t.DBTransform,this.transform=new t.DBTransform,this.inheritRotation=!0,this.inheritScale=!1}var i=e;return p=i.prototype,p.dispose=function(){this.global=null,this.transform=null},e}();t.BoneData=e,egret.registerClass(e,"dragonBones.BoneData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.alphaMultiplier=1,this.alphaOffset=0,this.blueMultiplier=1,this.blueOffset=0,this.greenMultiplier=1,this.greenOffset=0,this.redMultiplier=1,this.redOffset=0}var e=t;return p=e.prototype,t}();t.ColorTransform=e,egret.registerClass(e,"dragonBones.ColorTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._dataChanged=!1,this._pointList=[],this.sampling=new Array(e.SamplingTimes);for(var i=0;i<e.SamplingTimes-1;i++)this.sampling[i]=new t.Point}var i=__define,a=e;return p=a.prototype,p.getValueByProgress=function(t){this._dataChanged&&this.refreshSampling();for(var i=0;i<e.SamplingTimes-1;i++){var a=this.sampling[i];if(a.x>=t){if(0==i)return a.y*t/a.x;var n=this.sampling[i-1];return n.y+(a.y-n.y)*(t-n.x)/(a.x-n.x)}}return a.y+(1-a.y)*(t-a.x)/(1-a.x)},p.refreshSampling=function(){for(var t=0;t<e.SamplingTimes-1;t++)this.bezierCurve(e.SamplingStep*(t+1),this.sampling[t]);this._dataChanged=!1},p.bezierCurve=function(t,e){var i=1-t;e.x=3*this.point1.x*t*i*i+3*this.point2.x*t*t*i+Math.pow(t,3),e.y=3*this.point1.y*t*i*i+3*this.point2.y*t*t*i+Math.pow(t,3)},i(p,"pointList",function(){return this._pointList},function(t){this._pointList=t,this._dataChanged=!0}),p.isCurve=function(){return 0!=this.point1.x||0!=this.point1.y||1!=this.point2.x||1!=this.point2.y},i(p,"point1",function(){return this.pointList[0]}),i(p,"point2",function(){return this.pointList[1]}),e.SamplingTimes=20,e.SamplingStep=.05,e}();t.CurveData=e,egret.registerClass(e,"dragonBones.CurveData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.transform=new t.DBTransform,this.pivot=new t.Point}var i=e;return p=i.prototype,p.dispose=function(){this.transform=null,this.pivot=null},e.ARMATURE="armature",e.IMAGE="image",e}();t.DisplayData=e,egret.registerClass(e,"dragonBones.DisplayData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this._armatureDataList=[],this._displayDataDictionary={}}var e=__define,i=t;return p=i.prototype,p.dispose=function(){for(var t=0,e=this._armatureDataList.length;e>t;t++){var i=this._armatureDataList[t];i.dispose()}this._armatureDataList=null,this.removeAllDisplayData(),this._displayDataDictionary=null},e(p,"armatureDataList",function(){return this._armatureDataList}),p.getArmatureDataByName=function(t){for(var e=this._armatureDataList.length;e--;)if(this._armatureDataList[e].name==t)return this._armatureDataList[e];return null},p.addArmatureData=function(t){if(!t)throw new Error;if(!(this._armatureDataList.indexOf(t)<0))throw new Error;this._armatureDataList[this._armatureDataList.length]=t},p.removeArmatureData=function(t){var e=this._armatureDataList.indexOf(t);e>=0&&this._armatureDataList.splice(e,1)},p.removeArmatureDataByName=function(t){for(var e=this._armatureDataList.length;e--;)this._armatureDataList[e].name==t&&this._armatureDataList.splice(e,1)},p.getDisplayDataByName=function(t){return this._displayDataDictionary[t]},p.addDisplayData=function(t){this._displayDataDictionary[t.name]=t},p.removeDisplayDataByName=function(t){delete this._displayDataDictionary[t]},p.removeAllDisplayData=function(){for(var t in this._displayDataDictionary)delete this._displayDataDictionary[t]},t}();t.DragonBonesData=e,egret.registerClass(e,"dragonBones.DragonBonesData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.position=0,this.duration=0,this.position=0,this.duration=0}var e=t;return p=e.prototype,p.dispose=function(){},t}();t.Frame=e,egret.registerClass(e,"dragonBones.Frame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this._slotDataList=[]}var e=__define,i=t;return p=i.prototype,p.dispose=function(){for(var t=this._slotDataList.length;t--;)this._slotDataList[t].dispose();this._slotDataList=null},p.getSlotData=function(t){for(var e=this._slotDataList.length;e--;)if(this._slotDataList[e].name==t)return this._slotDataList[e];return null},p.addSlotData=function(t){if(!t)throw new Error;if(!(this._slotDataList.indexOf(t)<0))throw new Error;this._slotDataList[this._slotDataList.length]=t},e(p,"slotDataList",function(){return this._slotDataList}),t}();t.SkinData=e,egret.registerClass(e,"dragonBones.SkinData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this._displayDataList=[],this.zOrder=0}var e=__define,i=t;return p=i.prototype,p.dispose=function(){this._displayDataList.length=0},p.addDisplayData=function(t){if(!t)throw new Error;if(!(this._displayDataList.indexOf(t)<0))throw new Error;this._displayDataList[this._displayDataList.length]=t},p.getDisplayData=function(t){for(var e=this._displayDataList.length;e--;)if(this._displayDataList[e].name==t)return this._displayDataList[e];return null},e(p,"displayDataList",function(){return this._displayDataList}),t}();t.SlotData=e,egret.registerClass(e,"dragonBones.SlotData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.displayIndex=0,this.tweenEasing=10,this.displayIndex=0,this.visible=!0,this.zOrder=0/0}__extends(e,t);var i=e;return p=i.prototype,p.dispose=function(){t.prototype.dispose.call(this),this.color=null},e}(t.Frame);t.SlotFrame=e,egret.registerClass(e,"dragonBones.SlotFrame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.offset=0}__extends(e,t);var i=e;return p=i.prototype,p.dispose=function(){t.prototype.dispose.call(this)},e}(t.Timeline);t.SlotTimeline=e,egret.registerClass(e,"dragonBones.SlotTimeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.tweenRotate=0,this.displayIndex=0,this.tweenEasing=10,this.tweenRotate=0,this.tweenScale=!0,this.displayIndex=0,this.visible=!0,this.zOrder=0/0,this.global=new t.DBTransform,this.transform=new t.DBTransform,this.pivot=new t.Point,this.scaleOffset=new t.Point}__extends(i,e);var a=i;return p=a.prototype,p.dispose=function(){e.prototype.dispose.call(this),this.global=null,this.transform=null,this.pivot=null,this.scaleOffset=null,this.color=null},i}(t.Frame);t.TransformFrame=e,egret.registerClass(e,"dragonBones.TransformFrame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.originTransform=new t.DBTransform,this.originTransform.scaleX=1,this.originTransform.scaleY=1,this.originPivot=new t.Point,this.offset=0}__extends(i,e);var a=i;return p=a.prototype,p.dispose=function(){e.prototype.dispose.call(this),this.originTransform=null,this.originPivot=null},i}(t.Timeline);t.TransformTimeline=e,egret.registerClass(e,"dragonBones.TransformTimeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=e;return p=i.prototype,e.parseDragonBonesData=function(i){if(!i)throw new Error;var a=i[t.ConstValues.A_VERSION];if(a=a.toString(),a.toString()!=t.DragonBones.DATA_VERSION&&a.toString()!=t.DragonBones.PARENT_COORDINATE_DATA_VERSION&&"2.3"!=a.toString())throw new Error("Nonsupport version!");
var n=e.getNumber(i,t.ConstValues.A_FRAME_RATE,0)||0,s=new t.DragonBonesData;s.name=i[t.ConstValues.A_NAME],s.isGlobal="0"==i[t.ConstValues.A_IS_GLOBAL]?!1:!0,e.tempDragonBonesData=s;var r=i[t.ConstValues.ARMATURE];for(var o in r){var l=i[t.ConstValues.ARMATURE][o];s.addArmatureData(e.parseArmatureData(l,n))}return e.tempDragonBonesData=null,s},e.parseArmatureData=function(i,a){var n=new t.ArmatureData;n.name=i[t.ConstValues.A_NAME];var s=i[t.ConstValues.BONE];for(var r in s){var o=s[r];n.addBoneData(e.parseBoneData(o))}var l=i[t.ConstValues.SKIN];for(var h in l){var u=l[h],_=u[t.ConstValues.SLOT];for(var m in _){var f=_[m];n.addSlotData(e.parseSlotData(f))}}for(var r in l){var d=l[r];n.addSkinData(e.parseSkinData(d))}e.tempDragonBonesData.isGlobal&&t.DBDataUtil.transformArmatureData(n),n.sortBoneDataList();var p=i[t.ConstValues.ANIMATION];for(var r in p){var c=p[r],g=e.parseAnimationData(c,a);t.DBDataUtil.addHideTimeline(g,n),t.DBDataUtil.transformAnimationData(g,n,e.tempDragonBonesData.isGlobal),n.addAnimationData(g)}return n},e.parseBoneData=function(i){var a=new t.BoneData;return a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.length=Number(i[t.ConstValues.A_LENGTH])||0,a.inheritRotation=e.getBoolean(i,t.ConstValues.A_INHERIT_ROTATION,!0),a.inheritScale=e.getBoolean(i,t.ConstValues.A_INHERIT_SCALE,!0),e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform),e.tempDragonBonesData.isGlobal&&a.global.copy(a.transform),a},e.parseSkinData=function(i){var a=new t.SkinData;a.name=i[t.ConstValues.A_NAME];var n=i[t.ConstValues.SLOT];for(var s in n){var r=n[s];a.addSlotData(e.parseSkinSlotData(r))}return a},e.parseSkinSlotData=function(i){var a=new t.SlotData;a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=i[t.ConstValues.A_Z_ORDER],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,a.blendMode=i[t.ConstValues.A_BLENDMODE];var n=i[t.ConstValues.DISPLAY];for(var s in n){var r=n[s];a.addDisplayData(e.parseDisplayData(r))}return a},e.parseSlotData=function(i){var a=new t.SlotData;return a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=i[t.ConstValues.A_Z_ORDER],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,a.blendMode=i[t.ConstValues.A_BLENDMODE],a.displayIndex=0,a},e.parseDisplayData=function(i){var a=new t.DisplayData;return a.name=i[t.ConstValues.A_NAME],a.type=i[t.ConstValues.A_TYPE],e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform,a.pivot),null!=e.tempDragonBonesData&&e.tempDragonBonesData.addDisplayData(a),a},e.parseAnimationData=function(i,a){var n=new t.AnimationData;n.name=i[t.ConstValues.A_NAME],n.frameRate=a,n.duration=Math.round(1e3*(e.getNumber(i,t.ConstValues.A_DURATION,1)||1)/a),n.playTimes=e.getNumber(i,t.ConstValues.A_LOOP,1),n.playTimes=0/0!=n.playTimes?n.playTimes:1,n.fadeTime=e.getNumber(i,t.ConstValues.A_FADE_IN_TIME,0)||0,n.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,0/0),n.autoTween=e.getBoolean(i,t.ConstValues.A_AUTO_TWEEN,!0);var s=i[t.ConstValues.FRAME],r=0,o=0;if(s)for(r=0,o=s.length;o>r;r++){var l=s[r],h=e.parseTransformFrame(l,a);n.addFrame(h)}e.parseTimeline(i,n);var u=n.duration,_=[],m=[],f=i[t.ConstValues.TIMELINE];if(f){for(r=0,o=f.length;o>r;r++){var d=f[r],p=e.parseTransformTimeline(d,n.duration,a);p=e.parseTransformTimeline(d,n.duration,a),u=Math.min(u,p.frameList[p.frameList.length-1].duration),n.addTimeline(p);var c=e.parseSlotTimeline(d,n.duration,a);if(n.addSlotTimeline(c),n.autoTween){for(var g,T,v=0,D=c.frameList.length;D>v;v++)if(T=c.frameList[v],T&&T.displayIndex<0){g=!0;break}g&&(m.push(p),_.push(c))}}o=_.length;var A=n.tweenEasing;if(o>0){for(r=0;o>r;r++){c=_[r],p=m[r];var y,C,L;for(v=0,D=c.frameList.length;D>v;v++)C=c.frameList[v],y=p.frameList[v],L=v==D-1?c.frameList[0]:c.frameList[v+1],C.displayIndex<0||L.displayIndex<0?y.tweenEasing=C.tweenEasing=0/0:10==A?y.tweenEasing=C.tweenEasing=0:isNaN(A)?10==y.tweenEasing&&(y.tweenEasing=0):y.tweenEasing=C.tweenEasing=A}n.autoTween=!1}}return n.frameList.length>0&&(u=Math.min(u,n.frameList[n.frameList.length-1].duration)),n.lastFrameDuration=u,n},e.parseSlotTimeline=function(i,a,n){var s=new t.SlotTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.duration=a;var r=i[t.ConstValues.FRAME];for(var o in r){var l=r[o],h=e.parseSlotFrame(l,n);s.addFrame(h)}return e.parseTimeline(i,s),s},e.parseSlotFrame=function(i,a){var n=new t.SlotFrame;e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.displayIndex=Math.floor(e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0)||0),n.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,e.tempDragonBonesData.isGlobal?0/0:0);var s=i[t.ConstValues.COLOR_TRANSFORM];return s&&(n.color=new t.ColorTransform,e.parseColorTransform(s,n.color)),n},e.parseTransformTimeline=function(i,a,n){var s=new t.TransformTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.originPivot.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,s.originPivot.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0,s.duration=a;var r=i[t.ConstValues.FRAME];for(var o in r){var l=r[o],h=e.parseTransformFrame(l,n);s.addFrame(h)}return e.parseTimeline(i,s),s},e.parseTransformFrame=function(i,a){var n=new t.TransformFrame;return e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.tweenRotate=Math.floor(e.getNumber(i,t.ConstValues.A_TWEEN_ROTATE,0)||0),n.tweenScale=e.getBoolean(i,t.ConstValues.A_TWEEN_SCALE,!0),e.parseTransform(i[t.ConstValues.TRANSFORM],n.transform,n.pivot),e.tempDragonBonesData.isGlobal&&n.global.copy(n.transform),n.scaleOffset.x=e.getNumber(i,t.ConstValues.A_SCALE_X_OFFSET,0)||0,n.scaleOffset.y=e.getNumber(i,t.ConstValues.A_SCALE_Y_OFFSET,0)||0,n},e.parseTimeline=function(t,e){var i,a=0,n=e.frameList;for(var s in n)i=n[s],i.position=a,a+=i.duration;i&&(i.duration=e.duration-i.position)},e.parseFrame=function(e,i,a){void 0===a&&(a=0),i.duration=Math.round(1e3*(e[t.ConstValues.A_DURATION]||1)/a),i.action=e[t.ConstValues.A_ACTION],i.event=e[t.ConstValues.A_EVENT],i.sound=e[t.ConstValues.A_SOUND]},e.parseTransform=function(i,a,n){void 0===n&&(n=null),i&&(a&&(a.x=e.getNumber(i,t.ConstValues.A_X,0)||0,a.y=e.getNumber(i,t.ConstValues.A_Y,0)||0,a.skewX=e.getNumber(i,t.ConstValues.A_SKEW_X,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.skewY=e.getNumber(i,t.ConstValues.A_SKEW_Y,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.scaleX=e.getNumber(i,t.ConstValues.A_SCALE_X,1)||0,a.scaleY=e.getNumber(i,t.ConstValues.A_SCALE_Y,1)||0),n&&(n.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,n.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0))},e.parseColorTransform=function(i,a){i&&a&&(a.alphaOffset=e.getNumber(i,t.ConstValues.A_ALPHA_OFFSET,0),a.redOffset=e.getNumber(i,t.ConstValues.A_RED_OFFSET,0),a.greenOffset=e.getNumber(i,t.ConstValues.A_GREEN_OFFSET,0),a.blueOffset=e.getNumber(i,t.ConstValues.A_BLUE_OFFSET,0),a.alphaMultiplier=.01*e.getNumber(i,t.ConstValues.A_ALPHA_MULTIPLIER,100),a.redMultiplier=.01*e.getNumber(i,t.ConstValues.A_RED_MULTIPLIER,100),a.greenMultiplier=.01*e.getNumber(i,t.ConstValues.A_GREEN_MULTIPLIER,100),a.blueMultiplier=.01*e.getNumber(i,t.ConstValues.A_BLUE_MULTIPLIER,100))},e.getBoolean=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;case"1":case"true":default:return!0}return i},e.getNumber=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"NaN":case"":case"false":case"null":case"undefined":return 0/0;default:return Number(t[e])}return i},e}();t.Data3Parser=e,egret.registerClass(e,"dragonBones.Data3Parser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=e;return p=i.prototype,e.parseTextureAtlasData=function(i,a){void 0===a&&(a=1);var n,s={},r=i[t.ConstValues.SUB_TEXTURE];for(var o in r){var l=r[o],h=l[t.ConstValues.A_NAME],u=new t.Rectangle;u.x=e.getNumber(l,t.ConstValues.A_X,0)/a,u.y=e.getNumber(l,t.ConstValues.A_Y,0)/a,u.width=e.getNumber(l,t.ConstValues.A_WIDTH,0)/a,u.height=e.getNumber(l,t.ConstValues.A_HEIGHT,0)/a;var _="true"==l[t.ConstValues.A_ROTATED],m=e.getNumber(l,t.ConstValues.A_FRAME_WIDTH,0)/a,f=e.getNumber(l,t.ConstValues.A_FRAME_HEIGHT,0)/a;m>0&&f>0?(n=new t.Rectangle,n.x=e.getNumber(l,t.ConstValues.A_FRAME_X,0)/a,n.y=e.getNumber(l,t.ConstValues.A_FRAME_Y,0)/a,n.width=m,n.height=f):n=null,s[h]=new t.TextureData(u,n,_)}return s},e.parseDragonBonesData=function(i){if(!i)throw new Error;var a=i[t.ConstValues.A_VERSION];if(a=a.toString(),a.toString()!=t.DragonBones.DATA_VERSION&&a.toString()!=t.DragonBones.PARENT_COORDINATE_DATA_VERSION&&"2.3"!=a.toString())throw new Error(egret.getString(4003));if(a.toString()==t.DragonBones.PARENT_COORDINATE_DATA_VERSION||"2.3"==a.toString())return t.Data3Parser.parseDragonBonesData(i);var n=e.getNumber(i,t.ConstValues.A_FRAME_RATE,0)||0,s=new t.DragonBonesData;s.name=i[t.ConstValues.A_NAME],s.isGlobal="0"==i[t.ConstValues.A_IS_GLOBAL]?!1:!0,e.tempDragonBonesData=s;var r=i[t.ConstValues.ARMATURE];for(var o in r){var l=i[t.ConstValues.ARMATURE][o];s.addArmatureData(e.parseArmatureData(l,n))}return e.tempDragonBonesData=null,s},e.parseArmatureData=function(i,a){var n=new t.ArmatureData;n.name=i[t.ConstValues.A_NAME];var s=i[t.ConstValues.BONE];for(var r in s){var o=s[r];n.addBoneData(e.parseBoneData(o))}var l=i[t.ConstValues.SLOT];for(var r in l){var h=l[r];n.addSlotData(e.parseSlotData(h))}var u=i[t.ConstValues.SKIN];for(var r in u){var _=u[r];n.addSkinData(e.parseSkinData(_))}e.tempDragonBonesData.isGlobal&&t.DBDataUtil.transformArmatureData(n),n.sortBoneDataList();var m=i[t.ConstValues.ANIMATION];for(var r in m){var f=m[r],d=e.parseAnimationData(f,a);t.DBDataUtil.addHideTimeline(d,n),t.DBDataUtil.transformAnimationData(d,n,e.tempDragonBonesData.isGlobal),n.addAnimationData(d)}return n},e.parseBoneData=function(i){var a=new t.BoneData;return a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.length=Number(i[t.ConstValues.A_LENGTH])||0,a.inheritRotation=e.getBoolean(i,t.ConstValues.A_INHERIT_ROTATION,!0),a.inheritScale=e.getBoolean(i,t.ConstValues.A_INHERIT_SCALE,!0),e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform),e.tempDragonBonesData.isGlobal&&a.global.copy(a.transform),a},e.parseSkinData=function(i){var a=new t.SkinData;a.name=i[t.ConstValues.A_NAME];var n=i[t.ConstValues.SLOT];for(var s in n){var r=n[s];a.addSlotData(e.parseSlotDisplayData(r))}return a},e.parseSlotData=function(i){var a=new t.SlotData;return a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,a.displayIndex=e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0),a.blendMode=i[t.ConstValues.A_BLENDMODE],a},e.parseSlotDisplayData=function(i){var a=new t.SlotData;a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0;var n=i[t.ConstValues.DISPLAY];for(var s in n){var r=n[s];a.addDisplayData(e.parseDisplayData(r))}return a},e.parseDisplayData=function(i){var a=new t.DisplayData;return a.name=i[t.ConstValues.A_NAME],a.type=i[t.ConstValues.A_TYPE],e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform,a.pivot),a.pivot.x=0/0,a.pivot.y=0/0,null!=e.tempDragonBonesData&&e.tempDragonBonesData.addDisplayData(a),a},e.parseAnimationData=function(i,a){var n=new t.AnimationData;n.name=i[t.ConstValues.A_NAME],n.frameRate=a,n.duration=Math.round(1e3*(e.getNumber(i,t.ConstValues.A_DURATION,1)||1)/a),n.playTimes=e.getNumber(i,t.ConstValues.A_PLAY_TIMES,1),n.playTimes=0/0!=n.playTimes?n.playTimes:1,n.fadeTime=e.getNumber(i,t.ConstValues.A_FADE_IN_TIME,0)||0,n.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,0/0),n.autoTween=e.getBoolean(i,t.ConstValues.A_AUTO_TWEEN,!0);var s=i[t.ConstValues.FRAME],r=0,o=0;if(s)for(r=0,o=s.length;o>r;r++){var l=s[r],h=e.parseTransformFrame(l,a);n.addFrame(h)}e.parseTimeline(i,n);var u=n.duration,_=i[t.ConstValues.BONE];if(_)for(r=0,o=_.length;o>r;r++){var m=_[r];if(m){var f=e.parseTransformTimeline(m,n.duration,a);f.frameList.length>0&&(u=Math.min(u,f.frameList[f.frameList.length-1].duration)),n.addTimeline(f)}}var d=i[t.ConstValues.SLOT];if(d)for(r=0,o=d.length;o>r;r++){var p=d[r];if(p){var c=e.parseSlotTimeline(p,n.duration,a);c.frameList.length>0&&(u=Math.min(u,c.frameList[c.frameList.length-1].duration),n.addSlotTimeline(c))}}return n.frameList.length>0&&(u=Math.min(u,n.frameList[n.frameList.length-1].duration)),n.lastFrameDuration=u,n},e.parseTransformTimeline=function(i,a,n){var s=new t.TransformTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.originPivot.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,s.originPivot.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0,s.duration=a;var r=i[t.ConstValues.FRAME];for(var o in r){var l=r[o],h=e.parseTransformFrame(l,n);s.addFrame(h)}return e.parseTimeline(i,s),s},e.parseSlotTimeline=function(i,a,n){var s=new t.SlotTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.duration=a;var r=i[t.ConstValues.FRAME];for(var o in r){var l=r[o],h=e.parseSlotFrame(l,n);s.addFrame(h)}return e.parseTimeline(i,s),s},e.parseTransformFrame=function(i,a){var n=new t.TransformFrame;return e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.tweenRotate=Math.floor(e.getNumber(i,t.ConstValues.A_TWEEN_ROTATE,0)||0),n.tweenScale=e.getBoolean(i,t.ConstValues.A_TWEEN_SCALE,!0),n.displayIndex=Math.floor(e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0)||0),e.parseTransform(i[t.ConstValues.TRANSFORM],n.transform,n.pivot),e.tempDragonBonesData.isGlobal&&n.global.copy(n.transform),n.scaleOffset.x=e.getNumber(i,t.ConstValues.A_SCALE_X_OFFSET,0)||0,n.scaleOffset.y=e.getNumber(i,t.ConstValues.A_SCALE_Y_OFFSET,0)||0,n},e.parseSlotFrame=function(i,a){var n=new t.SlotFrame;e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.displayIndex=Math.floor(e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0)||0),n.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,e.tempDragonBonesData.isGlobal?0/0:0);var s=i[t.ConstValues.COLOR];return s&&(n.color=new t.ColorTransform,e.parseColorTransform(s,n.color)),n},e.parseTimeline=function(t,e){var i,a=0,n=e.frameList;for(var s in n)i=n[s],i.position=a,a+=i.duration;i&&(i.duration=e.duration-i.position)},e.parseFrame=function(e,i,a){void 0===a&&(a=0),i.duration=Math.round(1e3*(e[t.ConstValues.A_DURATION]||1)/a),i.action=e[t.ConstValues.A_ACTION],i.event=e[t.ConstValues.A_EVENT],i.sound=e[t.ConstValues.A_SOUND];var n=e[t.ConstValues.A_CURVE];null!=n&&4==n.length&&(i.curve=new t.CurveData,i.curve.pointList=[new t.Point(n[0],n[1]),new t.Point(n[2],n[3])])},e.parseTransform=function(i,a,n){void 0===n&&(n=null),i&&(a&&(a.x=e.getNumber(i,t.ConstValues.A_X,0)||0,a.y=e.getNumber(i,t.ConstValues.A_Y,0)||0,a.skewX=e.getNumber(i,t.ConstValues.A_SKEW_X,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.skewY=e.getNumber(i,t.ConstValues.A_SKEW_Y,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.scaleX=e.getNumber(i,t.ConstValues.A_SCALE_X,1)||0,a.scaleY=e.getNumber(i,t.ConstValues.A_SCALE_Y,1)||0),n&&(n.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,n.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0))},e.parseColorTransform=function(i,a){a&&(a.alphaOffset=e.getNumber(i,t.ConstValues.A_ALPHA_OFFSET,0),a.redOffset=e.getNumber(i,t.ConstValues.A_RED_OFFSET,0),a.greenOffset=e.getNumber(i,t.ConstValues.A_GREEN_OFFSET,0),a.blueOffset=e.getNumber(i,t.ConstValues.A_BLUE_OFFSET,0),a.alphaMultiplier=.01*e.getNumber(i,t.ConstValues.A_ALPHA_MULTIPLIER,100),a.redMultiplier=.01*e.getNumber(i,t.ConstValues.A_RED_MULTIPLIER,100),a.greenMultiplier=.01*e.getNumber(i,t.ConstValues.A_GREEN_MULTIPLIER,100),a.blueMultiplier=.01*e.getNumber(i,t.ConstValues.A_BLUE_MULTIPLIER,100))},e.getBoolean=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;case"1":case"true":default:return!0}return i},e.getNumber=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"NaN":case"":case"false":case"null":case"undefined":return 0/0;default:return Number(t[e])}return i},e}();t.DataParser=e,egret.registerClass(e,"dragonBones.DataParser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i){this.region=t,this.frame=e,this.rotated=i}var e=t;return p=e.prototype,t}();t.TextureData=e,egret.registerClass(e,"dragonBones.TextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=e;return p=i.prototype,e.cloneColor=function(e){var i=new t.ColorTransform;return i.redMultiplier=e.redMultiplier,i.greenMultiplier=e.greenMultiplier,i.blueMultiplier=e.blueMultiplier,i.alphaMultiplier=e.alphaMultiplier,i.redOffset=e.redOffset,i.greenOffset=e.greenOffset,i.blueOffset=e.blueOffset,i.alphaOffset=e.alphaOffset,i},e.isEqual=function(t,e){return t.alphaOffset==e.alphaOffset&&t.redOffset==e.redOffset&&t.greenOffset==e.greenOffset&&t.blueOffset==e.blueOffset&&t.alphaMultiplier==e.alphaMultiplier&&t.redMultiplier==e.redMultiplier&&t.greenMultiplier==e.greenMultiplier&&t.blueMultiplier==e.blueMultiplier},e.minus=function(t,e,i){i.alphaOffset=t.alphaOffset-e.alphaOffset,i.redOffset=t.redOffset-e.redOffset,i.greenOffset=t.greenOffset-e.greenOffset,i.blueOffset=t.blueOffset-e.blueOffset,i.alphaMultiplier=t.alphaMultiplier-e.alphaMultiplier,i.redMultiplier=t.redMultiplier-e.redMultiplier,i.greenMultiplier=t.greenMultiplier-e.greenMultiplier,i.blueMultiplier=t.blueMultiplier-e.blueMultiplier},e.originalColor=new t.ColorTransform,e}();t.ColorTransformUtil=e,egret.registerClass(e,"dragonBones.ColorTransformUtil")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=t;return p=e.prototype,t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t.DRAGON_BONES="dragonBones",t.ARMATURE="armature",t.SKIN="skin",t.BONE="bone",t.SLOT="slot",t.DISPLAY="display",t.ANIMATION="animation",t.TIMELINE="timeline",t.FRAME="frame",t.TRANSFORM="transform",t.COLOR_TRANSFORM="colorTransform",t.COLOR="color",t.RECTANGLE="rectangle",t.ELLIPSE="ellipse",t.TEXTURE_ATLAS="TextureAtlas",t.SUB_TEXTURE="SubTexture",t.A_ROTATED="rotated",t.A_FRAME_X="frameX",t.A_FRAME_Y="frameY",t.A_FRAME_WIDTH="frameWidth",t.A_FRAME_HEIGHT="frameHeight",t.A_VERSION="version",t.A_IMAGE_PATH="imagePath",t.A_FRAME_RATE="frameRate",t.A_NAME="name",t.A_IS_GLOBAL="isGlobal",t.A_PARENT="parent",t.A_LENGTH="length",t.A_TYPE="type",t.A_FADE_IN_TIME="fadeInTime",t.A_DURATION="duration",t.A_SCALE="scale",t.A_OFFSET="offset",t.A_LOOP="loop",t.A_PLAY_TIMES="playTimes",t.A_EVENT="event",t.A_EVENT_PARAMETERS="eventParameters",t.A_SOUND="sound",t.A_ACTION="action",t.A_HIDE="hide",t.A_AUTO_TWEEN="autoTween",t.A_TWEEN_EASING="tweenEasing",t.A_TWEEN_ROTATE="tweenRotate",t.A_TWEEN_SCALE="tweenScale",t.A_DISPLAY_INDEX="displayIndex",t.A_Z_ORDER="z",t.A_BLENDMODE="blendMode",t.A_WIDTH="width",t.A_HEIGHT="height",t.A_INHERIT_SCALE="inheritScale",t.A_INHERIT_ROTATION="inheritRotation",t.A_X="x",t.A_Y="y",t.A_SKEW_X="skX",t.A_SKEW_Y="skY",t.A_SCALE_X="scX",t.A_SCALE_Y="scY",t.A_PIVOT_X="pX",t.A_PIVOT_Y="pY",t.A_ALPHA_OFFSET="aO",t.A_RED_OFFSET="rO",t.A_GREEN_OFFSET="gO",t.A_BLUE_OFFSET="bO",t.A_ALPHA_MULTIPLIER="aM",t.A_RED_MULTIPLIER="rM",t.A_GREEN_MULTIPLIER="gM",t.A_BLUE_MULTIPLIER="bM",t.A_CURVE="curve",t.A_SCALE_X_OFFSET="scXOffset",t.A_SCALE_Y_OFFSET="scYOffset",t.A_SCALE_MODE="scaleMode",t.A_FIXED_ROTATION="fixedRotation",t}();t.ConstValues=e,egret.registerClass(e,"dragonBones.ConstValues")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=e;return p=i.prototype,e.transformArmatureData=function(e){for(var i=e.boneDataList,a=i.length;a--;){var n=i[a];if(n.parent){var s=e.getBoneData(n.parent);s&&(n.transform.copy(n.global),t.TransformUtil.globalToLocal(n.transform,s.global))}}},e.transformArmatureDataAnimations=function(t){for(var i=t.animationDataList,a=i.length;a--;)e.transformAnimationData(i[a],t,!1)},e.transformRelativeAnimationData=function(){},e.transformAnimationData=function(i,a,n){if(!n)return void e.transformRelativeAnimationData(i,a);var s,r=a.getSkinData(null),o=a.boneDataList;r&&(s=r.slotDataList);for(var l=0;l<o.length;l++){var h=o[l],u=i.getTimeline(h.name),_=i.getSlotTimeline(h.name);if(u||_){var m=null;if(s)for(var f=0,d=s.length;d>f&&(m=s[f],m.parent!=h.name);f++);var p=u.frameList;if(_)var c=_.frameList;for(var g=null,T=p.length,f=0;T>f;f++){var v=p[f];if(e.setFrameTransform(i,a,h,v),v.transform.x-=h.transform.x,v.transform.y-=h.transform.y,v.transform.skewX-=h.transform.skewX,v.transform.skewY-=h.transform.skewY,v.transform.scaleX/=h.transform.scaleX,v.transform.scaleY/=h.transform.scaleY,g){var D=v.transform.skewX-g.transform.skewX;g.tweenRotate?g.tweenRotate>0?(0>D&&(v.transform.skewX+=2*Math.PI,v.transform.skewY+=2*Math.PI),g.tweenRotate>1&&(v.transform.skewX+=2*Math.PI*(g.tweenRotate-1),v.transform.skewY+=2*Math.PI*(g.tweenRotate-1))):(D>0&&(v.transform.skewX-=2*Math.PI,v.transform.skewY-=2*Math.PI),g.tweenRotate<1&&(v.transform.skewX+=2*Math.PI*(g.tweenRotate+1),v.transform.skewY+=2*Math.PI*(g.tweenRotate+1))):(v.transform.skewX=g.transform.skewX+t.TransformUtil.formatRadian(v.transform.skewX-g.transform.skewX),v.transform.skewY=g.transform.skewY+t.TransformUtil.formatRadian(v.transform.skewY-g.transform.skewY))}g=v}if(_&&c){T=c.length;for(var f=0;T>f;f++){var A=c[f];_.transformed||m&&(A.zOrder-=m.zOrder)}_.transformed=!0}u.transformed=!0}}},e.setFrameTransform=function(i,a,n,s){s.transform.copy(s.global);var r=a.getBoneData(n.parent);if(r){var o=i.getTimeline(r.name);if(o){for(var l=[],h=[];o;)l.push(o),h.push(r),r=a.getBoneData(r.parent),o=r?i.getTimeline(r.name):null;for(var u,_=l.length,m=new t.Matrix,f=new t.DBTransform,d=new t.Matrix;_--;)o=l[_],r=h[_],e.getTimelineTransform(o,s.position,f,!u),u?(f.x+=o.originTransform.x+r.transform.x,f.y+=o.originTransform.y+r.transform.y,f.skewX+=o.originTransform.skewX+r.transform.skewX,f.skewY+=o.originTransform.skewY+r.transform.skewY,f.scaleX*=o.originTransform.scaleX*r.transform.scaleX,f.scaleY*=o.originTransform.scaleY*r.transform.scaleY,t.TransformUtil.transformToMatrix(f,d,!0),d.concat(m),t.TransformUtil.matrixToTransform(d,u,f.scaleX*u.scaleX>=0,f.scaleY*u.scaleY>=0)):(u=new t.DBTransform,u.copy(f)),t.TransformUtil.transformToMatrix(u,m,!0);t.TransformUtil.globalToLocal(s.transform,u)}}},e.getTimelineTransform=function(e,i,a,n){for(var s=e.frameList,r=s.length;r--;){var o=s[r];if(o.position<=i&&o.position+o.duration>i){if(r==s.length-1||i==o.position)a.copy(n?o.global:o.transform);else{var l=o.tweenEasing,h=(i-o.position)/o.duration;l&&10!=l&&(h=t.MathUtil.getEaseValue(h,l));var u=s[r+1],_=n?o.global:o.transform,m=n?u.global:u.transform;a.x=_.x+(m.x-_.x)*h,a.y=_.y+(m.y-_.y)*h,a.skewX=t.TransformUtil.formatRadian(_.skewX+(m.skewX-_.skewX)*h),a.skewY=t.TransformUtil.formatRadian(_.skewY+(m.skewY-_.skewY)*h),a.scaleX=_.scaleX+(m.scaleX-_.scaleX)*h,a.scaleY=_.scaleY+(m.scaleY-_.scaleY)*h}break}}},e.addHideTimeline=function(t,e){for(var i=e.boneDataList,a=i.length;a--;){var n=i[a],s=n.name;t.getTimeline(s)||t.hideTimelineNameMap.indexOf(s)<0&&t.hideTimelineNameMap.push(s)}},e}();t.DBDataUtil=e,egret.registerClass(e,"dragonBones.DBDataUtil")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=t;return p=e.prototype,t.getEaseValue=function(e,i){var a=1;return i>1?(a=.5*(1-t.cos(e*Math.PI)),i-=1):i>0?a=1-Math.pow(1-e,2):0>i&&(i*=-1,a=Math.pow(e,2)),(a-e)*i+e},t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){e*=t.RADIAN_TO_ANGLE;var i=Math.floor(e),a=i+1,n=t.sinInt(i),s=t.sinInt(a);return(e-i)*s+(a-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),90>t?db_sin_map[t]:180>t?db_sin_map[180-t]:270>t?-db_sin_map[t-180]:-db_sin_map[360-t]},t.cos=function(e){return t.sin(Math.PI/2-e)},t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t}();t.MathUtil=e,egret.registerClass(e,"dragonBones.MathUtil")}(dragonBones||(dragonBones={}));for(var db_sin_map={},dbMathIndex=0;90>=dbMathIndex;dbMathIndex++)db_sin_map[dbMathIndex]=Math.sin(dbMathIndex*dragonBones.MathUtil.ANGLE_TO_RADIAN);var dragonBones;!function(t){var e=function(){function e(){}var i=e;return p=i.prototype,e.globalToLocal=function(t,i){e.transformToMatrix(t,e._helpTransformMatrix,!0),e.transformToMatrix(i,e._helpParentTransformMatrix,!0),e._helpParentTransformMatrix.invert(),e._helpTransformMatrix.concat(e._helpParentTransformMatrix),e.matrixToTransform(e._helpTransformMatrix,t,t.scaleX*i.scaleX>=0,t.scaleY*i.scaleY>=0)},e.transformToMatrix=function(e,i,a){void 0===a&&(a=!1),a?(i.a=e.scaleX*t.MathUtil.cos(e.skewY),i.b=e.scaleX*t.MathUtil.sin(e.skewY),i.c=-e.scaleY*t.MathUtil.sin(e.skewX),i.d=e.scaleY*t.MathUtil.cos(e.skewX),i.tx=e.x,i.ty=e.y):(i.a=t.MathUtil.cos(e.skewY),i.b=t.MathUtil.sin(e.skewY),i.c=-t.MathUtil.sin(e.skewX),i.d=t.MathUtil.cos(e.skewX),i.tx=e.x,i.ty=e.y)},e.matrixToTransform=function(t,e,i,a){e.x=t.tx,e.y=t.ty,e.scaleX=Math.sqrt(t.a*t.a+t.b*t.b)*(i?1:-1),e.scaleY=Math.sqrt(t.d*t.d+t.c*t.c)*(a?1:-1);var n=[];n[0]=Math.acos(t.d/e.scaleY),n[1]=-n[0],n[2]=Math.asin(-t.c/e.scaleY),n[3]=n[2]>=0?Math.PI-n[2]:n[2]-Math.PI,e.skewX=Number(n[0]).toFixed(4)==Number(n[2]).toFixed(4)||Number(n[0]).toFixed(4)==Number(n[3]).toFixed(4)?n[0]:n[1];var s=[];s[0]=Math.acos(t.a/e.scaleX),s[1]=-s[0],s[2]=Math.asin(t.b/e.scaleX),s[3]=s[2]>=0?Math.PI-s[2]:s[2]-Math.PI,e.skewY=Number(s[0]).toFixed(4)==Number(s[2]).toFixed(4)||Number(s[0]).toFixed(4)==Number(s[3]).toFixed(4)?s[0]:s[1]},e.formatRadian=function(t){return t>Math.PI&&(t-=e.DOUBLE_PI),t<-Math.PI&&(t+=e.DOUBLE_PI),t},e.normalizeRotation=function(t){return t=(t+Math.PI)%(2*Math.PI),t=t>0?t:2*Math.PI+t,t-Math.PI},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._helpTransformMatrix=new t.Matrix,e._helpParentTransformMatrix=new t.Matrix,e}();t.TransformUtil=e,egret.registerClass(e,"dragonBones.TransformUtil")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this,this)}__extends(i,e);var a=i;return p=a.prototype,p._generateArmature=function(){var e=new t.Armature(new egret.DisplayObjectContainer);return e},p._generateSlot=function(){var e=new t.EgretSlot;return e},p._generateDisplay=function(t,e,i,a){var n=new egret.Bitmap;if(n.texture=t.getTexture(e),isNaN(i)||isNaN(a)){var s=t.getFrame(e);null!=s?(i=s.width/2+s.x,a=s.height/2+s.y):(i=n.width/2,a=n.height/2)}else null!=s&&(i+=s.x,a+=s.y);return n.anchorOffsetX=i,n.anchorOffsetY=a,n},p._generateFastArmature=function(){var e=new t.FastArmature(new egret.DisplayObjectContainer);return e},p._generateFastSlot=function(){var e=new t.EgretFastSlot;return e},i}(t.BaseFactory);t.EgretFactory=e,egret.registerClass(e,"dragonBones.EgretFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this,this),this._egretDisplay=null}__extends(i,e);var a=i;return p=a.prototype,p.dispose=function(){if(this._displayList)for(var i=this._displayList.length,a=0;i>a;a++){var n=this._displayList[a];n instanceof t.FastArmature&&n.dispose()}e.prototype.dispose.call(this),this._egretDisplay=null},p._updateDisplay=function(t){this._egretDisplay=t},p._getDisplayIndex=function(){return this._egretDisplay&&this._egretDisplay.parent?this._egretDisplay.parent.getChildIndex(this._egretDisplay):-1},p._addDisplayToContainer=function(t,e){void 0===e&&(e=-1);var i=t;this._egretDisplay&&i&&(0>e?i.addChild(this._egretDisplay):i.addChildAt(this._egretDisplay,Math.min(e,i.numChildren)))},p._removeDisplayFromContainer=function(){this._egretDisplay&&this._egretDisplay.parent&&this._egretDisplay.parent.removeChild(this._egretDisplay)},p._updateTransform=function(){this._egretDisplay&&this._egretDisplay.$setMatrix(egret.$TempMatrix.copyFrom(this._globalTransformMatrix),!1)},p._updateDisplayVisible=function(){},p._updateDisplayColor=function(t,i,a,n,s,r,o,l,h){void 0===h&&(h=!1),e.prototype._updateDisplayColor.call(this,t,i,a,n,s,r,o,l,h),this._egretDisplay&&(this._egretDisplay.alpha=s)},p._updateDisplayBlendMode=function(t){this._egretDisplay&&t&&(this._egretDisplay.blendMode=t)},i}(t.FastSlot);t.EgretFastSlot=e,egret.registerClass(e,"dragonBones.EgretFastSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e,i,a){void 0===a&&(a=1),this.texture=e,this.textureData=i,this._textureDatas={},this.scale=a,this.name=i[t.ConstValues.A_NAME],this.spriteSheet=new egret.SpriteSheet(e),this._textureDatas=i.frames}var i=e;return p=i.prototype,p.getTexture=function(t){var e=this.spriteSheet.getTexture(t);if(!e){var i=this._textureDatas[t];e=this.spriteSheet.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH)}return e},p.dispose=function(){this.texture=null},p.getRegion=function(t){var i=this._textureDatas[t];return i?e.Region:null},e.Region=new egret.Rectangle,e}();t.EgretSheetAtlas=e,egret.registerClass(e,"dragonBones.EgretSheetAtlas",["dragonBones.ITextureAtlas"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this,this),this._egretDisplay=null}__extends(i,e);var a=i;return p=a.prototype,p.dispose=function(){if(this._displayList)for(var i=this._displayList.length,a=0;i>a;a++){var n=this._displayList[a];n instanceof t.Armature&&n.dispose()}e.prototype.dispose.call(this),this._egretDisplay=null},p._updateDisplay=function(t){this._egretDisplay=t},p._getDisplayIndex=function(){return this._egretDisplay&&this._egretDisplay.parent?this._egretDisplay.parent.getChildIndex(this._egretDisplay):-1},p._addDisplayToContainer=function(t,e){void 0===e&&(e=-1);var i=t;this._egretDisplay&&i&&(0>e?i.addChild(this._egretDisplay):i.addChildAt(this._egretDisplay,Math.min(e,i.numChildren)))},p._removeDisplayFromContainer=function(){this._egretDisplay&&this._egretDisplay.parent&&this._egretDisplay.parent.removeChild(this._egretDisplay)},p._updateTransform=function(){this._egretDisplay&&this._egretDisplay.$setMatrix(egret.$TempMatrix.copyFrom(this._globalTransformMatrix),!1)},p._updateDisplayVisible=function(t){this._egretDisplay&&this._parent&&(this._egretDisplay.visible=this._parent._visible&&this._visible&&t)},p._updateDisplayColor=function(t,i,a,n,s,r,o,l){e.prototype._updateDisplayColor.call(this,t,i,a,n,s,r,o,l),this._egretDisplay&&(this._egretDisplay.alpha=s)},p._updateDisplayBlendMode=function(t){this._egretDisplay&&t&&(this._egretDisplay.blendMode=t)},p._calculateRelativeParentTransform=function(){this._global.scaleX=this._origin.scaleX*this._offset.scaleX,this._global.scaleY=this._origin.scaleY*this._offset.scaleY,this._global.skewX=this._origin.skewX+this._offset.skewX,this._global.skewY=this._origin.skewY+this._offset.skewY,this._global.x=this._origin.x+this._offset.x+this._parent._tweenPivot.x,this._global.y=this._origin.y+this._offset.y+this._parent._tweenPivot.y,this._displayDataList&&this._currentDisplayIndex>=0&&this._displayDataList[this._currentDisplayIndex]&&1==t.EgretTextureAtlas.rotatedDic[this._displayDataList[this._currentDisplayIndex].name]&&(this._global.skewX-=1.57,this._global.skewY-=1.57)},i}(t.Slot);t.EgretSlot=e,egret.registerClass(e,"dragonBones.EgretSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e,i,a){void 0===a&&(a=1),this.texture=e,this.textureAtlasRawData=i,this._textureDatas={},this.scale=a,this.name=i[t.ConstValues.A_NAME],this.parseData(i),this.spriteSheet=new egret.SpriteSheet(e)
}var i=e;return p=i.prototype,p.getTexture=function(t){var i=this.spriteSheet.getTexture(t);if(!i){var a=this._textureDatas[t];a&&(i=this.spriteSheet.createTexture(t,a.region.x,a.region.y,a.region.width,a.region.height),a.rotated&&(e.rotatedDic[t]=1))}return i},p.dispose=function(){this.texture=null},p.getRegion=function(e){var i=this._textureDatas[e];return i&&i instanceof t.TextureData?i.region:null},p.getFrame=function(e){var i=this._textureDatas[e];return i&&i instanceof t.TextureData?i.frame:null},p.parseData=function(e){this._textureDatas=t.DataParser.parseTextureAtlasData(e,this.scale)},e.rotatedDic={},e}();t.EgretTextureAtlas=e,egret.registerClass(e,"dragonBones.EgretTextureAtlas",["dragonBones.ITextureAtlas"])}(dragonBones||(dragonBones={}));