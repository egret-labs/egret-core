var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(i,s){void 0===i&&(i=""),void 0===s&&(s=0),e.call(this),this._writeMessage="",this._readMessage="",this._connected=!1,this._connecting=!1,this._isReadySend=!1,this._bytesWrite=!1,this._type=n.TYPE_STRING,this._connected=!1,this._writeMessage="",this._readMessage="",this.socket=new t.ISocket,this.socket.addCallBacks(this.onConnect,this.onClose,this.onSocketData,this.onError,this)}__extends(n,e);var i=__define,s=n,o=s.prototype;return o.connect=function(t,e){this._connecting||this._connected||(this._connecting=!0,this.socket.connect(t,e))},o.connectByUrl=function(t){this._connecting||this._connected||(this._connecting=!0,this.socket.connectByUrl(t))},o.close=function(){this._connected&&this.socket.close()},o.onConnect=function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(t.Event.CONNECT)},o.onClose=function(){this._connected=!1,this.dispatchEventWith(t.Event.CLOSE)},o.onError=function(){this._connecting&&(this._connecting=!1),this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},o.onSocketData=function(e){"string"==typeof e?this._readMessage+=e:this._readByte._writeUint8Array(new Uint8Array(e)),t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.SOCKET_DATA)},o.flush=function(){return this._connected?(this._writeMessage&&(this.socket.send(this._writeMessage),this._writeMessage=""),this._bytesWrite&&(this.socket.send(this._writeByte.buffer),this._bytesWrite=!1,this._writeByte.clear()),void(this._isReadySend=!1)):void t.$warn(3101)},o.writeUTF=function(e){return this._connected?(this._type==n.TYPE_BINARY?(this._bytesWrite=!0,this._writeByte.writeUTF(e)):this._writeMessage+=e,void this.flush()):void t.$warn(3101)},o.readUTF=function(){var t;return this._type==n.TYPE_BINARY?(this._readByte.position=0,t=this._readByte.readUTF(),this._readByte.clear()):(t=this._readMessage,this._readMessage=""),t},o.writeBytes=function(e,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),this._connected?this._writeByte?(this._bytesWrite=!0,this._writeByte.writeBytes(e,n,i),void this.flush()):void t.$warn(3102):void t.$warn(3101)},o.readBytes=function(e,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),this._readByte?(this._readByte.position=0,this._readByte.readBytes(e,n,i),void this._readByte.clear()):void t.$warn(3102)},i(o,"connected",function(){return this._connected}),i(o,"type",function(){return this._type},function(e){this._type=e,e!=n.TYPE_BINARY||this._writeByte||(this._readByte=new t.ByteArray,this._writeByte=new t.ByteArray)}),n.TYPE_STRING="webSocketTypeString",n.TYPE_BINARY="webSocketTypeBinary",n}(t.EventDispatcher);t.WebSocket=e,t.registerClass(e,"egret.WebSocket")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var n=function(){function t(){this.host="",this.port=0}var e=(__define,t),n=e.prototype;return n.addCallBacks=function(t,e,n,i,s){this.onConnect=t,this.onClose=e,this.onSocketData=n,this.onError=i,this.thisObject=s},n.connect=function(t,e){this.host=t,this.port=e;var n="ws://"+this.host+":"+this.port;this.socket=new __global.egret_native.WebSocket(n),this._bindEvent()},n.connectByUrl=function(t){this.socket=new __global.egret_native.WebSocket(t),this._bindEvent()},n._bindEvent=function(){var t=this,e=this.socket;e.onOpen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onClose=function(){t.onClose&&t.onClose.call(t.thisObject)},e.onError=function(e){t.onError&&t.onError.call(t.thisObject)},e.onMessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e)}},n.send=function(t){this.socket.send(t)},n.close=function(){this.socket.close()},t}();e.NativeSocket=n,t.registerClass(n,"egret.native.NativeSocket",["egret.ISocket"]),t.Capabilities.runtimeType==t.RuntimeType.NATIVE&&(t.ISocket=n)}(e=t["native"]||(t["native"]={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var n=function(){function e(){this.host="",this.port=0,window.WebSocket||t.$error(3100)}var n=(__define,e),i=n.prototype;return i.addCallBacks=function(t,e,n,i,s){this.onConnect=t,this.onClose=e,this.onSocketData=n,this.onError=i,this.thisObject=s},i.connect=function(t,e){this.host=t,this.port=e;var n="ws://"+this.host+":"+this.port;this.socket=new window.WebSocket(n),this.socket.binaryType="arraybuffer",this._bindEvent()},i.connectByUrl=function(t){this.socket=new window.WebSocket(t),this.socket.binaryType="arraybuffer",this._bindEvent()},i._bindEvent=function(){var t=this,e=this.socket;e.onopen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onclose=function(e){t.onClose&&t.onClose.call(t.thisObject)},e.onerror=function(e){t.onError&&t.onError.call(t.thisObject)},e.onmessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e.data)}},i.send=function(t){this.socket.send(t)},i.close=function(){this.socket.close()},e}();e.HTML5WebSocket=n,t.registerClass(n,"egret.web.HTML5WebSocket",["egret.ISocket"]),t.Capabilities.runtimeType==t.RuntimeType.WEB&&(t.ISocket=n)}(e=t.web||(t.web={}))}(egret||(egret={}));