var __extends=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__define=this.__define||function(e,t,n,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n,set:r})},egret;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.urlData={}}__extends(n,t);var r=n;return p=r.prototype,p.proceed=function(t){function r(){var n=new e.PromiseObject;n.onSuccessFunc=function(n){t.data=n,e.Event.dispatchEvent(t,e.Event.COMPLETE)},egret_native.readFileAsync(c,n)}function a(){var n=e.PromiseObject.create();n.onSuccessFunc=i,n.onErrorFunc=function(){e.Event.dispatchEvent(t,e.IOErrorEvent.IO_ERROR)},egret_native.download(c,c,n)}function i(){var n=egret_native.readFileSync(c);t.data=n,e.Event.dispatchEvent(t,e.Event.COMPLETE)}var o=this;if(t.dataFormat==e.URLLoaderDataFormat.TEXTURE)return void o.loadTexture(t);if(t.dataFormat==e.URLLoaderDataFormat.SOUND)return void o.loadSound(t);var s=t._request,c=o.getVirtualUrl(e.$getUrl(s));if(o.isNetUrl(c)){if(o.urlData.type=s.method,s.method==e.URLRequestMethod.POST&&s.data){var u=s.data;o.urlData.data=u.toString()}else delete o.urlData.data;s.requestHeaders?o.urlData.header=o.getHeaderString(s):delete o.urlData.header;var v=e.PromiseObject.create();v.onSuccessFunc=function(n){t.data=n,e.callLater(e.Event.dispatchEvent,e.Event,t,e.Event.COMPLETE)},v.onErrorFunc=function(n){e.$warn(1019,n),e.IOErrorEvent.dispatchIOErrorEvent(t)},egret_native.requireHttp(c,o.urlData,v)}else egret_native.isFileExists(c)?n.__use_asyn?r():e.$callAsync(i,o):a()},p.getHeaderString=function(e){for(var t={},n=e.requestHeaders.length,r=0;n>r;r++){var a=e.requestHeaders[r];t[a.name]=a.value}return JSON.stringify(t)},p.loadSound=function(t){function n(){var n=e.PromiseObject.create();n.onSuccessFunc=r,n.onErrorFunc=function(){e.IOErrorEvent.dispatchIOErrorEvent(t)},egret_native.download(o,o,n)}function r(){e.Event.dispatchEvent(t,e.Event.COMPLETE)}var a=this,i=t._request,o=a.getVirtualUrl(i.url);a.isNetUrl(o)?n():egret_native.isFileExists(o)?e.$callAsync(r,a):n()},p.loadTexture=function(t){function n(e){t.dispatchEvent(e)}function r(e){i(),t.dispatchEvent(e)}function a(){i();var n=u.data,r=new e.Texture;r._setBitmapData(n),t.data=r,e.$callAsync(function(){t.dispatchEventWith(e.Event.COMPLETE)},o)}function i(){u.removeEventListener(e.Event.COMPLETE,a,o),u.removeEventListener(e.IOErrorEvent.IO_ERROR,r,o),u.removeEventListener(e.ProgressEvent.PROGRESS,n,o)}var o=this,s=t._request,c=o.getVirtualUrl(s.url),u=new e.ImageLoader;u.addEventListener(e.Event.COMPLETE,a,o),u.addEventListener(e.IOErrorEvent.IO_ERROR,r,o),u.addEventListener(e.ProgressEvent.PROGRESS,n,o),u.load(c)},p.isNetUrl=function(e){return-1!=e.indexOf("http://")},p.getVirtualUrl=function(e){return e},n.getNetContext=function(){return null==n._instance&&(n._instance=new n),n._instance},n.__use_asyn=null==egret_native.readFileAsync?!1:!0,n}(e.HashObject);t.NativeNetContext=n,e.registerClass(n,"egret.native.NativeNetContext",["egret.NetContext"]),e.NetContext=n}(t=e["native"]||(e["native"]={}))}(egret||(egret={}));