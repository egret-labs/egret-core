var dragonBones;!function(e){var t=function(){function e(){this.hashCode=e._hashCode++}var t=(__define,e),a=t.prototype;return e._returnObject=function(t){var a=t.constructor,n=String(a),r=null==e._maxCountMap[n]?e._defaultMaxCount:e._maxCountMap[n],i=e._poolsMap[n]=e._poolsMap[n]||[];if(i.length<r){if(!(i.indexOf(t)<0))throw new Error;i.push(t)}},e.toString=function(){throw new Error},e.setMaxCount=function(t,a){if((0>a||a!=a)&&(a=0),t){var n=String(t);e._maxCountMap[n]=a;var r=e._poolsMap[n];r&&r.length>a&&(r.length=a)}else{e._defaultMaxCount=a;for(var n in e._poolsMap)if(null!=e._maxCountMap[n]){var r=e._poolsMap[n];r.length>a&&(r.length=a)}}},e.clearPool=function(t){if(void 0===t&&(t=null),t){var a=e._poolsMap[String(t)];a&&a.length&&(a.length=0)}else for(var n in e._poolsMap){var a=e._poolsMap[n];a.length=0}},e.borrowObject=function(t){var a=e._poolsMap[String(t)];if(a&&a.length)return a.pop();var n=new t;return n._onClear(),n},a.returnToPool=function(){this._onClear(),e._returnObject(this)},e._hashCode=0,e._defaultMaxCount=5e3,e._maxCountMap={},e._poolsMap={},e}();e.BaseObject=t,egret.registerClass(t,"dragonBones.BaseObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),this._animations={},this._animationNames=[],this._animationStates=[]}__extends(a,t);var n=__define,r=a,i=r.prototype;return a._sortAnimationState=function(e,t){return e.layer>t.layer?1:-1},a.toString=function(){return"[Class dragonBones.Animation]"},i._onClear=function(){var e=this;e.timeScale=1,e._animationStateDirty=!1,e._timelineStateDirty=!1,e._armature=null,e._isPlaying=!1,e._time=0,e._lastAnimationState=null;for(var t in e._animations)delete e._animations[t];e._animationNames.length&&(e._animationNames.length=0);for(var t=0,a=e._animationStates.length;a>t;++t)e._animationStates[t].returnToPool();e._animationStates.length=0},i._fadeOut=function(e,t,a,n,r){var i=this,o=0,s=i._animationStates.length,l=null;switch(n){case 0:break;case 1:for(;s>o;++o)l=i._animationStates[o],l.layer==t&&l.fadeOut(e,r);break;case 2:for(;s>o;++o)l=i._animationStates[o],l.group==a&&l.fadeOut(e,r);break;case 4:for(;s>o;++o)l=i._animationStates[o],l.fadeOut(e,r);break;case 3:for(;s>o;++o)l=i._animationStates[o],l.layer==t&&l.group==a&&l.fadeOut(e,r)}},i._updateFFDTimelineStates=function(){for(var e=this,t=0,a=e._animationStates.length;a>t;++t)e._animationStates[t]._updateFFDTimelineStates()},i._advanceTime=function(e){var t=this;if(t._isPlaying){0>e&&(e=-e);var a=t._animationStates.length;if(1==a){var n=t._animationStates[0];n._isFadeOutComplete?(n.returnToPool(),t._animationStates.length=0,t._animationStateDirty=!0,t._lastAnimationState=null):(t._timelineStateDirty&&n._updateTimelineStates(),n._advanceTime(e,1,0))}else if(a>1)for(var r=t._animationStates[0]._layer,i=1,o=0,s=1,l=0,_=0;a>l;++l){var n=t._animationStates[l];n._isFadeOutComplete?(_++,n.returnToPool(),t._lastAnimationState==n&&(l-_>=0?t._lastAnimationState=t._animationStates[l-_]:t._lastAnimationState=null)):(_>0&&(t._animationStates[l-_]=n),r!=n._layer&&(r=n._layer,o>=i?i=0:i-=o,o=0),t._timelineStateDirty&&n._updateTimelineStates(),n._advanceTime(e,i,s),0!=n._weightResult&&(o+=n._weightResult,s++)),l==a-1&&_>0&&(t._animationStates.length-=_)}t._timelineStateDirty=!1}},i.reset=function(){var e=this;e._isPlaying=!1,e._lastAnimationState=null;for(var t=0,a=e._animationStates.length;a>t;++t)e._animationStates[t].returnToPool();e._animationStates.length=0},i.stop=function(e){if(void 0===e&&(e=null),e){var t=this.getState(e);t&&t.stop()}else this._isPlaying=!1},i.play=function(e,t){void 0===e&&(e=null),void 0===t&&(t=-1);var a=this,n=null;if(e)n=a.fadeIn(e,0,t,0,null,4);else if(a._lastAnimationState)a._isPlaying?n=a.fadeIn(a._lastAnimationState.name,0,t,0,null,4):a._isPlaying=!0;else{var r=a._armature.armatureData.defaultAnimation;r&&(n=a.fadeIn(r.name,0,t,0,null,4))}return n},i.fadeIn=function(t,n,r,i,o,s,l,_,u,f){void 0===n&&(n=-1),void 0===r&&(r=-1),void 0===i&&(i=0),void 0===o&&(o=null),void 0===s&&(s=3),void 0===l&&(l=!1),void 0===_&&(_=!0),void 0===u&&(u=!0),void 0===f&&(f=!0);var m=this,h=m._animations[t];if(!h)return m._time=0,console.warn("No animation."," Armature: "+m._armature.name," Animation: "+t),null;m._isPlaying=!0,(n!=n||0>n)&&(n=m._lastAnimationState?h.fadeInTime:0),0>r&&(r=h.playTimes),m._fadeOut(n,i,o,s,u),m._lastAnimationState=e.BaseObject.borrowObject(e.AnimationState),m._lastAnimationState._layer=i,m._lastAnimationState._group=o,m._lastAnimationState.additiveBlending=l,m._lastAnimationState.displayControl=_,m._lastAnimationState._fadeIn(m._armature,h.animation||h,t,r,h.position,h.duration,m._time,1/h.scale,n,f),m._animationStates.push(m._lastAnimationState),m._animationStateDirty=!0,m._time=0,m._animationStates.length>1&&m._animationStates.sort(a._sortAnimationState);for(var c=m._armature.getSlots(),d=0,g=c.length;g>d;++d){var p=c[d];if(p.inheritAnimation){var v=p.childArmature;v&&v.animation.hasAnimation(t)&&!v.animation.getState(t)&&v.animation.fadeIn(t)}}return m._armature.advanceTime(0),m._lastAnimationState},i.gotoAndPlayByTime=function(e,t,a){return void 0===t&&(t=0),void 0===a&&(a=-1),this._time=t,this.fadeIn(e,0,a,0,null,4)},i.gotoAndPlayByFrame=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=-1);var n=this._animations[e];return n&&(this._time=n.duration*t/n.frameCount),this.fadeIn(e,0,a,0,null,4)},i.gotoAndPlayByProgress=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=-1);var n=this._animations[e];return n&&(this._time=n.duration*Math.max(t,0)),this.fadeIn(e,0,a,0,null,4)},i.gotoAndStopByTime=function(e,t){void 0===t&&(t=0);var a=this.gotoAndPlayByTime(e,t,1);return a&&(this._isPlaying=!1,a.stop()),a},i.gotoAndStopByFrame=function(e,t){void 0===t&&(t=0);var a=this.gotoAndPlayByFrame(e,t,1);return a&&(this._isPlaying=!1,a.stop()),a},i.gotoAndStopByProgress=function(e,t){void 0===t&&(t=0);var a=this.gotoAndPlayByProgress(e,t,1);return a&&(this._isPlaying=!1,a.stop()),a},i.getState=function(e){for(var t=0,a=this._animationStates.length;a>t;++t){var n=this._animationStates[t];if(n.name==e)return n}return null},i.hasAnimation=function(e){return null!=this._animations[e]},n(i,"isPlaying",function(){return this._isPlaying}),n(i,"isCompleted",function(){var e=this;if(e._lastAnimationState){if(!e._lastAnimationState.isCompleted)return!1;for(var t=0,a=e._animationStates.length;a>t;++t)if(!e._animationStates[t].isCompleted)return!1}return!0}),n(i,"lastAnimationName",function(){return this._lastAnimationState?this._lastAnimationState.name:null}),n(i,"lastAnimationState",function(){return this._lastAnimationState}),n(i,"animationNames",function(){return this._animationNames}),n(i,"animations",function(){return this._animations},function(e){var t=this;if(t._animations!=e){for(var a in t._animations)delete t._animations[a];if(t._animationNames.length=0,e)for(var a in e)t._animations[a]=e[a],t._animationNames.push(a)}}),i.gotoAndPlay=function(e,t,a,n,r,i,o,s,l){void 0===t&&(t=-1),void 0===a&&(a=-1),void 0===n&&(n=-1),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=3),void 0===s&&(s=!0),void 0===l&&(l=!0);var _=this.fadeIn(e,t,n,r,i,o,!1,!0,s,l);return _&&a&&a>0&&(_.timeScale=_.totalTime/a),_},i.gotoAndStop=function(e,t){return void 0===t&&(t=0),this.gotoAndStopByTime(e,t)},n(i,"animationList",function(){return this._animationNames}),n(i,"animationDataList",function(){for(var e=[],t=0,a=this._animationNames.length;a>t;++t)e.push(this._animations[this._animationNames[t]]);return e}),a}(e.BaseObject);e.Animation=t,egret.registerClass(t,"dragonBones.Animation")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),this._boneMask=[],this._boneTimelines=[],this._slotTimelines=[],this._ffdTimelines=[],this.autoTween=!1}__extends(a,t);var n=__define,r=a,i=r.prototype;return a.toString=function(){return"[Class dragonBones.AnimationState]"},i._onClear=function(){var e=this;e.displayControl=!0,e.additiveBlending=!1,e.playTimes=1,e.timeScale=1,e.weight=1,e.autoFadeOutTime=-1,e.fadeTotalTime=0,e._isFadeOutComplete=!1,e._layer=0,e._position=0,e._duration=0,e._weightResult=0,e._fadeProgress=0,e._group=null,e._timeline&&(e._timeline.returnToPool(),e._timeline=null),e._isPlaying=!0,e._isPausePlayhead=!1,e._isFadeOut=!1,e._currentPlayTimes=0,e._fadeTime=0,e._time=0,e._name=null,e._armature=null,e._animationData=null,e._boneMask.length&&(e._boneMask.length=0);for(var t=0,a=e._boneTimelines.length;a>t;++t)e._boneTimelines[t].returnToPool();for(var t=0,a=e._slotTimelines.length;a>t;++t)e._slotTimelines[t].returnToPool();for(var t=0,a=e._ffdTimelines.length;a>t;++t)e._ffdTimelines[t].returnToPool();e._boneTimelines.length=0,e._slotTimelines.length=0,e._ffdTimelines.length=0},i._advanceFadeTime=function(t){var a=this;0>t&&(t=-t),a._fadeTime+=t;var n=0;if(n=a._fadeTime>=a.fadeTotalTime?a._isFadeOut?0:1:a._fadeTime>0?a._isFadeOut?1-a._fadeTime/a.fadeTotalTime:a._fadeTime/a.fadeTotalTime:a._isFadeOut?1:0,a._fadeProgress!=n){a._fadeProgress=n;var r=a._armature._display;if(a._fadeTime<=t)if(a._isFadeOut){if(r.hasEvent(e.EventObject.FADE_OUT)){var i=e.BaseObject.borrowObject(e.EventObject);i.animationState=this,a._armature._bufferEvent(i,e.EventObject.FADE_OUT)}}else if(r.hasEvent(e.EventObject.FADE_IN)){var o=e.BaseObject.borrowObject(e.EventObject);o.animationState=this,a._armature._bufferEvent(o,e.EventObject.FADE_IN)}if(a._fadeTime>=a.fadeTotalTime)if(a._isFadeOut){if(a._isFadeOutComplete=!0,r.hasEvent(e.EventObject.FADE_OUT_COMPLETE)){var s=e.BaseObject.borrowObject(e.EventObject);s.animationState=this,a._armature._bufferEvent(s,e.EventObject.FADE_OUT_COMPLETE)}}else if(a._isPausePlayhead=!1,r.hasEvent(e.EventObject.FADE_IN_COMPLETE)){var l=e.BaseObject.borrowObject(e.EventObject);l.animationState=this,a._armature._bufferEvent(l,e.EventObject.FADE_IN_COMPLETE)}}},i._isDisabled=function(e){return!this.displayControl||e.displayController&&e.displayController!=this._name&&e.displayController!=this._group?!0:!1},i._fadeIn=function(t,a,n,r,i,o,s,l,_,u){var f=this;f._armature=t,f._animationData=a,f._name=n,f.playTimes=r,f.timeScale=l,f.fadeTotalTime=_,f._position=i,f._duration=o,f._time=s,f._isPausePlayhead=u,0==f.fadeTotalTime&&(f._fadeProgress=.999999),f._timeline=e.BaseObject.borrowObject(e.AnimationTimelineState),f._timeline.fadeIn(f._armature,f,f._animationData,f._time),f._updateTimelineStates()},i._updateTimelineStates=function(){var t=this,a=t._time;t._animationData.hasAsynchronyTimeline||(a=t._timeline._currentTime);for(var n={},r={},i=0,o=t._boneTimelines.length;o>i;++i){var s=t._boneTimelines[i];n[s.bone.name]=s}for(var l=t._armature.getBones(),i=0,o=l.length;o>i;++i){var _=l[i],u=_.name,f=t._animationData.getBoneTimeline(u);if(f&&t.containsBoneMask(u)){var s=n[u];s?delete n[u]:(s=e.BaseObject.borrowObject(e.BoneTimelineState),s.bone=_,s.fadeIn(t._armature,this,f,a),t._boneTimelines.push(s))}}for(var i in n){var s=n[i];s.bone.invalidUpdate(),t._boneTimelines.splice(t._boneTimelines.indexOf(s),1),s.returnToPool()}for(var i=0,o=t._slotTimelines.length;o>i;++i){var m=t._slotTimelines[i];r[m.slot.name]=m}for(var h=t._armature.getSlots(),i=0,o=h.length;o>i;++i){var c=h[i],d=c.name,g=c.parent.name,p=t._animationData.getSlotTimeline(d);if(p&&t.containsBoneMask(g)&&!t._isFadeOut){var m=r[d];m?delete r[d]:(m=e.BaseObject.borrowObject(e.SlotTimelineState),m.slot=c,m.fadeIn(t._armature,this,p,a),t._slotTimelines.push(m))}}for(var i in r){var m=r[i];t._slotTimelines.splice(t._slotTimelines.indexOf(m),1),m.returnToPool()}t._updateFFDTimelineStates()},i._updateFFDTimelineStates=function(){var t=this,a=t._time;t._animationData.hasAsynchronyTimeline||(a=t._timeline._currentTime);for(var n={},r=0,i=t._ffdTimelines.length;i>r;++r){var o=t._ffdTimelines[r];n[o.slot.name]=o}for(var s=t._armature.getSlots(),r=0,i=s.length;i>r;++r){var l=s[r],_=l.name,u=l.parent.name;if(l._meshData){var f=t._animationData.getFFDTimeline(t._armature._skinData.name,_,l.displayIndex);if(f&&t.containsBoneMask(u)){var o=n[_];o?delete n[_]:(o=e.BaseObject.borrowObject(e.FFDTimelineState),o.slot=l,o.fadeIn(t._armature,this,f,a),t._ffdTimelines.push(o))}else{for(var m=0,h=l._ffdVertices.length;h>m;++m)l._ffdVertices[m]=0;l._ffdDirty=!0}}}for(var r in n){var o=n[r];o.slot._ffdDirty=!0,t._ffdTimelines.splice(t._ffdTimelines.indexOf(o),1),o.returnToPool()}},i._advanceTime=function(e,t,a){var n=this;if(0!=e&&n._advanceFadeTime(e),e*=n.timeScale,0!=e&&n._isPlaying&&!n._isPausePlayhead&&(n._time+=e),n._weightResult=n.weight*n._fadeProgress*t,0!=n._weightResult){var r=n._fadeProgress>=1&&0==a&&n._armature.cacheFrameRate>0,i=n._animationData.cacheTimeToFrameScale,o=!0,s=!0,l=r?Math.floor(n._time*i)/i:n._time;if(n._timeline.update(l),n._animationData.hasAsynchronyTimeline||(l=n._timeline._currentTime),r){var _=Math.floor(n._timeline._currentTime*i);if(n._armature._cacheFrameIndex==_)o=!1,s=!1;else{if(n._armature._cacheFrameIndex=_,n._armature._animation._animationStateDirty){n._armature._animation._animationStateDirty=!1;for(var u=0,f=n._boneTimelines.length;f>u;++u){var m=n._boneTimelines[u];m.bone._cacheFrames=m._timeline.cachedFrames}for(var u=0,f=n._slotTimelines.length;f>u;++u){var h=n._slotTimelines[u];h.slot._cacheFrames=h._timeline.cachedFrames}}n._animationData.cachedFrames[_]?s=!1:n._animationData.cachedFrames[_]=!0}}else n._armature._cacheFrameIndex=-1;if(o){if(s)for(var u=0,f=n._boneTimelines.length;f>u;++u)n._boneTimelines[u].update(l);for(var u=0,f=n._slotTimelines.length;f>u;++u)n._slotTimelines[u].update(l);for(var u=0,f=n._ffdTimelines.length;f>u;++u)n._ffdTimelines[u].update(l)}}n.autoFadeOutTime>=0&&n._fadeProgress>=1&&n._timeline._isCompleted&&n.fadeOut(n.autoFadeOutTime)},i.play=function(){this._isPlaying=!0},i.stop=function(){this._isPlaying=!1},i.fadeOut=function(e,t){void 0===t&&(t=!0);var a=this;if((0>e||e!=e)&&(e=0),a._isPausePlayhead=t,a._isFadeOut){if(e>e-a._fadeTime)return}else{a._isFadeOut=!0,(0==e||a._fadeProgress<=0)&&(a._fadeProgress=1e-6);for(var n=0,r=a._boneTimelines.length;r>n;++n)a._boneTimelines[n].fadeOut();for(var n=0,r=a._slotTimelines.length;r>n;++n)a._slotTimelines[n].fadeOut()}a.displayControl=!1,a.fadeTotalTime=a._fadeProgress>1e-6?e/a._fadeProgress:0,a._fadeTime=a.fadeTotalTime*(1-a._fadeProgress)},i.containsBoneMask=function(e){return!this._boneMask.length||this._boneMask.indexOf(e)>=0},i.addBoneMask=function(e,t){void 0===t&&(t=!0);var a=this,n=a._armature.getBone(e);if(n){if(a._boneMask.indexOf(e)<0&&a._animationData.getBoneTimeline(e)&&a._boneMask.push(e),t)for(var r=a._armature.getBones(),i=0,o=r.length;o>i;++i){var s=r[i],l=s.name;a._boneMask.indexOf(l)<0&&a._animationData.getBoneTimeline(l)&&n.contains(s)&&a._boneMask.push(l)}a._updateTimelineStates()}},i.removeBoneMask=function(e,t){void 0===t&&(t=!0);var a=this,n=a._boneMask.indexOf(e);if(n>=0&&a._boneMask.splice(n,1),t){var r=a._armature.getBone(e);if(r)for(var i=a._armature.getBones(),o=0,s=i.length;s>o;++o){var l=i[o],_=l.name,u=a._boneMask.indexOf(_);u>=0&&r.contains(l)&&a._boneMask.splice(u,1)}}a._updateTimelineStates()},i.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},n(i,"layer",function(){return this._layer}),n(i,"group",function(){return this._group}),n(i,"name",function(){return this._name}),n(i,"animationData",function(){return this._animationData}),n(i,"isCompleted",function(){return this._timeline._isCompleted}),n(i,"isPlaying",function(){return this._isPlaying&&!this._timeline._isCompleted}),n(i,"currentPlayTimes",function(){return this._currentPlayTimes}),n(i,"totalTime",function(){return this._duration}),n(i,"currentTime",function(){return this._timeline._currentTime},function(e){var t=this;if((0>e||e!=e)&&(e=0),t._time=e,t._timeline.setCurrentTime(t._time),0!=t._weightResult){var a=t._time;t._animationData.hasAsynchronyTimeline||(a=t._timeline._currentTime);for(var n=0,r=t._boneTimelines.length;r>n;++n)t._boneTimelines[n].setCurrentTime(a);for(var n=0,r=t._slotTimelines.length;r>n;++n)t._slotTimelines[n].setCurrentTime(a);for(var n=0,r=t._ffdTimelines.length;r>n;++n)t._ffdTimelines[n].setCurrentTime(a)}}),n(i,"clip",function(){return this._animationData}),a}(e.BaseObject);e.AnimationState=t,egret.registerClass(t,"dragonBones.AnimationState")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return n._onClear=function(){var e=this;e._isCompleted=!1,e._currentPlayTimes=0,e._currentTime=0,e._timeline=null,e._isReverse=!1,e._hasAsynchronyTimeline=!1,e._frameRate=0,e._keyFrameCount=0,e._frameCount=0,e._position=0,e._duration=0,e._animationDutation=0,e._timeScale=1,e._timeOffset=0,e._currentFrame=null,e._armature=null,e._animationState=null},n._onFadeIn=function(){},n._onUpdateFrame=function(e){},n._onArriveAtFrame=function(e){},n._onCrossFrame=function(e){},n._setCurrentTime=function(e){var t=this,a=0;if(t._hasAsynchronyTimeline){var n=t._animationState.playTimes,r=n*t._duration;e*=t._timeScale,0!=t._timeOffset&&(e+=t._timeOffset*t._animationDutation),n>0&&(e>=r||-r>=e)?(t._isCompleted=!0,a=n,e=0>e?0:t._duration):(t._isCompleted=!1,0>e?(a=Math.floor(-e/t._duration),e=t._duration- -e%t._duration):(a=Math.floor(e/t._duration),e%=t._duration),n>0&&a>n&&(a=n)),e+=t._position}else t._isCompleted=t._animationState._timeline._isCompleted,a=t._animationState._timeline._currentPlayTimes;return t._currentTime==e?!1:(1==t._keyFrameCount&&e>t._position&&this!=t._animationState._timeline&&(t._isCompleted=!0),t._isReverse=t._currentTime>e&&t._currentPlayTimes==a,t._currentTime=e,t._currentPlayTimes=a,!0)},n.setCurrentTime=function(e){var t=this;switch(t._setCurrentTime(e),t._keyFrameCount){case 0:break;case 1:t._currentFrame=t._timeline.frames[0],t._onArriveAtFrame(!1),t._onUpdateFrame(!1);break;default:t._currentFrame=t._timeline.frames[Math.floor(t._currentTime*t._frameRate)],t._onArriveAtFrame(!1),t._onUpdateFrame(!1)}t._currentFrame=null},n.fadeIn=function(e,t,a,n){var r=this;r._armature=e,r._animationState=t,r._timeline=a;var i=this==r._animationState._timeline;r._hasAsynchronyTimeline=i||r._animationState.animationData.hasAsynchronyTimeline,r._frameRate=r._armature.armatureData.frameRate,r._keyFrameCount=r._timeline.frames.length,r._frameCount=r._animationState.animationData.frameCount,r._position=r._animationState._position,r._duration=r._animationState._duration,r._animationDutation=r._animationState.animationData.duration,r._timeScale=i?1:1/r._timeline.scale,r._timeOffset=i?0:r._timeline.offset,r._onFadeIn(),r.setCurrentTime(n)},n.fadeOut=function(){},n.update=function(e){var t=this,a=t._currentTime;if(!t._isCompleted&&t._setCurrentTime(e)&&t._keyFrameCount){var n=t._keyFrameCount>1?Math.floor(t._currentTime*t._frameRate):0,r=t._timeline.frames[n];if(t._currentFrame!=r)if(t._keyFrameCount>1){var i=t._currentFrame;if(t._currentFrame=r,!i){var o=Math.floor(a*t._frameRate);i=t._timeline.frames[o],!t._isReverse&&a<=i.position&&(i=i.prev)}if(t._isReverse)for(;i!=r;)t._onCrossFrame(i),i=i.prev;else for(;i!=r;)i=i.next,t._onCrossFrame(i);t._onArriveAtFrame(!0)}else t._currentFrame=r,t._onCrossFrame(t._currentFrame),t._onArriveAtFrame(!0);t._onUpdateFrame(!0)}},t}(e.BaseObject);e.TimelineState=t,egret.registerClass(t,"dragonBones.TimelineState");var a=function(t){function a(){t.call(this)}__extends(a,t);var n=(__define,a),r=n.prototype;return a._getEasingValue=function(e,t){var a=1;if(t>2)return e;if(t>1)a=.5*(1-Math.cos(e*Math.PI)),t-=1;else if(t>0)a=1-Math.pow(1-e,2);else if(t>=-1)t*=-1,a=Math.pow(e,2);else{if(!(t>=-2))return e;t*=-1,a=Math.acos(1-2*e)/Math.PI,t-=1}return(a-e)*t+e},a._getCurveEasingValue=function(e,t){for(var a=0,n=0,r=0,i=t.length;i>r;r+=2)if(a=t[r],n=t[r+1],a>=e){if(0==r)return n*e/a;var o=t[r-2],s=t[r-1];return s+(n-s)*(e-o)/(a-o)}return n+(1-n)*(e-a)/(1-a)},r._onClear=function(){t.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=e.DragonBones.NO_TWEEN,this._curve=null},r._onArriveAtFrame=function(t){var a=this;a._tweenEasing=a._currentFrame.tweenEasing,a._curve=a._currentFrame.curve,(1==a._keyFrameCount||a._currentFrame.next==a._timeline.frames[0]&&(a._tweenEasing!=e.DragonBones.NO_TWEEN||a._curve)&&a._animationState.playTimes>0&&a._animationState.currentPlayTimes==a._animationState.playTimes-1)&&(a._tweenEasing=e.DragonBones.NO_TWEEN,a._curve=null)},r._onUpdateFrame=function(t){var n=this;n._tweenEasing!=e.DragonBones.NO_TWEEN&&n._currentFrame.duration>0?(n._tweenProgress=(n._currentTime-n._currentFrame.position+n._position)/n._currentFrame.duration,0!=n._tweenEasing&&(n._tweenProgress=a._getEasingValue(n._tweenProgress,n._tweenEasing))):n._curve?(n._tweenProgress=(n._currentTime-n._currentFrame.position+n._position)/n._currentFrame.duration,n._tweenProgress=a._getCurveEasingValue(n._tweenProgress,n._curve)):n._tweenProgress=0},r._updateExtensionKeyFrame=function(e,t,a){var n=0;if(e.type==t.type)for(var r=0,i=e.tweens.length;i>r;++r){var o=t.tweens[r]-e.tweens[r];a.tweens[r]=o,0!=o&&(n=2)}if(0==n){a.type!=e.type&&(n=1,a.type=e.type),a.tweens.length!=e.tweens.length&&(n=1,a.tweens.length=e.tweens.length),a.keys.length!=e.keys.length&&(n=1,a.keys.length=e.keys.length);for(var r=0,i=e.keys.length;i>r;++r){var s=e.keys[r];a.keys[r]!=s&&(n=1,a.keys[r]=s)}}return n},a}(t);e.TweenTimelineState=a,egret.registerClass(a,"dragonBones.TweenTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this)}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.AnimationTimelineState]"},r._onClear=function(){t.prototype._onClear.call(this),this._isStarted=!1},r._onCrossFrame=function(t){for(var a=this,n=t.actions,r=0,i=n.length;i>r;++r){var o=n[r];if(o.slot){var s=a._armature.getSlot(o.slot.name);if(s){var l=s.childArmature;l&&(l._action=o)}}else if(o.bone)for(var _=a._armature.getSlots(),u=0,f=_.length;f>u;++u){var m=_[u].childArmature;m&&(m._action=o)}else a._armature._action=o}for(var h=a._armature._display,c=t.events,r=0,i=c.length;i>r;++r){var d=c[r],g="";switch(d.type){case 0:g=e.EventObject.FRAME_EVENT;break;case 1:g=e.EventObject.SOUND_EVENT}if(h.hasEvent(g)){var p=e.BaseObject.borrowObject(e.EventObject);p.animationState=a._animationState,d.bone&&(p.bone=a._armature.getBone(d.bone.name)),d.slot&&(p.slot=a._armature.getSlot(d.slot.name)),p.name=d.name,p.data=d.data,a._armature._bufferEvent(p,g)}}},r.update=function(a){var n=this,r=n._currentPlayTimes,i=n._armature._display;if(!n._isStarted&&0!=a&&(n._isStarted=!0,i.hasEvent(e.EventObject.START))){var o=e.BaseObject.borrowObject(e.EventObject);o.animationState=n._animationState,n._armature._bufferEvent(o,e.EventObject.START)}if(t.prototype.update.call(this,a),r!=n._currentPlayTimes){var s=n._isCompleted?e.EventObject.COMPLETE:e.EventObject.LOOP_COMPLETE;if(i.hasEvent(s)){var o=e.BaseObject.borrowObject(e.EventObject);o.animationState=n._animationState,n._armature._bufferEvent(o,s)}}},a}(e.TimelineState);e.AnimationTimelineState=t,egret.registerClass(t,"dragonBones.AnimationTimelineState");var a=function(t){function a(){t.call(this),this._transform=new e.Transform,this._currentTransform=new e.Transform,this._durationTransform=new e.Transform}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.BoneTimelineState]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.bone=null,e._tweenTransform=0,e._tweenRotate=0,e._tweenScale=0,e._boneTransform=null,e._originTransform=null,e._transform.identity(),e._currentTransform.identity(),e._durationTransform.identity()},r._onFadeIn=function(){var e=this;e._originTransform=e._timeline.originTransform,e._boneTransform=e.bone._animationPose},r._onArriveAtFrame=function(a){var n=this;if(t.prototype._onArriveAtFrame.call(this,a),n._currentTransform.copyFrom(n._currentFrame.transform),n._tweenTransform=1,n._tweenRotate=1,n._tweenScale=1,n._keyFrameCount>1&&(n._tweenEasing!=e.DragonBones.NO_TWEEN||n._curve)){var r=n._currentFrame.next,i=r.transform;n._durationTransform.x=i.x-n._currentTransform.x,n._durationTransform.y=i.y-n._currentTransform.y,(0!=n._durationTransform.x||0!=n._durationTransform.y)&&(n._tweenTransform=2);var o=n._currentFrame.tweenRotate;if(o==o){if(o)if(o>0?i.skewY>=n._currentTransform.skewY:i.skewY<=n._currentTransform.skewY){var s=o>0?o-1:o+1;n._durationTransform.skewX=i.skewX-n._currentTransform.skewX+e.DragonBones.PI_D*s,n._durationTransform.skewY=i.skewY-n._currentTransform.skewY+e.DragonBones.PI_D*s}else n._durationTransform.skewX=i.skewX-n._currentTransform.skewX+e.DragonBones.PI_D*o,n._durationTransform.skewY=i.skewY-n._currentTransform.skewY+e.DragonBones.PI_D*o;else n._durationTransform.skewX=e.Transform.normalizeRadian(i.skewX-n._currentTransform.skewX),n._durationTransform.skewY=e.Transform.normalizeRadian(i.skewY-n._currentTransform.skewY);(0!=n._durationTransform.skewX||0!=n._durationTransform.skewY)&&(n._tweenRotate=2)}else n._durationTransform.skewX=0,n._durationTransform.skewY=0;n._currentFrame.tweenScale?(n._durationTransform.scaleX=i.scaleX-n._currentTransform.scaleX,n._durationTransform.scaleY=i.scaleY-n._currentTransform.scaleY,(0!=n._durationTransform.scaleX||0!=n._durationTransform.scaleY)&&(n._tweenScale=2)):(n._durationTransform.scaleX=0,n._durationTransform.scaleY=0)}else n._durationTransform.x=0,n._durationTransform.y=0,n._durationTransform.skewX=0,n._durationTransform.skewY=0,n._durationTransform.scaleX=0,n._durationTransform.scaleY=0},r._onUpdateFrame=function(e){var a=this;(a._tweenTransform||a._tweenRotate||a._tweenScale)&&(t.prototype._onUpdateFrame.call(this,e),a._tweenTransform&&(1==a._tweenTransform&&(a._tweenTransform=0),a._animationState.additiveBlending?(a._transform.x=a._currentTransform.x+a._durationTransform.x*a._tweenProgress,a._transform.y=a._currentTransform.y+a._durationTransform.y*a._tweenProgress):(a._transform.x=a._originTransform.x+a._currentTransform.x+a._durationTransform.x*a._tweenProgress,a._transform.y=a._originTransform.y+a._currentTransform.y+a._durationTransform.y*a._tweenProgress)),a._tweenRotate&&(1==a._tweenRotate&&(a._tweenRotate=0),a._animationState.additiveBlending?(a._transform.skewX=a._currentTransform.skewX+a._durationTransform.skewX*a._tweenProgress,a._transform.skewY=a._currentTransform.skewY+a._durationTransform.skewY*a._tweenProgress):(a._transform.skewX=a._originTransform.skewX+a._currentTransform.skewX+a._durationTransform.skewX*a._tweenProgress,a._transform.skewY=a._originTransform.skewY+a._currentTransform.skewY+a._durationTransform.skewY*a._tweenProgress)),a._tweenScale&&(1==a._tweenScale&&(a._tweenScale=0),a._animationState.additiveBlending?(a._transform.scaleX=a._currentTransform.scaleX+a._durationTransform.scaleX*a._tweenProgress,a._transform.scaleY=a._currentTransform.scaleY+a._durationTransform.scaleY*a._tweenProgress):(a._transform.scaleX=a._originTransform.scaleX*(a._currentTransform.scaleX+a._durationTransform.scaleX*a._tweenProgress),a._transform.scaleY=a._originTransform.scaleY*(a._currentTransform.scaleY+a._durationTransform.scaleY*a._tweenProgress))),a.bone.invalidUpdate())},r.fadeOut=function(){var t=this;t._transform.skewX=e.Transform.normalizeRadian(t._transform.skewX),t._transform.skewY=e.Transform.normalizeRadian(t._transform.skewY)},r.update=function(e){var a=this;t.prototype.update.call(this,e);var n=a._animationState._weightResult;if(n>0){0==a.bone._blendIndex?(a._boneTransform.x=a._transform.x*n,a._boneTransform.y=a._transform.y*n,a._boneTransform.skewX=a._transform.skewX*n,a._boneTransform.skewY=a._transform.skewY*n,a._boneTransform.scaleX=(a._transform.scaleX-1)*n+1,a._boneTransform.scaleY=(a._transform.scaleY-1)*n+1):(a._boneTransform.x+=a._transform.x*n,a._boneTransform.y+=a._transform.y*n,a._boneTransform.skewX+=a._transform.skewX*n,a._boneTransform.skewY+=a._transform.skewY*n,a._boneTransform.scaleX+=(a._transform.scaleX-1)*n,a._boneTransform.scaleY+=(a._transform.scaleY-1)*n),a.bone._blendIndex++;var r=a._animationState._fadeProgress;1>r&&a.bone.invalidUpdate()}},a}(e.TweenTimelineState);e.BoneTimelineState=a,egret.registerClass(a,"dragonBones.BoneTimelineState");var n=function(t){function a(){t.call(this),this._color=new e.ColorTransform,this._durationColor=new e.ColorTransform}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.SlotTimelineState]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.slot=null,e._colorDirty=!1,e._tweenColor=0,e._slotColor=null,e._color.identity(),e._durationColor.identity()},r._onFadeIn=function(){this._slotColor=this.slot._colorTransform},r._onArriveAtFrame=function(a){var n=this;if(t.prototype._onArriveAtFrame.call(this,a),n._animationState._isDisabled(n.slot))return n._tweenEasing=e.DragonBones.NO_TWEEN,n._curve=null,void(n._tweenColor=0);if(n.slot._displayDataSet){var r=n._currentFrame.displayIndex;n.slot.displayIndex>=0&&r>=0?n.slot._displayDataSet.displays.length>1&&n.slot._setDisplayIndex(r):n.slot._setDisplayIndex(r),n.slot._updateMeshData(!0)}if(n._currentFrame.displayIndex>=0){n._tweenColor=0;var i=n._currentFrame.color;if(n._keyFrameCount>1&&(n._tweenEasing!=e.DragonBones.NO_TWEEN||n._curve)){var o=n._currentFrame.next,s=o.color;i!=s&&o.displayIndex>=0&&(n._durationColor.alphaMultiplier=s.alphaMultiplier-i.alphaMultiplier,n._durationColor.redMultiplier=s.redMultiplier-i.redMultiplier,n._durationColor.greenMultiplier=s.greenMultiplier-i.greenMultiplier,n._durationColor.blueMultiplier=s.blueMultiplier-i.blueMultiplier,n._durationColor.alphaOffset=s.alphaOffset-i.alphaOffset,n._durationColor.redOffset=s.redOffset-i.redOffset,n._durationColor.greenOffset=s.greenOffset-i.greenOffset,n._durationColor.blueOffset=s.blueOffset-i.blueOffset,(0!=n._durationColor.alphaMultiplier||0!=n._durationColor.redMultiplier||0!=n._durationColor.greenMultiplier||0!=n._durationColor.blueMultiplier||0!=n._durationColor.alphaOffset||0!=n._durationColor.redOffset||0!=n._durationColor.greenOffset||0!=n._durationColor.blueOffset)&&(n._tweenColor=2))}0==n._tweenColor&&(n._durationColor.alphaMultiplier=i.alphaMultiplier-n._slotColor.alphaMultiplier,n._durationColor.redMultiplier=i.redMultiplier-n._slotColor.redMultiplier,n._durationColor.greenMultiplier=i.greenMultiplier-n._slotColor.greenMultiplier,n._durationColor.blueMultiplier=i.blueMultiplier-n._slotColor.blueMultiplier,n._durationColor.alphaOffset=i.alphaOffset-n._slotColor.alphaOffset,n._durationColor.redOffset=i.redOffset-n._slotColor.redOffset,n._durationColor.greenOffset=i.greenOffset-n._slotColor.greenOffset,n._durationColor.blueOffset=i.blueOffset-n._slotColor.blueOffset,(0!=n._durationColor.alphaMultiplier||0!=n._durationColor.redMultiplier||0!=n._durationColor.greenMultiplier||0!=n._durationColor.blueMultiplier||0!=n._durationColor.alphaOffset||0!=n._durationColor.redOffset||0!=n._durationColor.greenOffset||0!=n._durationColor.blueOffset)&&(n._tweenColor=1))}else n._tweenEasing=e.DragonBones.NO_TWEEN,n._curve=null,n._tweenColor=0},r._onUpdateFrame=function(e){var a=this;if(t.prototype._onUpdateFrame.call(this,e),a._tweenColor){1==a._tweenColor&&(a._tweenColor=0);var n=a._currentFrame.color;a._color.alphaMultiplier=n.alphaMultiplier+a._durationColor.alphaMultiplier*a._tweenProgress,a._color.redMultiplier=n.redMultiplier+a._durationColor.redMultiplier*a._tweenProgress,a._color.greenMultiplier=n.greenMultiplier+a._durationColor.greenMultiplier*a._tweenProgress,a._color.blueMultiplier=n.blueMultiplier+a._durationColor.blueMultiplier*a._tweenProgress,a._color.alphaOffset=n.alphaOffset+a._durationColor.alphaOffset*a._tweenProgress,a._color.redOffset=n.redOffset+a._durationColor.redOffset*a._tweenProgress,a._color.greenOffset=n.greenOffset+a._durationColor.greenOffset*a._tweenProgress,a._color.blueOffset=n.blueOffset+a._durationColor.blueOffset*a._tweenProgress,a._colorDirty=!0}},r.fadeOut=function(){this._tweenColor=0},r.update=function(e){var a=this;
if(t.prototype.update.call(this,e),0!=a._tweenColor||a._colorDirty){var n=a._animationState._weightResult;if(n>0){var r=a._animationState._fadeProgress;1>r?(a._slotColor.alphaMultiplier+=(a._color.alphaMultiplier-a._slotColor.alphaMultiplier)*r,a._slotColor.redMultiplier+=(a._color.redMultiplier-a._slotColor.redMultiplier)*r,a._slotColor.greenMultiplier+=(a._color.greenMultiplier-a._slotColor.greenMultiplier)*r,a._slotColor.blueMultiplier+=(a._color.blueMultiplier-a._slotColor.blueMultiplier)*r,a._slotColor.alphaOffset+=(a._color.alphaOffset-a._slotColor.alphaOffset)*r,a._slotColor.redOffset+=(a._color.redOffset-a._slotColor.redOffset)*r,a._slotColor.greenOffset+=(a._color.greenOffset-a._slotColor.greenOffset)*r,a._slotColor.blueOffset+=(a._color.blueOffset-a._slotColor.blueOffset)*r,a.slot._colorDirty=!0):a._colorDirty&&(a._colorDirty=!1,a._slotColor.alphaMultiplier=a._color.alphaMultiplier,a._slotColor.redMultiplier=a._color.redMultiplier,a._slotColor.greenMultiplier=a._color.greenMultiplier,a._slotColor.blueMultiplier=a._color.blueMultiplier,a._slotColor.alphaOffset=a._color.alphaOffset,a._slotColor.redOffset=a._color.redOffset,a._slotColor.greenOffset=a._color.greenOffset,a._slotColor.blueOffset=a._color.blueOffset,a.slot._colorDirty=!0)}}},a}(e.TweenTimelineState);e.SlotTimelineState=n,egret.registerClass(n,"dragonBones.SlotTimelineState");var r=function(t){function a(){t.call(this),this._ffdVertices=[]}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.FFDTimelineState]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.slot=null,e._tweenFFD=0,e._slotFFDVertices=null,e._durationFFDFrame&&(e._durationFFDFrame.returnToPool(),e._durationFFDFrame=null),e._ffdVertices.length&&(e._ffdVertices.length=0)},r._onFadeIn=function(){var t=this;t._slotFFDVertices=t.slot._ffdVertices,t._durationFFDFrame=e.BaseObject.borrowObject(e.ExtensionFrameData),t._durationFFDFrame.tweens.length=t._slotFFDVertices.length,t._ffdVertices.length=t._slotFFDVertices.length;for(var a=0,n=t._durationFFDFrame.tweens.length;n>a;++a)t._durationFFDFrame.tweens[a]=0;for(var a=0,n=t._ffdVertices.length;n>a;++a)t._ffdVertices[a]=0},r._onArriveAtFrame=function(a){var n=this;if(t.prototype._onArriveAtFrame.call(this,a),n._tweenFFD=0,(n._tweenEasing!=e.DragonBones.NO_TWEEN||n._curve)&&(n._tweenFFD=n._updateExtensionKeyFrame(n._currentFrame,n._currentFrame.next,n._durationFFDFrame)),0==n._tweenFFD)for(var r=n._currentFrame.tweens,i=0,o=r.length;o>i;++i)if(n._slotFFDVertices[i]!=r[i]){n._tweenFFD=1;break}},r._onUpdateFrame=function(e){var a=this;if(t.prototype._onUpdateFrame.call(this,e),0!=a._tweenFFD){1==a._tweenFFD&&(a._tweenFFD=0);for(var n=a._currentFrame.tweens,r=a._durationFFDFrame.tweens,i=0,o=n.length;o>i;++i)a._ffdVertices[i]=n[i]+r[i]*a._tweenProgress;a.slot._ffdDirty=!0}},r.update=function(e){var a=this;t.prototype.update.call(this,e);var n=a._animationState._weightResult;if(n>0){if(0==a.slot._blendIndex)for(var r=0,i=a._ffdVertices.length;i>r;++r)a._slotFFDVertices[r]=a._ffdVertices[r]*n;else for(var r=0,i=a._ffdVertices.length;i>r;++r)a._slotFFDVertices[r]+=a._ffdVertices[r]*n;a.slot._blendIndex++;var o=a._animationState._fadeProgress;1>o&&(a.slot._ffdDirty=!0)}},a}(e.TweenTimelineState);e.FFDTimelineState=r,egret.registerClass(r,"dragonBones.FFDTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function t(){this.time=(new Date).getTime()/e.DragonBones.SECOND_TO_MILLISECOND,this.timeScale=1,this._animatebles=[]}var a=__define,n=t,r=n.prototype;return a(t,"clock",function(){return t._clock||(t._clock=new t),t._clock}),r.advanceTime=function(t){var a=this;if(t!=t&&(t=0),0>t&&(t=(new Date).getTime()/e.DragonBones.SECOND_TO_MILLISECOND-a.time),t*=a.timeScale,0>t?a.time-=t:a.time+=t,t){for(var n=0,r=0,i=a._animatebles.length;i>n;++n){var o=a._animatebles[n];o?o.advanceTime(t):r++}if(r>0){for(r=0,i=a._animatebles.length;i>n;++n){var o=a._animatebles[n];o?a._animatebles[n-r]=o:r++}a._animatebles.length-=r}}},r.contains=function(e){return this._animatebles.indexOf(e)>=0},r.add=function(t){t&&this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),e.DragonBones.DEBUG&&t instanceof e.Armature&&e.DragonBones.addArmature(t))},r.remove=function(t){var a=this._animatebles.indexOf(t);a>=0&&(this._animatebles[a]=null,e.DragonBones.DEBUG&&t instanceof e.Armature&&e.DragonBones.removeArmature(t))},r.clear=function(){for(var e=0,t=this._animatebles.length;t>e;++e)this._animatebles[e]=null},t._clock=null,t}();e.WorldClock=t,egret.registerClass(t,"dragonBones.WorldClock",["dragonBones.IAnimateble"])}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),this._bones=[],this._slots=[],this._events=[],this.enableCache=!1}__extends(a,t);var n=__define,r=a,i=r.prototype;return a.toString=function(){return"[Class dragonBones.Armature]"},i._onClear=function(){var e=this;if(e.userData=null,e._bonesDirty=!1,e._cacheFrameIndex=-1,e._armatureData=null,e._skinData=null,e._animation&&(e._animation.returnToPool(),e._animation=null),e._display&&(e._display._onClear(),e._display=null),e._parent=null,e._action=null,e._replacedTexture=null,e._delayDispose=!1,e._lockDispose=!1,e._slotsDirty=!1,e._bones.length){for(var t=0,a=e._bones.length;a>t;++t)e._bones[t].returnToPool();e._bones.length=0}if(e._slots.length){for(var t=0,a=e._slots.length;a>t;++t)e._slots[t].returnToPool();e._slots.length=0}if(e._events.length){for(var t=0,a=e._events.length;a>t;++t)e._events[t].returnToPool();e._events.length=0}},i._sortBones=function(){var e=this._bones.length;if(e){var t=this._bones.concat(),a=0,n=0;for(this._bones.length=0;e>n;){var r=t[a++];a>=e&&(a=0),this._bones.indexOf(r)>=0||r.parent&&this._bones.indexOf(r.parent)<0||r.ik&&this._bones.indexOf(r.ik)<0||(r.ik&&r.ikChain>0&&r.ikChainIndex==r.ikChain?this._bones.splice(this._bones.indexOf(r.parent)+1,0,r):this._bones.push(r),n++)}}},i._sortSlots=function(){},i._addBoneToBoneList=function(e){this._bones.indexOf(e)<0&&(this._bonesDirty=!0,this._bones[this._bones.length]=e,this._animation._timelineStateDirty=!0)},i._removeBoneFromBoneList=function(e){var t=this._bones.indexOf(e);t>=0&&(this._bones.splice(t,1),this._animation._timelineStateDirty=!0)},i._addSlotToSlotList=function(e){this._slots.indexOf(e)<0&&(this._slotsDirty=!0,this._slots[this._slots.length]=e,this._animation._timelineStateDirty=!0)},i._removeSlotFromSlotList=function(e){var t=this._slots.indexOf(e);t>=0&&(this._slots.splice(t,1),this._animation._timelineStateDirty=!0)},i._bufferEvent=function(e,t){e.type=t,e.armature=this,this._events.push(e)},i.dispose=function(){this._delayDispose=!0,this._lockDispose||this.returnToPool()},i.advanceTime=function(t){var n=this;if(!n._lockDispose){n._lockDispose=!0;var r=t*n._animation.timeScale;n._animation._advanceTime(r),n._bonesDirty&&(n._bonesDirty=!1,n._sortBones()),n._slotsDirty&&(n._slotsDirty=!1,n._sortSlots());for(var i=0,o=n._bones.length;o>i;++i)n._bones[i]._update(n._cacheFrameIndex);for(var i=0,o=n._slots.length;o>i;++i){var s=n._slots[i];s._update(n._cacheFrameIndex);var l=s.childArmature;l&&(s.inheritAnimation?l.advanceTime(r):l.advanceTime(t))}if(n._action){switch(n._action.type){case 0:n._animation.play(n._action.data[0],n._action.data[1]);break;case 1:n._animation.stop(n._action.data[0]);break;case 2:n._animation.gotoAndPlayByTime(n._action.data[0],n._action.data[1],n._action.data[2]);break;case 3:n._animation.gotoAndStopByTime(n._action.data[0],n._action.data[1]);break;case 4:n._animation.fadeIn(n._action.data[0],n._action.data[1],n._action.data[2]);break;case 5:}n._action=null}if(n._events.length>0){for(var i=0,o=n._events.length;o>i;++i){var _=n._events[i];a._soundEventManager&&_.type==e.EventObject.SOUND_EVENT?a._soundEventManager._dispatchEvent(_):n._display._dispatchEvent(_),_.returnToPool()}n._events.length=0}n._lockDispose=!1}n._delayDispose&&n.returnToPool()},i.invalidUpdate=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=!1),e){var a=this.getBone(e);if(a&&(a.invalidUpdate(),t))for(var n=0,r=this._slots.length;r>n;++n){var i=this._slots[n];i.parent==a&&i.invalidUpdate()}}else{for(var n=0,r=this._bones.length;r>n;++n)this._bones[n].invalidUpdate();if(t)for(var n=0,r=this._slots.length;r>n;++n)this._slots[n].invalidUpdate()}},i.getSlot=function(e){for(var t=0,a=this._slots.length;a>t;++t){var n=this._slots[t];if(n.name==e)return n}return null},i.getSlotByDisplay=function(e){if(e)for(var t=0,a=this._slots.length;a>t;++t){var n=this._slots[t];if(n.display==e)return n}return null},i.addSlot=function(e,t){var a=this.getBone(t);if(!a)throw new Error;e._setArmature(this),e._setParent(a)},i.removeSlot=function(e){if(!e||e.armature!=this)throw new Error;e._setParent(null),e._setArmature(null)},i.getBone=function(e){for(var t=0,a=this._bones.length;a>t;++t){var n=this._bones[t];if(n.name==e)return n}return null},i.getBoneByDisplay=function(e){var t=this.getSlotByDisplay(e);return t?t.parent:null},i.addBone=function(e,t){if(void 0===t&&(t=null),!e)throw new Error;e._setArmature(this),e._setParent(t?this.getBone(t):null)},i.removeBone=function(e){if(!e||e.armature!=this)throw new Error;e._setParent(null),e._setArmature(null)},i.replaceTexture=function(e){this._replacedTexture=e;for(var t=0,a=this._slots.length;a>t;++t)this._slots[t].invalidUpdate()},i.getBones=function(){return this._bones},i.getSlots=function(){return this._slots},n(i,"name",function(){return this._armatureData?this._armatureData.name:null}),n(i,"armatureData",function(){return this._armatureData}),n(i,"animation",function(){return this._animation}),n(i,"display",function(){return this._display}),n(i,"parent",function(){return this._parent}),n(i,"cacheFrameRate",function(){return this._armatureData.cacheFrameRate},function(e){if(this._armatureData.cacheFrameRate!=e){this._armatureData.cacheFrames(e);for(var t=0,a=this._slots.length;a>t;++t){var n=this._slots[t],r=n.childArmature;r&&(r.cacheFrameRate=e)}}}),i.enableAnimationCache=function(e){this.cacheFrameRate=e},i.hasEventListener=function(e){this._display.hasEvent(e)},i.addEventListener=function(e,t,a){this._display.addEvent(e,t,a)},i.removeEventListener=function(e,t,a){this._display.removeEvent(e,t,a)},i.getDisplay=function(){return this._display},a._soundEventManager=null,a}(e.BaseObject);e.Armature=t,egret.registerClass(t,"dragonBones.Armature",["dragonBones.IAnimateble"])}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),this.global=new e.Transform,this.origin=new e.Transform,this.offset=new e.Transform,this._globalTransformMatrix=new e.Matrix}__extends(a,t);var n=__define,r=a,i=r.prototype;return i._onClear=function(){var e=this;e.userData=null,e.name=null,e.globalTransformMatrix=e._globalTransformMatrix,e.global.identity(),e.origin.identity(),e.offset.identity(),e._armature=null,e._parent=null,e._globalTransformMatrix.identity()},i._setArmature=function(e){this._armature=e},i._setParent=function(e){this._parent=e},n(i,"armature",function(){return this._armature}),n(i,"parent",function(){return this._parent}),a}(e.BaseObject);e.TransformObject=t,egret.registerClass(t,"dragonBones.TransformObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),this._animationPose=new e.Transform,this._bones=[],this._slots=[]}__extends(a,t);var n=__define,r=a,i=r.prototype;return a.toString=function(){return"[Class dragonBones.Bone]"},i._onClear=function(){var e=this;t.prototype._onClear.call(this),e.inheritTranslation=!1,e.inheritRotation=!1,e.inheritScale=!1,e.ikBendPositive=!1,e.ikWeight=0,e.length=0,e._transformDirty=2,e._blendIndex=0,e._cacheFrames=null,e._animationPose.identity(),e._visible=!0,e._ikChain=0,e._ikChainIndex=0,e._ik=null,e._bones.length&&(e._bones.length=0),e._slots.length&&(e._slots.length=0)},i._updateGlobalTransformMatrix=function(){var e=this;if(e._parent){var t=e._parent.global.skewY,a=e._parent.globalTransformMatrix;if(e.inheritScale)e.inheritRotation||(e.global.skewX-=t,e.global.skewY-=t),e.global.toMatrix(e.globalTransformMatrix),e.globalTransformMatrix.concat(a),e.inheritTranslation||(e.globalTransformMatrix.tx=e.global.x,e.globalTransformMatrix.ty=e.global.y),e.global.fromMatrix(e.globalTransformMatrix);else{if(e.inheritTranslation){var n=e.global.x,r=e.global.y;e.global.x=a.a*n+a.c*r+a.tx,e.global.y=a.d*r+a.b*n+a.ty}e.inheritRotation&&(e.global.skewX+=t,e.global.skewY+=t),e.global.toMatrix(e.globalTransformMatrix)}}else e.global.toMatrix(e.globalTransformMatrix)},i._computeIKA=function(){var e=this,t=e._ik.global,a=e.globalTransformMatrix.a*e.length,n=e.globalTransformMatrix.b*e.length,r=(Math.atan2(t.y-e.global.y,t.x-e.global.x)+e.offset.skewY-2*e.global.skewY+Math.atan2(n,a))*e.ikWeight;e.global.skewX+=r,e.global.skewY+=r,e.global.toMatrix(e.globalTransformMatrix)},i._computeIKB=function(){var e=this,t=e._parent.global,a=e._ik.global,n=e.globalTransformMatrix.a*e.length,r=e.globalTransformMatrix.b*e.length,i=n*n+r*r,o=Math.sqrt(i),s=e.global.x-t.x,l=e.global.y-t.y,_=s*s+l*l,u=Math.sqrt(_);s=a.x-t.x,l=a.y-t.y;var f=s*s+l*l,m=Math.sqrt(f),h=0;if(m>=o+u||u>=m+o||o>=m+u)h=Math.atan2(a.y-t.y,a.x-t.x)+e._parent.offset.skewY,m>=o+u||o>u&&(h+=Math.PI);else{var c=(_-i+f)/(2*f),d=Math.sqrt(_-c*c*f)/m,g=t.x+s*c,p=t.y+l*c,v=-l*d,T=s*d;e.ikBendPositive?(e.global.x=g-v,e.global.y=p-T):(e.global.x=g+v,e.global.y=p+T),h=Math.atan2(e.global.y-t.y,e.global.x-t.x)+e._parent.offset.skewY}h=(h-t.skewY)*e.ikWeight,t.skewX+=h,t.skewY+=h,t.toMatrix(e._parent.globalTransformMatrix),e._parent._transformDirty=1,e.global.x=t.x+Math.cos(t.skewY)*u,e.global.y=t.y+Math.sin(t.skewY)*u;var y=(Math.atan2(a.y-e.global.y,a.x-e.global.x)+e.offset.skewY-2*e.global.skewY+Math.atan2(r,n))*e.ikWeight;e.global.skewX+=y,e.global.skewY+=y,e.global.toMatrix(e.globalTransformMatrix)},i._setArmature=function(e){var t=this;if(t._armature!=e){t._ik=null;var a=null,n=null;if(t._armature&&(a=t.getSlots(),n=t.getBones(),t._armature._removeBoneFromBoneList(this)),t._armature=e,t._armature&&t._armature._addBoneToBoneList(this),a)for(var r=0,i=a.length;i>r;++r){var o=a[r];o.parent==this&&o._setArmature(t._armature)}if(n)for(var r=0,i=n.length;i>r;++r){var s=n[r];s.parent==this&&s._setArmature(t._armature)}}},i._setIK=function(e,t,a){var n=this;if(e){if(t==a){var r=n._parent;if(t&&r?t=1:(t=0,a=0,r=this),r==e||r.contains(e))e=null,t=0,a=0;else for(var i=e;i.ik&&i.ikChain;){if(r.contains(i.ik)){e=null,t=0,a=0;break}i=i.parent}}}else t=0,a=0;n._ik=e,n._ikChain=t,n._ikChainIndex=a,n._armature&&(n._armature._bonesDirty=!0)},i._update=function(t){var a=this;if(a._blendIndex=0,t>=0){var n=a._cacheFrames[t];a.globalTransformMatrix==n?a._transformDirty=0:n?(a._transformDirty=2,a.globalTransformMatrix=n):2==a._transformDirty||a._parent&&0!=a._parent._transformDirty||a._ik&&a.ikWeight>0&&0!=a._ik._transformDirty?(a._transformDirty=2,a.globalTransformMatrix=a._globalTransformMatrix):a.globalTransformMatrix!=a._globalTransformMatrix?(a._transformDirty=0,a._cacheFrames[t]=a.globalTransformMatrix):(a._transformDirty=1,a.globalTransformMatrix=a._globalTransformMatrix)}else(2==a._transformDirty||a._parent&&0!=a._parent._transformDirty||a._ik&&a.ikWeight>0&&0!=a._ik._transformDirty)&&(a._transformDirty=2,a.globalTransformMatrix=a._globalTransformMatrix);0!=a._transformDirty&&(2==a._transformDirty?a._transformDirty=1:a._transformDirty=0,a.globalTransformMatrix==a._globalTransformMatrix&&(a.global.x=a.origin.x+a.offset.x+a._animationPose.x,a.global.y=a.origin.y+a.offset.y+a._animationPose.y,a.global.skewX=a.origin.skewX+a.offset.skewX+a._animationPose.skewX,a.global.skewY=a.origin.skewY+a.offset.skewY+a._animationPose.skewY,a.global.scaleX=a.origin.scaleX*a.offset.scaleX*a._animationPose.scaleX,a.global.scaleY=a.origin.scaleY*a.offset.scaleY*a._animationPose.scaleY,a._updateGlobalTransformMatrix(),a._ik&&a._ikChainIndex==a._ikChain&&a.ikWeight>0&&(a.inheritTranslation&&a._ikChain>0&&a._parent?a._computeIKB():a._computeIKA()),t>=0&&(a.globalTransformMatrix=e.BoneTimelineData.cacheFrame(a._cacheFrames,t,a._globalTransformMatrix))))},i.invalidUpdate=function(){this._transformDirty=2},i.contains=function(e){if(e){if(e==this)return!1;for(var t=e;t!=this&&t;)t=t.parent;return t==this}return!1},i.getBones=function(){this._bones.length=0;for(var e=this._armature.getBones(),t=0,a=e.length;a>t;++t){var n=e[t];n.parent==this&&this._bones.push(n)}return this._bones},i.getSlots=function(){this._slots.length=0;for(var e=this._armature.getSlots(),t=0,a=e.length;a>t;++t){var n=e[t];n.parent==this&&this._slots.push(n)}return this._slots},n(i,"ikChain",function(){return this._ikChain}),n(i,"ikChainIndex",function(){return this._ikChainIndex}),n(i,"ik",function(){return this._ik}),n(i,"visible",function(){return this._visible},function(e){if(this._visible!=e){this._visible=e;for(var t=this._armature.getSlots(),a=0,n=t.length;n>a;++a){var r=t[a];r._parent==this&&r._updateVisible()}}}),n(i,"slot",function(){for(var e=this._armature.getSlots(),t=0,a=e.length;a>t;++t){var n=e[t];if(n.parent==this)return n}return null}),a}(e.TransformObject);e.Bone=t,egret.registerClass(t,"dragonBones.Bone")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),this._colorTransform=new e.ColorTransform,this._ffdVertices=[],this._replacedDisplayDataSet=[],this._localMatrix=new e.Matrix,this._displayList=[],this._meshBones=[]}__extends(a,t);var n=__define,r=a,i=r.prototype;return i._onClear=function(){var a=this;t.prototype._onClear.call(this);for(var n=[],r=0,i=a._displayList.length;i>r;++r){var o=a._displayList[r];o!=a._rawDisplay&&o!=a._meshDisplay&&n.indexOf(o)<0&&n.push(o)}for(var r=0,i=n.length;i>r;++r){var o=n[r];o instanceof e.Armature?o.returnToPool():a._disposeDisplay(o)}a._meshDisplay&&a._meshDisplay!=a._rawDisplay&&a._disposeDisplay(a._meshDisplay),a._rawDisplay&&a._disposeDisplay(a._rawDisplay),a.inheritAnimation=!0,a.displayController=null,a._colorDirty=!1,a._ffdDirty=!1,a._blendIndex=0,a._zOrder=0,a._displayDataSet=null,a._meshData=null,a._cacheFrames=null,a._rawDisplay=null,a._meshDisplay=null,a._colorTransform.identity(),a._ffdVertices.length&&(a._ffdVertices.length=0),a._replacedDisplayDataSet.length&&(a._replacedDisplayDataSet.length=0),a._displayDirty=!1,a._blendModeDirty=!1,a._originDirty=!1,a._transformDirty=!1,a._displayIndex=0,a._blendMode=0,a._display=null,a._childArmature=null,a._localMatrix.identity(),a._displayList.length&&(a._displayList.length=0),a._meshBones.length&&(a._meshBones.length=0)},i._isMeshBonesUpdate=function(){for(var e=0,t=this._meshBones.length;t>e;++e)if(0!=this._meshBones[e]._transformDirty)return!0;return!1},i._updateDisplay=function(){var t=this,a=t._display||t._rawDisplay,n=t._childArmature;t._displayIndex>=0&&t._displayIndex<t._displayList.length?(t._display=t._displayList[t._displayIndex],t._display instanceof e.Armature?(t._childArmature=t._display,t._display=t._childArmature._display):t._childArmature=null):(t._display=null,t._childArmature=null);var r=t._display||t._rawDisplay;if(r!=a&&(t._onUpdateDisplay(),a?t._replaceDisplay(a):t._addDisplay(),t._blendModeDirty=!0,t._colorDirty=!0),t._displayDataSet&&t._displayIndex>=0&&t._displayIndex<t._displayDataSet.displays.length&&(t.origin.copyFrom(t._displayDataSet.displays[t._displayIndex].transform),t._originDirty=!0),t._updateMeshData(!1),(r==t._rawDisplay||r==t._meshDisplay)&&t._updateFrame(),t._childArmature!=n&&(n&&(n._parent=null,t.inheritAnimation&&n.animation.reset()),t._childArmature&&(t._childArmature._parent=this,t.inheritAnimation))){var i=t._armature.cacheFrameRate;i&&(t._childArmature.cacheFrameRate=i);var o=t._armature.armatureData.getSlot(t.name);o.actions.length>0?t._childArmature._action=o.actions[o.actions.length-1]:t._childArmature.animation.play()}},i._updateLocalTransformMatrix=function(){var e=this;e.global.copyFrom(e.origin).add(e.offset).toMatrix(e._localMatrix)},i._updateGlobalTransformMatrix=function(){var e=this;e.globalTransformMatrix.copyFrom(e._localMatrix),e.globalTransformMatrix.concat(e._parent.globalTransformMatrix),e.global.fromMatrix(e.globalTransformMatrix)},i._setArmature=function(e){var t=this;t._armature!=e&&(t._armature&&t._armature._removeSlotFromSlotList(this),t._armature=e,t._onUpdateDisplay(),t._armature?(t._armature._addSlotToSlotList(this),t._addDisplay()):t._removeDisplay())},i._updateMeshData=function(e){var t=this,a=t._meshData;if(t._display==t._meshDisplay&&t._displayDataSet&&t._displayIndex>=0&&t._displayIndex<t._displayDataSet.displays.length?t._meshData=t._displayDataSet.displays[t._displayIndex].meshData:t._meshData=null,t._meshData!=a){if(t._meshData){if(t._meshData.skinned){t._meshBones.length=t._meshData.bones.length;for(var n=0,r=t._meshBones.length;r>n;++n)t._meshBones[n]=t._armature.getBone(t._meshData.bones[n].name);for(var i=0,n=0,r=t._meshData.boneIndices.length;r>n;++n)i+=t._meshData.boneIndices[n].length;t._ffdVertices.length=2*i}else t._meshBones.length=0,t._ffdVertices.length=t._meshData.vertices.length;for(var n=0,r=t._ffdVertices.length;r>n;++n)t._ffdVertices[n]=0;t._ffdDirty=!0}else t._meshBones.length=0,t._ffdVertices.length=0;e&&t._armature.animation._updateFFDTimelineStates()}},i._update=function(t){var a=this;if(a._blendIndex=0,a._displayDirty&&(a._displayDirty=!1,a._updateDisplay()),a._display&&(a._blendModeDirty&&(a._blendModeDirty=!1,a._updateBlendMode()),a._colorDirty&&(a._colorDirty=!1,a._updateColor()),!a._meshData||((a._ffdDirty||a._meshData.skinned&&a._isMeshBonesUpdate())&&(a._ffdDirty=!1,a._updateMesh()),!a._meshData.skinned))){if(a._originDirty&&(a._originDirty=!1,a._transformDirty=!0,a._updateLocalTransformMatrix()),t>=0){var n=a._cacheFrames[t];a.globalTransformMatrix==n?a._transformDirty=!1:n?(a._transformDirty=!0,a.globalTransformMatrix=n):a._transformDirty||0!=a._parent._transformDirty?(a._transformDirty=!0,a.globalTransformMatrix=a._globalTransformMatrix):a.globalTransformMatrix!=a._globalTransformMatrix?(a._transformDirty=!1,a._cacheFrames[t]=a.globalTransformMatrix):(a._transformDirty=!0,a.globalTransformMatrix=a._globalTransformMatrix)}else(a._transformDirty||0!=a._parent._transformDirty)&&(a._transformDirty=!0,a.globalTransformMatrix=a._globalTransformMatrix);a._transformDirty&&(a._transformDirty=!1,a.globalTransformMatrix==a._globalTransformMatrix&&(a._updateGlobalTransformMatrix(),t>=0&&(a.globalTransformMatrix=e.SlotTimelineData.cacheFrame(a._cacheFrames,t,a._globalTransformMatrix))),a._updateTransform())}},i._setDisplayList=function(t){var a=this;if(t&&t.length){a._displayList.length!=t.length&&(a._displayList.length=t.length);for(var n=0,r=a._displayList.length;r>n;++n){var i=t[n];i&&i!=a._rawDisplay&&i!=a._meshDisplay&&!(i instanceof e.Armature)&&a._displayList.indexOf(i)<0&&a._initDisplay(i),a._displayList[n]=i}}else a._displayList.length&&(a._displayList.length=0);return a._displayIndex>=0&&a._displayIndex<a._displayList.length?a._displayDirty=a._display!=a._displayList[a._displayIndex]:a._displayDirty=null!=a._display,a._displayDirty},i._setDisplayIndex=function(e){return this._displayIndex==e?!1:(this._displayIndex=e,this._displayDirty=!0,this._displayDirty)},i._setBlendMode=function(e){return this._blendMode==e?!1:(this._blendMode=e,this._blendModeDirty=!0,!0)},i._setColor=function(e){return this._colorTransform.copyFrom(e),this._colorDirty=!0,!0},i.invalidUpdate=function(){this._displayDirty=!0},n(i,"rawDisplay",function(){return this._rawDisplay}),n(i,"MeshDisplay",function(){return this._meshDisplay}),n(i,"displayIndex",function(){return this._displayIndex},function(e){this._setDisplayIndex(e)&&this._update(-1)}),n(i,"displayList",function(){return this._displayList.concat()},function(t){var a=this,n=a._displayList.concat(),r=[];a._setDisplayList(t)&&a._update(-1);for(var i=0,o=n.length;o>i;++i){var s=n[i];s!=a._rawDisplay&&s!=a._meshDisplay&&a._displayList.indexOf(s)<0&&r.indexOf(s)<0&&r.push(s)}for(var i=0,o=r.length;o>i;++i){var s=r[i];s instanceof e.Armature?s.returnToPool():a._disposeDisplay(s)}}),n(i,"display",function(){return this._display},function(e){var t=this;if(t._display!=e){var a=t._displayList.length;if(t._displayIndex<0&&0==a&&(t._displayIndex=0),!(t._displayIndex<0)){var n=t.displayList;a<=t._displayIndex&&(n.length=t._displayIndex+1),n[t._displayIndex]=e,t.displayList=n}}}),n(i,"childArmature",function(){return this._childArmature},function(e){this._childArmature!=e&&(this.display=e)}),i.getDisplay=function(){return this._display},i.setDisplay=function(e){this.display=e},a}(e.TransformObject);e.Slot=t,egret.registerClass(t,"dragonBones.Slot")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.hasArmature=function(t){return e._armatures.indexOf(t)>=0},e.addArmature=function(t){t&&e._armatures.indexOf(t)<0&&e._armatures.push(t)},e.removeArmature=function(t){if(t){var a=e._armatures.indexOf(t);a>=0&&e._armatures.splice(a,1)}},e.PI_D=2*Math.PI,e.PI_H=Math.PI/2,e.PI_Q=Math.PI/4,e.ANGLE_TO_RADIAN=Math.PI/180,e.RADIAN_TO_ANGLE=180/Math.PI,e.SECOND_TO_MILLISECOND=1e3,e.NO_TWEEN=100,e.VERSION="4.7.1",e.DEBUG=!0,e._armatures=[],e}();e.DragonBones=t,egret.registerClass(t,"dragonBones.DragonBones")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this)}__extends(t,e);var a=__define,n=t,r=n.prototype;return t.toString=function(){return"[Class dragonBones.EventObject]"},r._onClear=function(){this.type=null,this.name=null,this.data=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.userData=null},a(r,"animationName",function(){return this.animationState.name}),t.START="start",t.LOOP_COMPLETE="loopComplete",t.COMPLETE="complete",t.FADE_IN="fadeIn",t.FADE_IN_COMPLETE="fadeInComplete",t.FADE_OUT="fadeOut",t.FADE_OUT_COMPLETE="fadeOutComplete",t.FRAME_EVENT="frameEvent",t.SOUND_EVENT="soundEvent",t}(e.BaseObject);e.EventObject=t,egret.registerClass(t,"dragonBones.EventObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this),this.textures={}}__extends(t,e);var a=(__define,t),n=a.prototype;return n._onClear=function(){var e=this;e.autoSearch=!1,e.scale=1,e.name=null,e.imagePath=null;for(var t in e.textures)e.textures[t].returnToPool(),delete e.textures[t]},n.dispose=function(){this.returnToPool()},n.addTextureData=function(e){if(!e||!e.name||this.textures[e.name])throw new Error;this.textures[e.name]=e,e.parent=this},n.getTextureData=function(e){return this.textures[e]},t}(e.BaseObject);e.TextureAtlasData=t,egret.registerClass(t,"dragonBones.TextureAtlasData");var a=function(t){function a(){t.call(this),this.region=new e.Rectangle}__extends(a,t);var n=(__define,a),r=n.prototype;return a.generateRectangle=function(){return new e.Rectangle},r._onClear=function(){var e=this;e.rotated=!1,e.name=null,e.frame=null,e.parent=null,e.region.clear()},a}(e.BaseObject);e.TextureData=a,egret.registerClass(a,"dragonBones.TextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function n(){t.call(this)}__extends(n,t);var r=(__define,n),i=r.prototype;return n.toString=function(){return"[Class dragonBones.EgretTextureAtlasData]"},i._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture=null)},i.generateTextureData=function(){return e.BaseObject.borrowObject(a)},n}(e.TextureAtlasData);e.EgretTextureAtlasData=t,egret.registerClass(t,"dragonBones.EgretTextureAtlasData");var a=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.EgretTextureData]"},n._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture.dispose(),this.texture=null)},t}(e.TextureData);e.EgretTextureData=a,egret.registerClass(a,"dragonBones.EgretTextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(e,a,n,r){t.call(this,e,a,n,r)}__extends(a,t);var n=__define,r=a,i=r.prototype;return n(i,"eventObject",function(){return this.data}),n(i,"frameLabel",function(){return this.eventObject.name}),n(i,"sound",function(){return this.eventObject.name}),n(i,"animationName",function(){return this.eventObject.animationState.name}),n(i,"armature",function(){return this.eventObject.armature}),n(i,"bone",function(){return this.eventObject.bone}),n(i,"slot",function(){return this.eventObject.slot}),n(i,"animationState",function(){return this.eventObject.animationState}),n(i,"movementID",function(){return this.animationName}),a.START=e.EventObject.START,a.LOOP_COMPLETE=e.EventObject.LOOP_COMPLETE,a.COMPLETE=e.EventObject.COMPLETE,a.FADE_IN=e.EventObject.FADE_IN,a.FADE_IN_COMPLETE=e.EventObject.FADE_IN_COMPLETE,a.FADE_OUT=e.EventObject.FADE_OUT,a.FADE_OUT_COMPLETE=e.EventObject.FADE_OUT_COMPLETE,a.FRAME_EVENT=e.EventObject.FRAME_EVENT,a.SOUND_EVENT=e.EventObject.SOUND_EVENT,a.ANIMATION_FRAME_EVENT=e.EventObject.FRAME_EVENT,a.BONE_FRAME_EVENT=e.EventObject.FRAME_EVENT,a.MOVEMENT_FRAME_EVENT=e.EventObject.FRAME_EVENT,a}(egret.Event);e.EgretEvent=t,egret.registerClass(t,"dragonBones.EgretEvent");var a=function(a){function n(){a.call(this),n._clock||(n._clock=new e.WorldClock,n._clock.time=egret.getTimer(),egret.startTick(n._clockHandler,n))}__extends(n,a);var r=__define,i=n,o=i.prototype;return n._clockHandler=function(e){var t=e-n._clock.time;return n._clock.advanceTime(.001*t),n._clock.time=e,!1},o._onClear=function(){this.advanceTimeBySelf(!1),this._armature=null},o._dispatchEvent=function(e){var a=egret.Event.create(t,e.type);a.data=e,this.dispatchEvent(a),egret.Event.release(a)},o.advanceTime=function(e){this._armature.advanceTime(e)},o.hasEvent=function(e){return this.hasEventListener(e)},o.addEvent=function(e,t,a){this.addEventListener(e,t,a)},o.removeEvent=function(e,t,a){this.removeEventListener(e,t,a)},o.advanceTimeBySelf=function(e){e?n._clock.add(this._armature):n._clock.remove(this._armature)},o.dispose=function(){this._armature&&this._armature.dispose()},r(o,"armature",function(){return this._armature}),r(o,"animation",function(){return this._armature.animation}),n._clock=null,n}(egret.DisplayObjectContainer);e.EgretArmatureDisplay=a,egret.registerClass(a,"dragonBones.EgretArmatureDisplay",["dragonBones.IArmatureDisplay","dragonBones.IEventDispatcher"]);var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var a=(__define,t);a.prototype;return t}(t);e.AnimationEvent=n,egret.registerClass(n,"dragonBones.AnimationEvent");var r=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var a=(__define,t);a.prototype;return t}(t);e.FrameEvent=r,egret.registerClass(r,"dragonBones.FrameEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var a=(__define,t);a.prototype;return t}(t);e.SoundEvent=i,egret.registerClass(i,"dragonBones.SoundEvent");var o=function(t){function a(a,n,r){void 0===r&&(r=1),t.call(this),this._onClear(),this.texture=a,e.ObjectDataParser.getInstance().parseTextureAtlasData(n,this,r)}__extends(a,t);var n=(__define,a);n.prototype;return a.toString=function(){return"[Class dragonBones.EgretTextureAtlas]"},a}(e.EgretTextureAtlasData);e.EgretTextureAtlas=o,egret.registerClass(o,"dragonBones.EgretTextureAtlas");var s=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var a=(__define,t);a.prototype;return t}(o);e.EgretSheetAtlas=s,egret.registerClass(s,"dragonBones.EgretSheetAtlas");var l=function(){function t(){}var a=(__define,t);a.prototype;return t.getInstance=function(){return e.Armature._soundEventManager},t}();e.SoundEventManager=l,egret.registerClass(l,"dragonBones.SoundEventManager");var _=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.AnimationCacheManager=_,egret.registerClass(_,"dragonBones.AnimationCacheManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function e(e,t,a,n,r,i,o,s){void 0===e&&(e=1),void 0===t&&(t=1),void 0===a&&(a=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.alphaMultiplier=e,this.redMultiplier=t,this.greenMultiplier=a,this.blueMultiplier=n,this.alphaOffset=r,this.redOffset=i,this.greenOffset=o,this.blueOffset=s
}var t=(__define,e),a=t.prototype;return a.copyFrom=function(e){var t=this;t.alphaMultiplier=e.alphaMultiplier,t.redMultiplier=e.redMultiplier,t.greenMultiplier=e.greenMultiplier,t.blueMultiplier=e.blueMultiplier,t.alphaOffset=e.alphaOffset,t.redOffset=e.redOffset,t.redOffset=e.redOffset,t.greenOffset=e.blueOffset},a.identity=function(){var e=this;e.alphaMultiplier=e.redMultiplier=e.greenMultiplier=e.blueMultiplier=1,e.alphaOffset=e.redOffset=e.greenOffset=e.blueOffset=0},e}();e.ColorTransform=t,egret.registerClass(t,"dragonBones.ColorTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function t(){this.autoSearch=!1,this._objectDataParser=new e.ObjectDataParser,this._dragonBonesDataMap={},this._textureAtlasDataMap={}}var a=(__define,t),n=a.prototype;return n._getTextureData=function(e,t){var a=this._textureAtlasDataMap[e];if(a)for(var n=0,r=a.length;r>n;++n){var i=a[n].getTextureData(t);if(i)return i}if(this.autoSearch)for(var n in this._textureAtlasDataMap){a=this._textureAtlasDataMap[n];for(var o=0,s=a.length;s>o;++o){var l=a[o];if(l.autoSearch){var i=l.getTextureData(t);if(i)return i}}}return null},n._fillBuildArmaturePackage=function(e,t,a,n){if(e){var r=this._dragonBonesDataMap[e];if(r){var i=r.getArmature(t);if(i)return n.dataName=e,n.data=r,n.armature=i,n.skin=i.getSkin(a),n.skin||(n.skin=i.defaultSkin),!0}}if(!e||this.autoSearch)for(var o in this._dragonBonesDataMap){var r=this._dragonBonesDataMap[o];if(!e||r.autoSearch){var i=r.getArmature(t);if(i)return n.dataName=o,n.data=r,n.armature=i,n.skin=i.getSkin(a),n.skin||(n.skin=i.defaultSkin),!0}}return!1},n._buildBones=function(t,a){for(var n=t.armature.sortedBones,r=0,i=n.length;i>r;++r){var o=n[r],s=e.BaseObject.borrowObject(e.Bone);s.name=o.name,s.inheritTranslation=o.inheritTranslation,s.inheritRotation=o.inheritRotation,s.inheritScale=o.inheritScale,s.length=o.length,s.origin.copyFrom(o.transform),o.parent?a.addBone(s,o.parent.name):a.addBone(s),o.ik&&(s.ikBendPositive=o.bendPositive,s.ikWeight=o.weight,s._setIK(a.getBone(o.ik.name),o.chain,o.chainIndex))}},n._buildSlots=function(e,t){var a=e.skin,n=e.armature.defaultSkin,r={};for(var i in n.slots){var o=n.slots[i];r[o.slot.name]=o}if(a!=n)for(var i in a.slots){var o=a.slots[i];r[o.slot.name]=o}for(var s=e.armature.sortedSlots,i=0,l=s.length;l>i;++i){var _=s[i],o=r[_.name];if(o){var u=this._generateSlot(e,o);u._displayDataSet=o,u._setDisplayIndex(_.displayIndex),u._setBlendMode(_.blendMode),u._setColor(_.color),u._replacedDisplayDataSet.length=u._displayDataSet.displays.length,t.addSlot(u,_.parent.name)}}},n._replaceSlotDisplay=function(e,t,a,n){if(0>n&&(n=a.displayIndex),n>=0){var r=a.displayList;if(r.length<=n&&(r.length=n+1),t.textureData||(t.textureData=this._getTextureData(e.dataName,t.name)),1==t.type){var i=this.buildArmature(t.name,e.dataName);r[n]=i}else a._replacedDisplayDataSet.length<=n&&(a._replacedDisplayDataSet.length=n+1),a._replacedDisplayDataSet[n]=t,t.meshData?r[n]=a.MeshDisplay:r[n]=a.rawDisplay;a.displayList=r,a.invalidUpdate()}},n.parseDragonBonesData=function(e,t){void 0===t&&(t=null);var a=this._objectDataParser.parseDragonBonesData(e);return this.addDragonBonesData(a,t),a},n.parseTextureAtlasData=function(e,t,a,n){void 0===a&&(a=null),void 0===n&&(n=0);var r=this._generateTextureAtlasData(null,null);return this._objectDataParser.parseTextureAtlasData(e,r,n),this._generateTextureAtlasData(r,t),this.addTextureAtlasData(r,a),r},n.getDragonBonesData=function(e){return this._dragonBonesDataMap[e]},n.addDragonBonesData=function(e,t){if(void 0===t&&(t=null),!e)throw new Error;t=t||e.name,t?this._dragonBonesDataMap[t]?console.warn("Same name data."):this._dragonBonesDataMap[t]=e:console.warn("Unnamed data.")},n.removeDragonBonesData=function(t,a){void 0===a&&(a=!0);var n=this._dragonBonesDataMap[t];if(n){if(a){if(e.DragonBones.DEBUG)for(var r=0,i=e.DragonBones._armatures.length;i>r;++r){var o=e.DragonBones._armatures[r];if(o.armatureData.parent==n)throw new Error("ArmatureData: "+o.armatureData.name+" DragonBonesData: "+t)}n.returnToPool()}delete this._dragonBonesDataMap[t]}},n.getTextureAtlasData=function(e){return this._textureAtlasDataMap[e]},n.addTextureAtlasData=function(e,t){if(void 0===t&&(t=null),!e)throw new Error;if(t=t||e.name){var a=this._textureAtlasDataMap[t]=this._textureAtlasDataMap[t]||[];a.indexOf(e)<0&&a.push(e)}else console.warn("Unnamed data.")},n.removeTextureAtlasData=function(e,t){void 0===t&&(t=!0);var a=this._textureAtlasDataMap[e];if(a){if(t)for(var n=0,r=a.length;r>n;++n)a[n].returnToPool();delete this._textureAtlasDataMap[e]}},n.clear=function(e){void 0===e&&(e=!0);var t=this;for(var a in t._dragonBonesDataMap)e&&t._dragonBonesDataMap[a].returnToPool(),delete t._dragonBonesDataMap[a];for(var a in t._textureAtlasDataMap){if(e)for(var n=t._textureAtlasDataMap[a],r=0,i=n.length;i>r;++r)n[r].returnToPool();delete t._textureAtlasDataMap[a]}},n.buildArmature=function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=null);var n={};if(this._fillBuildArmaturePackage(t,e,a,n)){var r=this._generateArmature(n);return this._buildBones(n,r),this._buildSlots(n,r),r.armatureData.actions.length>0&&(r._action=r.armatureData.actions[r.armatureData.actions.length-1]),r.advanceTime(0),r}return null},n.copyAnimationsToArmature=function(t,a,n,r,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0);var o={};if(this._fillBuildArmaturePackage(r,a,n,o)){var s=o.armature;if(i)t.animation.animations=s.animations;else{var l={};for(var _ in t.animation.animations)l[_]=t.animation.animations[_];for(var _ in s.animations)l[_]=s.animations[_];t.animation.animations=l}if(o.skin){for(var u=t.getSlots(),f=0,m=u.length;m>f;++f)for(var h=u[f],c=h.displayList,d=0,g=c.length;g>d;++d){var p=c[d];if(p instanceof e.Armature){var v=o.skin.getSlot(h.name).displays;if(d<v.length){var T=v[d];1==T.type&&this.copyAnimationsToArmature(p,T.name,n,r,i)}}}return!0}}return!1},n.replaceSlotDisplay=function(e,t,a,n,r,i){void 0===i&&(i=-1);var o={};if(this._fillBuildArmaturePackage(e,t,null,o)){var s=o.skin.getSlot(a);if(s)for(var l=0,_=s.displays.length;_>l;++l){var u=s.displays[l];if(u.name==n){this._replaceSlotDisplay(o,u,r,i);break}}}},n.replaceSlotDisplayList=function(e,t,a,n){var r={};if(this._fillBuildArmaturePackage(e,t,null,r)){var i=r.skin.getSlot(a);if(i)for(var o=0,s=0,l=i.displays.length;l>s;++s){var _=i.displays[s];this._replaceSlotDisplay(r,_,n,o++)}}},n.dispose=function(){this.clear()},t}();e.BaseFactory=t,egret.registerClass(t,"dragonBones.BaseFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this),e.Armature._soundEventManager||(e.Armature._soundEventManager=new e.EgretArmatureDisplay)}__extends(a,t);var n=__define,r=a,i=r.prototype;return i._generateTextureAtlasData=function(t,a){return t?t.texture=a:t=e.BaseObject.borrowObject(e.EgretTextureAtlasData),t},i._generateArmature=function(t){var a=e.BaseObject.borrowObject(e.Armature),n=new e.EgretArmatureDisplay;return a._armatureData=t.armature,a._skinData=t.skin,a._animation=e.BaseObject.borrowObject(e.Animation),a._display=n,n._armature=a,a._animation._armature=a,a.animation.animations=t.armature.animations,a},i._generateSlot=function(t,a){var n=e.BaseObject.borrowObject(e.EgretSlot),r=a.slot,i=[];n.name=r.name,n._rawDisplay=new egret.Bitmap;for(var o=0,s=a.displays.length;s>o;++o){var l=a.displays[o];switch(l.type){case 0:l.textureData||(l.textureData=this._getTextureData(t.dataName,l.name)),i.push(n._rawDisplay);break;case 2:l.textureData||(l.textureData=this._getTextureData(t.dataName,l.name)),"webgl"==egret.Capabilities.renderMode?(n._meshDisplay||(n._meshDisplay=new egret.Mesh),i.push(n._meshDisplay)):i.push(n._rawDisplay);break;case 1:var _=this.buildArmature(l.name,t.dataName);_&&(r.actions.length>0?_._action=r.actions[r.actions.length-1]:_.animation.play()),i.push(_);break;default:i.push(null)}}return n._setDisplayList(i),n},i.buildArmatureDisplay=function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=null);var n=this.buildArmature(e,t,a),r=n?n._display:null;return r&&r.advanceTimeBySelf(!0),r},i.getTextureDisplay=function(e,t){void 0===t&&(t=null);var a=this._getTextureData(t,e);return a?new egret.Bitmap(a.texture):null},n(i,"soundEventManater",function(){return e.Armature._soundEventManager}),i.addSkeletonData=function(e,t){void 0===t&&(t=null),this.addDragonBonesData(e,t)},i.getSkeletonData=function(e){return this.getDragonBonesData(e)},i.removeSkeletonData=function(e){this.removeDragonBonesData(e)},i.addTextureAtlas=function(e,t){void 0===t&&(t=null),this.addTextureAtlasData(e,t)},i.getTextureAtlas=function(e){return this.getTextureAtlasData(e)},i.removeTextureAtlas=function(e){this.removeTextureAtlasData(e)},i.buildFastArmature=function(e,t,a){return void 0===t&&(t=null),void 0===a&&(a=null),this.buildArmature(e,t,a)},a}(e.BaseFactory);e.EgretFactory=t,egret.registerClass(t,"dragonBones.EgretFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.EgretSlot]"},n._onClear=function(){e.prototype._onClear.call(this),this.transformUpdateEnabled=!1,this._renderDisplay=null,this._colorFilter=null},n._onUpdateDisplay=function(){var e=this;e._rawDisplay||(e._rawDisplay=new egret.Bitmap),e._renderDisplay=e._display||e._rawDisplay},n._initDisplay=function(e){},n._addDisplay=function(){var e=this._armature._display;e.addChild(this._renderDisplay)},n._replaceDisplay=function(e){var t=this._armature._display,a=e;t.addChild(this._renderDisplay),t.swapChildren(this._renderDisplay,a),t.removeChild(a)},n._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},n._disposeDisplay=function(e){},n._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},n._updateBlendMode=function(){if(this._blendMode<t.BLEND_MODE_LIST.length){var e=t.BLEND_MODE_LIST[this._blendMode];e&&(this._renderDisplay.blendMode=e)}},n._updateColor=function(){var e=this;if(1!=e._colorTransform.redMultiplier||1!=e._colorTransform.greenMultiplier||1!=e._colorTransform.blueMultiplier||0!=e._colorTransform.redOffset||0!=e._colorTransform.greenOffset||0!=e._colorTransform.blueOffset){e._colorFilter||(e._colorFilter=new egret.ColorMatrixFilter);var t=e._colorFilter.matrix;t[0]=e._colorTransform.redMultiplier,t[6]=e._colorTransform.greenMultiplier,t[12]=e._colorTransform.blueMultiplier,t[18]=e._colorTransform.alphaMultiplier,t[4]=e._colorTransform.redOffset,t[9]=e._colorTransform.greenOffset,t[14]=e._colorTransform.blueOffset,t[19]=e._colorTransform.alphaOffset,e._colorFilter.matrix=t;var a=e._renderDisplay.filters;a||(a=[]),a.indexOf(e._colorFilter)<0&&a.push(e._colorFilter),e._renderDisplay.filters=a}else e._colorFilter&&(e._colorFilter=null,e._renderDisplay.filters=null),e._renderDisplay.$setAlpha(e._colorTransform.alphaMultiplier)},n._updateFilters=function(){},n._updateFrame=function(){var e=this,t=e._renderDisplay;if(e._display&&e._displayIndex>=0){var a=e._displayIndex<e._displayDataSet.displays.length?e._displayDataSet.displays[e._displayIndex]:null,n=e._displayIndex<e._replacedDisplayDataSet.length?e._replacedDisplayDataSet[e._displayIndex]:null,r=n||a,i=r.textureData;if(i){var o=i.parent.texture;!i.texture&&o&&(i.texture=new egret.Texture,i.texture._bitmapData=o._bitmapData,i.texture.$initData(i.region.x,i.region.y,i.region.width,i.region.height,0,0,i.region.width,i.region.height,o.textureWidth,o.textureHeight));var s=e._armature._replacedTexture||i.texture;if(s){if(e._meshData&&e._display==e._meshDisplay){for(var l=e._meshDisplay,_=l.$renderNode,u=0,f=e._meshData.vertices.length;f>u;++u)_.uvs[u]=e._meshData.uvs[u],_.vertices[u]=e._meshData.vertices[u];for(var u=0,f=e._meshData.vertexIndices.length;f>u;++u)_.indices[u]=e._meshData.vertexIndices[u];l.$setBitmapData(s),l.$updateVertices(),l.$invalidateTransform()}else{var m=i.frame||i.region,h=m.width,c=m.height;i.rotated&&(h=m.height,c=m.width);var d=r.pivot.x,g=r.pivot.y;r.isRelativePivot&&(d=h*d,g=c*g),i.frame&&(d+=i.frame.x,g+=i.frame.y),a&&n&&(d+=a.transform.x-n.transform.x,g+=a.transform.y-n.transform.y),t.$setBitmapData(s),t.$setAnchorOffsetX(d),t.$setAnchorOffsetY(g)}return void e._updateVisible()}}}t.visible=!1,t.$setBitmapData(null),t.$setAnchorOffsetX(0),t.$setAnchorOffsetY(0),t.x=0,t.y=0},n._updateMesh=function(){var e=this,t=e._meshDisplay,a=t.$renderNode,n=e._ffdVertices.length>0;if(e._meshData.skinned){for(var r=0,i=0,o=e._meshData.vertices.length;o>r;r+=2){for(var s=r/2,l=e._meshData.boneIndices[s],_=e._meshData.boneVertices[s],u=e._meshData.weights[s],f=0,m=0,h=0,c=l.length;c>h;++h){var d=e._meshBones[l[h]],g=d.globalTransformMatrix,p=u[h],v=0,T=0;n?(v=_[2*h]+e._ffdVertices[i],T=_[2*h+1]+e._ffdVertices[i+1]):(v=_[2*h],T=_[2*h+1]),f+=(g.a*v+g.c*T+g.tx)*p,m+=(g.b*v+g.d*T+g.ty)*p,i+=2}a.vertices[r]=f,a.vertices[r+1]=m}t.$updateVertices(),t.$invalidateTransform()}else if(n){for(var y=e._meshData.vertices,r=0,o=e._meshData.vertices.length;o>r;r+=2){var f=y[r]+e._ffdVertices[r],m=y[r+1]+e._ffdVertices[r+1];a.vertices[r]=f,a.vertices[r+1]=m}t.$updateVertices(),t.$invalidateTransform()}},n._updateTransform=function(){var e=this;e._renderDisplay.$setMatrix(e.globalTransformMatrix,e.transformUpdateEnabled)},t.BLEND_MODE_LIST=[egret.BlendMode.NORMAL,egret.BlendMode.ADD,null,null,null,egret.BlendMode.ERASE,null,null,null,null,null,null,null,null],t}(e.Slot);e.EgretSlot=t,egret.registerClass(t,"dragonBones.EgretSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function e(e,t,a,n,r,i){void 0===e&&(e=1),void 0===t&&(t=0),void 0===a&&(a=0),void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i=0),this.a=e,this.b=t,this.c=a,this.d=n,this.tx=r,this.ty=i}var t=(__define,e),a=t.prototype;return a.copyFrom=function(e){var t=this;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},a.identity=function(){var e=this;e.a=e.d=1,e.b=e.c=0,e.tx=e.ty=0},a.concat=function(e){var t=this,a=t.a,n=t.b,r=t.c,i=t.d,o=t.tx,s=t.ty,l=e.a,_=e.b,u=e.c,f=e.d,m=e.tx,h=e.ty;t.a=a*l+n*u,t.b=a*_+n*f,t.c=r*l+i*u,t.d=r*_+i*f,t.tx=l*o+u*s+m,t.ty=f*s+_*o+h},a.invert=function(){var e=this,t=e.a,a=e.b,n=e.c,r=e.d,i=e.tx,o=e.ty,s=t*r-a*n;e.a=r/s,e.b=-a/s,e.c=-n/s,e.d=t/s,e.tx=(n*o-r*i)/s,e.ty=-(t*o-a*i)/s},a.transformPoint=function(e,t,a,n){void 0===n&&(n=!1);var r=this;a.x=r.a*e+r.c*t,a.y=r.b*e+r.d*t,n||(a.x+=r.tx,a.y+=r.ty)},e}();e.Matrix=t,egret.registerClass(t,"dragonBones.Matrix")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}var t=(__define,e),a=t.prototype;return a.copyFrom=function(e){this.x=e.x,this.y=e.y},a.clear=function(){this.x=this.y=0},e}();e.Point=t,egret.registerClass(t,"dragonBones.Point")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function e(e,t,a,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===a&&(a=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=a,this.height=n}var t=(__define,e),a=t.prototype;return a.copyFrom=function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},a.clear=function(){this.x=this.y=0,this.width=this.height=0},e}();e.Rectangle=t,egret.registerClass(t,"dragonBones.Rectangle")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function e(e,t,a,n,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=1),this.x=e,this.y=t,this.skewX=a,this.skewY=n,this.scaleX=r,this.scaleY=i}var t=__define,a=e,n=a.prototype;return e.normalizeRadian=function(e){return e=(e+Math.PI)%(2*Math.PI),e+=e>0?-Math.PI:Math.PI},n.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},n.copyFrom=function(e){var t=this;return t.x=e.x,t.y=e.y,t.skewX=e.skewX,t.skewY=e.skewY,t.scaleX=e.scaleX,t.scaleY=e.scaleY,this},n.clone=function(){var t=new e;return t.copyFrom(this),t},n.identity=function(){var e=this;return e.x=e.y=e.skewX=e.skewY=0,e.scaleX=e.scaleY=1,this},n.add=function(e){var t=this;return t.x+=e.x,t.y+=e.y,t.skewX+=e.skewX,t.skewY+=e.skewY,t.scaleX*=e.scaleX,t.scaleY*=e.scaleY,this},n.minus=function(t){var a=this;return a.x-=t.x,a.y-=t.y,a.skewX=e.normalizeRadian(a.skewX-t.skewX),a.skewY=e.normalizeRadian(a.skewY-t.skewY),a.scaleX/=t.scaleX,a.scaleY/=t.scaleY,this},n.fromMatrix=function(e){var t=this,a=.25*Math.PI,n=t.scaleX,r=t.scaleY;return t.x=e.tx,t.y=e.ty,t.skewX=Math.atan(-e.c/e.d),t.skewY=Math.atan(e.b/e.a),t.skewX!=t.skewX&&(t.skewX=0),t.skewY!=t.skewY&&(t.skewY=0),t.scaleY=t.skewX>-a&&t.skewX<a?e.d/Math.cos(t.skewX):-e.c/Math.sin(t.skewX),t.scaleX=t.skewY>-a&&t.skewY<a?e.a/Math.cos(t.skewY):e.b/Math.sin(t.skewY),n>=0&&t.scaleX<0&&(t.scaleX=-t.scaleX,t.skewY=t.skewY-Math.PI),r>=0&&t.scaleY<0&&(t.scaleY=-t.scaleY,t.skewX=t.skewX-Math.PI),this},n.toMatrix=function(e){var t=this;e.a=t.scaleX*Math.cos(t.skewY),e.b=t.scaleX*Math.sin(t.skewY),e.c=-t.scaleY*Math.sin(t.skewX),e.d=t.scaleY*Math.cos(t.skewX),e.tx=t.x,e.ty=t.y},t(n,"rotation",function(){return this.skewY},function(e){var t=e-this.skewY;this.skewX+=t,this.skewY+=t}),e}();e.Transform=t,egret.registerClass(t,"dragonBones.Transform")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this),this.frames=[]}__extends(t,e);var a=(__define,t),n=a.prototype;return n._onClear=function(){var e=this;if(e.scale=1,e.offset=0,e.frames.length){for(var t=null,a=0,n=e.frames.length;n>a;++a){var r=e.frames[a];t&&r!=t&&t.returnToPool(),t=r}e.frames.length=0}},t}(e.BaseObject);e.TimelineData=t,egret.registerClass(t,"dragonBones.TimelineData");var a=function(t){function a(){t.call(this),this.bone=null,this.originTransform=new e.Transform,this.cachedFrames=[]}__extends(a,t);var n=(__define,a),r=n.prototype;return a.cacheFrame=function(t,a,n){var r=t[a]=new e.Matrix;return r.copyFrom(n),r},a.toString=function(){return"[Class dragonBones.BoneTimelineData]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.bone=null,e.originTransform.identity(),e.cachedFrames.length&&(e.cachedFrames.length=0)},r.cacheFrames=function(e){this.cachedFrames.length=0,this.cachedFrames.length=e},a}(t);e.BoneTimelineData=a,egret.registerClass(a,"dragonBones.BoneTimelineData");var n=function(t){function a(){t.call(this),this.slot=null,this.cachedFrames=[]}__extends(a,t);var n=(__define,a),r=n.prototype;return a.cacheFrame=function(t,a,n){var r=t[a]=new e.Matrix;return r.copyFrom(n),r},a.toString=function(){return"[Class dragonBones.SlotTimelineData]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.slot=null,e.cachedFrames.length&&(e.cachedFrames.length=0)},r.cacheFrames=function(e){this.cachedFrames.length=0,this.cachedFrames.length=e},a}(t);e.SlotTimelineData=n,egret.registerClass(n,"dragonBones.SlotTimelineData");var r=function(e){function t(){e.call(this),this.displayIndex=0,this.skin=null,this.slot=null}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.FFDTimelineData]"},n._onClear=function(){var t=this;e.prototype._onClear.call(this),t.displayIndex=0,t.skin=null,t.slot=null},t}(t);e.FFDTimelineData=r,egret.registerClass(r,"dragonBones.FFDTimelineData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this),this.boneTimelines={},this.slotTimelines={},this.ffdTimelines={},this.cachedFrames=[]}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.AnimationData]"},n._onClear=function(){var t=this;e.prototype._onClear.call(this),t.hasAsynchronyTimeline=!1,t.cacheTimeToFrameScale=0,t.position=0,t.duration=0,t.playTimes=0,t.fadeInTime=0,t.name=null,t.animation=null;for(var a in t.boneTimelines)t.boneTimelines[a].returnToPool(),delete t.boneTimelines[a];for(var a in t.slotTimelines)t.slotTimelines[a].returnToPool(),delete t.slotTimelines[a];for(var a in t.ffdTimelines){for(var n in t.ffdTimelines[a])for(var r in t.ffdTimelines[a][n])t.ffdTimelines[a][n][r].returnToPool();delete t.ffdTimelines[a]}t.cachedFrames.length&&(t.cachedFrames.length=0)},n.cacheFrames=function(e){var t=this;if(!t.animation){var a=Math.max(Math.floor(t.frameCount*t.scale*e),1);t.cacheTimeToFrameScale=a/(t.duration+1e-6),t.cachedFrames.length=0,t.cachedFrames.length=a;for(var n in t.boneTimelines)t.boneTimelines[n].cacheFrames(a);for(var n in t.slotTimelines)t.slotTimelines[n].cacheFrames(a)}},n.addBoneTimeline=function(e){if(!e||!e.bone||this.boneTimelines[e.bone.name])throw new Error;this.boneTimelines[e.bone.name]=e},n.addSlotTimeline=function(e){if(!e||!e.slot||this.slotTimelines[e.slot.name])throw new Error;this.slotTimelines[e.slot.name]=e},n.addFFDTimeline=function(e){if(!(e&&e.skin&&e.slot))throw new Error;var t=this.ffdTimelines[e.skin.name]=this.ffdTimelines[e.skin.name]||{},a=t[e.slot.slot.name]=t[e.slot.slot.name]||{};if(a[e.displayIndex])throw new Error;a[e.displayIndex]=e},n.getBoneTimeline=function(e){return this.boneTimelines[e]},n.getSlotTimeline=function(e){return this.slotTimelines[e]},n.getFFDTimeline=function(e,t,a){var n=this.ffdTimelines[e];if(n){var r=n[t];if(r)return r[a]}return null},t}(e.TimelineData);e.AnimationData=t,egret.registerClass(t,"dragonBones.AnimationData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this),this.parent=null,this.bones={},this.slots={},this.skins={},this.animations={},this.actions=[],this._sortedBones=[],this._sortedSlots=[],this._bonesChildren={}}__extends(t,e);var a=__define,n=t,r=n.prototype;return t._onSortSlots=function(e,t){return e.zOrder>t.zOrder?1:-1},t.toString=function(){return"[Class dragonBones.ArmatureData]"},r._onClear=function(){var e=this;e.frameRate=0,e.cacheFrameRate=0,e.type=0,e.name=null,e.parent=null;for(var t in e.bones)e.bones[t].returnToPool(),delete e.bones[t];for(var t in e.slots)e.slots[t].returnToPool(),delete e.slots[t];for(var t in e.skins)e.skins[t].returnToPool(),delete e.skins[t];for(var t in e.animations)e.animations[t].returnToPool(),delete e.animations[t];if(e.actions.length){for(var t=0,a=e.actions.length;a>t;++t)e.actions[t].returnToPool();e.actions.length=0}e._boneDirty=!1,e._slotDirty=!1,e._defaultSkin=null,e._defaultAnimation=null,e._sortedBones.length&&(e._sortedBones.length=0),e._sortedSlots.length&&(e._sortedSlots.length=0);for(var t in e._bonesChildren)delete e._bonesChildren[t]},r._sortBones=function(){var e=this,t=e._sortedBones.length;if(t){var a=e._sortedBones.concat(),n=0,r=0;for(e._sortedBones.length=0;t>r;){var i=a[n++];n>=t&&(n=0),e._sortedBones.indexOf(i)>=0||i.parent&&e._sortedBones.indexOf(i.parent)<0||i.ik&&e._sortedBones.indexOf(i.ik)<0||(i.ik&&i.chain>0&&i.chainIndex==i.chain?e._sortedBones.splice(e._sortedBones.indexOf(i.parent)+1,0,i):e._sortedBones.push(i),r++)}}},r._sortSlots=function(){this._sortedSlots.sort(t._onSortSlots)},r.cacheFrames=function(e){var t=this;if(t.cacheFrameRate!=e){t.cacheFrameRate=e;var a=t.cacheFrameRate/t.frameRate;for(var n in t.animations)t.animations[n].cacheFrames(a)}},r.addBone=function(e,t){var a=this;if(!e||!e.name||a.bones[e.name])throw new Error;if(t){var n=a.getBone(t);n?e.parent=n:(a._bonesChildren[t]=a._bonesChildren[t]||[]).push(e)}var r=a._bonesChildren[e.name];if(r){for(var i=0,o=r.length;o>i;++i)r[i].parent=e;delete a._bonesChildren[e.name]}a.bones[e.name]=e,a._sortedBones.push(e),a._boneDirty=!0},r.addSlot=function(e){if(!e||!e.name||this.slots[e.name])throw new Error;this.slots[e.name]=e,this._sortedSlots.push(e),this._slotDirty=!0},r.addSkin=function(e){if(!e||!e.name||this.skins[e.name])throw new Error;this.skins[e.name]=e,this._defaultSkin||(this._defaultSkin=e)},r.addAnimation=function(e){if(!e||!e.name||this.animations[e.name])throw new Error;this.animations[e.name]=e,this._defaultAnimation||(this._defaultAnimation=e)},r.getBone=function(e){return this.bones[e]},r.getSlot=function(e){return this.slots[e]},r.getSkin=function(e){return e?this.skins[e]:this._defaultSkin},r.getAnimation=function(e){return e?this.animations[e]:this._defaultAnimation},a(r,"sortedBones",function(){return this._boneDirty&&(this._boneDirty=!1,this._sortBones()),this._sortedBones}),a(r,"sortedSlots",function(){return this._slotDirty&&(this._slotDirty=!1,this._sortSlots()),this._sortedSlots}),a(r,"defaultSkin",function(){return this._defaultSkin}),a(r,"defaultAnimation",function(){return this._defaultAnimation}),t}(e.BaseObject);e.ArmatureData=t,egret.registerClass(t,"dragonBones.ArmatureData");var a=function(t){function a(){t.call(this),this.transform=new e.Transform}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.BoneData]"},r._onClear=function(){var e=this;e.inheritTranslation=!1,e.inheritRotation=!1,e.inheritScale=!1,e.bendPositive=!1,e.chain=0,e.chainIndex=0,e.weight=0,e.length=0,e.name=null,e.parent=null,e.ik=null,e.transform.identity()},a}(e.BaseObject);e.BoneData=a,egret.registerClass(a,"dragonBones.BoneData");var n=function(t){function a(){t.call(this),this.actions=[]}__extends(a,t);var n=(__define,a),r=n.prototype;return a.generateColor=function(){return new e.ColorTransform},a.toString=function(){return"[Class dragonBones.SlotData]"},r._onClear=function(){var e=this;if(e.displayIndex=0,e.zOrder=0,e.blendMode=0,e.name=null,e.parent=null,e.color=null,e.actions.length){for(var t=0,a=e.actions.length;a>t;++t)e.actions[t].returnToPool();e.actions.length=0}},a.DEFAULT_COLOR=new e.ColorTransform,a}(e.BaseObject);e.SlotData=n,egret.registerClass(n,"dragonBones.SlotData");var r=function(e){function t(){e.call(this),this.name=null,this.slots={}}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.SkinData]"},n._onClear=function(){var e=this;e.name=null;for(var t in e.slots)e.slots[t].returnToPool(),delete e.slots[t]},n.addSlot=function(e){if(!e||!e.slot||this.slots[e.slot.name])throw new Error;this.slots[e.slot.name]=e},n.getSlot=function(e){return this.slots[e]},t}(e.BaseObject);e.SkinData=r,egret.registerClass(r,"dragonBones.SkinData");var i=function(e){function t(){e.call(this),this.displays=[]}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.SlotDisplayDataSet]"},n._onClear=function(){if(this.slot=null,this.displays.length){for(var e=0,t=this.displays.length;t>e;++e)this.displays[e].returnToPool();this.displays.length=0}},t}(e.BaseObject);e.SlotDisplayDataSet=i,egret.registerClass(i,"dragonBones.SlotDisplayDataSet");var o=function(t){function a(){t.call(this),this.pivot=new e.Point,this.transform=new e.Transform}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.DisplayData]"},r._onClear=function(){var e=this;e.isRelativePivot=!1,e.type=0,e.name=null,e.textureData=null,e.armatureData=null,e.meshData&&(e.meshData.returnToPool(),e.meshData=null),e.pivot.clear(),e.transform.identity()},a}(e.BaseObject);e.DisplayData=o,egret.registerClass(o,"dragonBones.DisplayData");var s=function(t){function a(){t.call(this),this.slotPose=new e.Matrix,this.uvs=[],this.vertices=[],this.vertexIndices=[],this.boneIndices=[],this.weights=[],this.boneVertices=[],this.bones=[],this.inverseBindPose=[]}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.MeshData]"},r._onClear=function(){var e=this;e.skinned=!1,e.slotPose.identity(),e.uvs.length&&(e.uvs.length=0),e.vertices.length&&(e.vertices.length=0),e.vertexIndices.length&&(e.vertexIndices.length=0),e.boneIndices.length&&(e.boneIndices.length=0),e.weights.length&&(e.weights.length=0),e.boneVertices.length&&(e.boneVertices.length=0),e.bones.length&&(e.bones.length=0),e.inverseBindPose.length&&(e.inverseBindPose.length=0)},a}(e.BaseObject);e.MeshData=s,egret.registerClass(s,"dragonBones.MeshData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this),this.armatures={},this._armatureNames=[]}__extends(t,e);var a=__define,n=t,r=n.prototype;return t.toString=function(){return"[Class dragonBones.DragonBonesData]"},r._onClear=function(){var e=this;e.autoSearch=!1,e.frameRate=0,e.name=null;for(var t in e.armatures)e.armatures[t].returnToPool(),delete e.armatures[t];e._armatureNames.length&&(e._armatureNames.length=0)},r.getArmature=function(e){return this.armatures[e]},r.addArmature=function(e){if(!e||!e.name||this.armatures[e.name])throw new Error;this.armatures[e.name]=e,this._armatureNames.push(e.name),e.parent=this},a(r,"armatureNames",function(){return this._armatureNames}),r.dispose=function(){this.returnToPool()},t}(e.BaseObject);e.DragonBonesData=t,egret.registerClass(t,"dragonBones.DragonBonesData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.ActionData]"},n._onClear=function(){var e=this;e.type=0,e.data=null,e.bone=null,e.slot=null},t}(e.BaseObject);e.ActionData=t,egret.registerClass(t,"dragonBones.ActionData");var a=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.EventData]"},n._onClear=function(){var e=this;e.type=0,e.name=null,e.data=null,e.bone=null,e.slot=null},t}(e.BaseObject);e.EventData=a,egret.registerClass(a,"dragonBones.EventData");var n=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return n._onClear=function(){var e=this;e.position=0,e.duration=0,e.prev=null,e.next=null},t}(e.BaseObject);e.FrameData=n,egret.registerClass(n,"dragonBones.FrameData");var r=function(e){function t(){e.call(this)}__extends(t,e);var a=(__define,t),n=a.prototype;return t.samplingCurve=function(e,t){if(0==e.length||0==t)return null;var a=t+2,n=1/a,r=new Array(2*(a-1));e.unshift(0,0),e.push(1,1);for(var i=0,o=0;a-1>o;++o){for(var s=n*(o+1);e[i+6]<s;)i+=6;var l=e[i],_=e[i+6],u=(s-l)/(_-l),f=1-u,m=f*f,h=u*u,c=f*m,d=3*u*m,g=3*f*h,p=u*h;r[2*o]=c*l+d*e[i+2]+g*e[i+4]+p*_,r[2*o+1]=c*e[i+1]+d*e[i+3]+g*e[i+5]+p*e[i+7]}return r},n._onClear=function(){e.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},t}(n);e.TweenFrameData=r,egret.registerClass(r,"dragonBones.TweenFrameData");var i=function(e){function t(){e.call(this),this.actions=[],this.events=[]}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.AnimationFrameData]"},n._onClear=function(){var t=this;if(e.prototype._onClear.call(this),t.actions.length){for(var a=0,n=t.actions.length;n>a;++a)t.actions[a].returnToPool();t.actions.length=0}if(t.events.length){for(var a=0,n=t.events.length;n>a;++a)t.events[a].returnToPool();t.events.length=0}},t}(n);e.AnimationFrameData=i,egret.registerClass(i,"dragonBones.AnimationFrameData");var o=function(t){function a(){t.call(this),this.transform=new e.Transform}__extends(a,t);var n=(__define,a),r=n.prototype;return a.toString=function(){return"[Class dragonBones.BoneFrameData]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.tweenScale=!1,e.tweenRotate=0,e.transform.identity()},a}(r);e.BoneFrameData=o,egret.registerClass(o,"dragonBones.BoneFrameData");var s=function(t){function a(){t.call(this)}__extends(a,t);var n=(__define,a),r=n.prototype;return a.generateColor=function(){return new e.ColorTransform},a.toString=function(){return"[Class dragonBones.SlotFrameData]"},r._onClear=function(){var e=this;t.prototype._onClear.call(this),e.displayIndex=0,e.zOrder=0,e.color=null},a.DEFAULT_COLOR=new e.ColorTransform,a}(r);e.SlotFrameData=s,egret.registerClass(s,"dragonBones.SlotFrameData");var l=function(e){function t(){e.call(this),this.tweens=[],this.keys=[]
}__extends(t,e);var a=(__define,t),n=a.prototype;return t.toString=function(){return"[Class dragonBones.ExtensionFrameData]"},n._onClear=function(){var t=this;e.prototype._onClear.call(this),t.type=0,t.tweens.length&&(t.tweens.length=0),t.keys.length&&(t.keys.length=0)},t}(r);e.ExtensionFrameData=l,egret.registerClass(l,"dragonBones.ExtensionFrameData")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(){function t(){this._data=null,this._armature=null,this._skin=null,this._slotDisplayDataSet=null,this._mesh=null,this._animation=null,this._timeline=null,this._isParentCooriinate=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._armatureScale=1,this._helpPoint=new e.Point,this._helpTransform=new e.Transform,this._helpMatrix=new e.Matrix,this._rawBones=[]}var a=(__define,t),n=a.prototype;return t._getArmatureType=function(e){switch(e.toLowerCase()){case"stage":return 0;case"armature":return 0;case"movieClip":return 1;default:return 0}},t._getDisplayType=function(e){switch(e.toLowerCase()){case"image":return 0;case"armature":return 1;case"mesh":return 2;default:return 0}},t._getBlendMode=function(e){switch(e.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},t._getActionType=function(e){switch(e.toLowerCase()){case"play":return 0;case"stop":return 1;case"gotoandplay":return 2;case"gotoandstop":return 3;case"fadein":return 4;case"fadeout":return 5;default:return 4}},n._getTimelineFrameMatrix=function(t,a,n,r){var i=Math.floor(n*t.frameCount/t.duration);if(1==a.frames.length||i>=a.frames.length)r.copyFrom(a.frames[0].transform);else{var o=a.frames[i],s=0;o.duration>0&&o.tweenEasing!=e.DragonBones.NO_TWEEN?(s=(n-o.position)/o.duration,0!=o.tweenEasing&&(s=e.TweenTimelineState._getEasingValue(s,o.tweenEasing))):o.curve&&(s=(n-o.position)/o.duration,s=e.TweenTimelineState._getCurveEasingValue(s,o.curve)),r.x=o.next.transform.x-o.transform.x,r.y=o.next.transform.y-o.transform.y,r.skewX=e.Transform.normalizeRadian(o.next.transform.skewX-o.transform.skewX),r.skewY=e.Transform.normalizeRadian(o.next.transform.skewY-o.transform.skewY),r.scaleX=o.next.transform.scaleX-o.transform.scaleX,r.scaleY=o.next.transform.scaleY-o.transform.scaleY,r.x=o.transform.x+r.x*s,r.y=o.transform.y+r.y*s,r.skewX=o.transform.skewX+r.skewX*s,r.skewY=o.transform.skewY+r.skewY*s,r.scaleX=o.transform.scaleX+r.scaleX*s,r.scaleY=o.transform.scaleY+r.scaleY*s}r.add(a.originTransform)},n._mergeFrameToAnimationTimeline=function(t,a,n){var r=Math.floor(t.position*this._armature.frameRate),i=this._animation.frames;if(0==i.length){var o=e.BaseObject.borrowObject(e.AnimationFrameData);if(o.position=0,this._animation.frameCount>1){i.length=this._animation.frameCount+1;var s=e.BaseObject.borrowObject(e.AnimationFrameData);s.position=this._animation.frameCount/this._armature.frameRate,i[0]=o,i[this._animation.frameCount]=s}}var l=null,_=i[r];if(!_||0!=r&&i[r-1]!=_.prev){l=e.BaseObject.borrowObject(e.AnimationFrameData),l.position=r/this._armature.frameRate,i[r]=l;for(var u=r+1,f=i.length;f>u;++u)_&&i[u]==_&&(i[u]=null)}else l=_;if(a)for(var u=0,f=a.length;f>u;++u)l.actions.push(a[u]);if(n)for(var u=0,f=n.length;f>u;++u)l.events.push(n[u]);for(var m=null,h=null,u=0,f=i.length;f>u;++u){var c=i[u];c&&h!=c?(h=c,m&&(h.prev=m,m.next=h,m.duration=h.position-m.position),m=h):i[u]=m}h.duration=this._animation.duration-h.position,h=i[0],m.next=h,h.prev=m},n._globalToLocal=function(e){for(var t=[],a=e.sortedBones.concat().reverse(),n=0,r=a.length;r>n;++n){var i=a[n];i.parent&&(i.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(i.transform.x,i.transform.y,i.transform),i.transform.rotation-=i.parent.transform.rotation);for(var o in e.animations){var s=e.animations[o],l=s.getBoneTimeline(i.name);if(l){var _=l.bone.parent?s.getBoneTimeline(l.bone.parent.name):null;t.length=0;for(var u=0,f=l.frames.length;f>u;++u){var m=l.frames[u];t.indexOf(m)>=0||(t.push(m),_?(this._getTimelineFrameMatrix(s,_,m.position,this._helpTransform),m.transform.add(l.originTransform),this._helpTransform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(m.transform.x,m.transform.y,m.transform),m.transform.rotation-=this._helpTransform.rotation):m.transform.add(l.originTransform))}t.length=0;for(var h=0,c=l.frames.length;c>h;++h){var m=l.frames[h];t.indexOf(m)>=0||(t.push(m),m.transform.minus(l.bone.transform),0==h?(l.originTransform.copyFrom(m.transform),m.transform.identity()):m.transform.minus(l.originTransform))}}}}},t.parseDragonBonesData=function(t){return e.ObjectDataParser.getInstance().parseDragonBonesData(t)},t.parseTextureAtlasData=function(a,n){void 0===n&&(n=1);for(var r={},i=a[t.SUB_TEXTURE],o=0,s=i.length;s>o;o++){var l=i[o],_=l[t.NAME],u=new e.Rectangle,f=null;u.x=l[t.X]/n,u.y=l[t.Y]/n,u.width=l[t.WIDTH]/n,u.height=l[t.HEIGHT]/n,t.FRAME_WIDTH in l&&(f=new e.Rectangle,f.x=l[t.FRAME_X]/n,f.y=l[t.FRAME_Y]/n,f.width=l[t.FRAME_WIDTH]/n,f.height=l[t.FRAME_HEIGHT]/n),r[_]={region:u,frame:f,rotated:!1}}return r},t.DATA_VERSION_2_3="2.3",t.DATA_VERSION_3_0="3.0",t.DATA_VERSION_4_0="4.0",t.DATA_VERSION="4.5",t.TEXTURE_ATLAS="TextureAtlas",t.SUB_TEXTURE="SubTexture",t.FORMAT="format",t.IMAGE_PATH="imagePath",t.WIDTH="width",t.HEIGHT="height",t.ROTATED="rotated",t.FRAME_X="frameX",t.FRAME_Y="frameY",t.FRAME_WIDTH="frameWidth",t.FRAME_HEIGHT="frameHeight",t.DRADON_BONES="dragonBones",t.ARMATURE="armature",t.BONE="bone",t.IK="ik",t.SLOT="slot",t.SKIN="skin",t.DISPLAY="display",t.ANIMATION="animation",t.FFD="ffd",t.FRAME="frame",t.PIVOT="pivot",t.TRANSFORM="transform",t.COLOR="color",t.FILTER="filter",t.VERSION="version",t.IS_GLOBAL="isGlobal",t.FRAME_RATE="frameRate",t.TYPE="type",t.NAME="name",t.PARENT="parent",t.LENGTH="length",t.DATA="data",t.DISPLAY_INDEX="displayIndex",t.Z_ORDER="z",t.BLEND_MODE="blendMode",t.INHERIT_TRANSLATION="inheritTranslation",t.INHERIT_ROTATION="inheritRotation",t.INHERIT_SCALE="inheritScale",t.TARGET="target",t.BEND_POSITIVE="bendPositive",t.CHAIN="chain",t.WEIGHT="weight",t.FADE_IN_TIME="fadeInTime",t.PLAY_TIMES="playTimes",t.SCALE="scale",t.OFFSET="offset",t.POSITION="position",t.DURATION="duration",t.TWEEN_EASING="tweenEasing",t.TWEEN_ROTATE="tweenRotate",t.TWEEN_SCALE="tweenScale",t.CURVE="curve",t.EVENT="event",t.SOUND="sound",t.ACTION="action",t.ACTIONS="actions",t.DEFAULT_ACTIONS="defaultActions",t.X="x",t.Y="y",t.SKEW_X="skX",t.SKEW_Y="skY",t.SCALE_X="scX",t.SCALE_Y="scY",t.ALPHA_OFFSET="aO",t.RED_OFFSET="rO",t.GREEN_OFFSET="gO",t.BLUE_OFFSET="bO",t.ALPHA_MULTIPLIER="aM",t.RED_MULTIPLIER="rM",t.GREEN_MULTIPLIER="gM",t.BLUE_MULTIPLIER="bM",t.UVS="uvs",t.VERTICES="vertices",t.TRIANGLES="triangles",t.WEIGHTS="weights",t.SLOT_POSE="slotPose",t.BONE_POSE="bonePose",t.TWEEN="tween",t.KEY="key",t.COLOR_TRANSFORM="colorTransform",t.TIMELINE="timeline",t.PIVOT_X="pX",t.PIVOT_Y="pY",t.LOOP="loop",t.AUTO_TWEEN="autoTween",t.HIDE="hide",t.RECTANGLE="rectangle",t.ELLIPSE="ellipse",t}();e.DataParser=t,egret.registerClass(t,"dragonBones.DataParser")}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function a(){t.call(this)}__extends(a,t);var n=(__define,a),r=n.prototype;return a._getBoolean=function(e,t,a){if(t in e){var n=e[t],r=typeof n;if("boolean"==r)return n;if("string"!=r)return Boolean(n);switch(n){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return a},a._getNumber=function(e,t,a){if(t in e){var n=e[t];return null==n||"NaN"==n?a:Number(n)}return a},a._getString=function(e,t,a){return t in e?String(e[t]):a},a._getParameter=function(e,t,a){return e&&e.length>t?e[t]:a},r._parseArmature=function(t){var n=e.BaseObject.borrowObject(e.ArmatureData);if(n.name=a._getString(t,a.NAME,null),n.frameRate=a._getNumber(t,a.FRAME_RATE,this._data.frameRate)||this._data.frameRate,a.TYPE in t&&"string"==typeof t[a.TYPE]?n.type=a._getArmatureType(t[a.TYPE]):n.type=a._getNumber(t,a.TYPE,0),this._armature=n,this._rawBones.length=0,a.BONE in t)for(var r=t[a.BONE],i=0,o=r.length;o>i;++i){var s=r[i],l=this._parseBone(s);n.addBone(l,a._getString(s,a.PARENT,null)),this._rawBones.push(l)}if(a.IK in t)for(var _=t[a.IK],i=0,o=_.length;o>i;++i)this._parseIK(_[i]);if(a.SLOT in t)for(var u=t[a.SLOT],i=0,o=u.length;o>i;++i)n.addSlot(this._parseSlot(u[i]));if(a.SKIN in t)for(var f=t[a.SKIN],i=0,o=f.length;o>i;++i)n.addSkin(this._parseSkin(f[i]));if(a.ANIMATION in t)for(var m=t[a.ANIMATION],i=0,o=m.length;o>i;++i)n.addAnimation(this._parseAnimation(m[i]));return(a.ACTIONS in t||a.DEFAULT_ACTIONS in t)&&this._parseActionData(t,n.actions,null,null),this._isParentCooriinate&&a._getBoolean(t,a.IS_GLOBAL,!0)&&this._globalToLocal(n),this._armature=null,this._rawBones.length=0,n},r._parseBone=function(t){var n=e.BaseObject.borrowObject(e.BoneData);return n.name=a._getString(t,a.NAME,null),n.inheritTranslation=a._getBoolean(t,a.INHERIT_TRANSLATION,!0),n.inheritRotation=a._getBoolean(t,a.INHERIT_ROTATION,!0),n.inheritScale=a._getBoolean(t,a.INHERIT_SCALE,!0),n.length=a._getNumber(t,a.LENGTH,0)*this._armatureScale,a.TRANSFORM in t&&this._parseTransform(t[a.TRANSFORM],n.transform),this._isParentCooriinate&&(n.inheritRotation=!0,n.inheritScale=!1),n},r._parseIK=function(e){var t=this._armature.getBone(a._getString(e,a.BONE in e?a.BONE:a.NAME,null));t&&(t.ik=this._armature.getBone(a._getString(e,a.TARGET,null)),t.bendPositive=a._getBoolean(e,a.BEND_POSITIVE,!0),t.chain=a._getNumber(e,a.CHAIN,0),t.weight=a._getNumber(e,a.WEIGHT,1),t.chain>0&&t.parent&&!t.parent.ik?(t.parent.ik=t.ik,t.parent.chainIndex=0,t.parent.chain=0,t.chainIndex=1):(t.chain=0,t.chainIndex=0))},r._parseSlot=function(t){var n=e.BaseObject.borrowObject(e.SlotData);return n.name=a._getString(t,a.NAME,null),n.parent=this._armature.getBone(a._getString(t,a.PARENT,null)),n.displayIndex=a._getNumber(t,a.DISPLAY_INDEX,0),n.zOrder=a._getNumber(t,a.Z_ORDER,this._armature.sortedSlots.length),a.COLOR in t?(n.color=e.SlotData.generateColor(),this._parseColorTransform(t[a.COLOR],n.color)):n.color=e.SlotData.DEFAULT_COLOR,a.BLEND_MODE in t&&"string"==typeof t[a.BLEND_MODE]?n.blendMode=a._getBlendMode(t[a.BLEND_MODE]):n.blendMode=a._getNumber(t,a.BLEND_MODE,0),(a.ACTIONS in t||a.DEFAULT_ACTIONS in t)&&this._parseActionData(t,n.actions,null,null),this._isParentCooriinate&&(a.COLOR_TRANSFORM in t?(n.color=e.SlotData.generateColor(),this._parseColorTransform(t[a.COLOR_TRANSFORM],n.color)):n.color=e.SlotData.DEFAULT_COLOR),n},r._parseSkin=function(t){var n=e.BaseObject.borrowObject(e.SkinData);if(n.name=a._getString(t,a.NAME,"__default")||"__default",a.SLOT in t){this._skin=n;for(var r=t[a.SLOT],i=0,o=r.length;o>i;++i)this._isParentCooriinate&&this._armature.addSlot(this._parseSlot(r[i])),n.addSlot(this._parseSlotDisplaySet(r[i]));this._skin=null}return n},r._parseSlotDisplaySet=function(t){var n=e.BaseObject.borrowObject(e.SlotDisplayDataSet);if(n.slot=this._armature.getSlot(a._getString(t,a.NAME,null)),a.DISPLAY in t){var r=t[a.DISPLAY],i=n.displays;this._slotDisplayDataSet=n;for(var o=0,s=r.length;s>o;++o)i.push(this._parseDisplay(r[o]));this._slotDisplayDataSet=null}return n},r._parseDisplay=function(t){var n=e.BaseObject.borrowObject(e.DisplayData);if(n.name=a._getString(t,a.NAME,null),a.TYPE in t&&"string"==typeof t[a.TYPE]?n.type=a._getDisplayType(t[a.TYPE]):n.type=a._getNumber(t,a.TYPE,0),n.isRelativePivot=!0,a.PIVOT in t){var r=t[a.PIVOT];n.pivot.x=a._getNumber(r,a.X,0),n.pivot.y=a._getNumber(r,a.Y,0)}else if(this._isParentCooriinate){var i=t[a.TRANSFORM];n.isRelativePivot=!1,n.pivot.x=a._getNumber(i,a.PIVOT_X,0)*this._armatureScale,n.pivot.y=a._getNumber(i,a.PIVOT_Y,0)*this._armatureScale}else n.pivot.x=.5,n.pivot.y=.5;switch(a.TRANSFORM in t&&this._parseTransform(t[a.TRANSFORM],n.transform),n.type){case 0:break;case 1:break;case 2:n.meshData=this._parseMesh(t)}return n},r._parseMesh=function(t){var n=e.BaseObject.borrowObject(e.MeshData),r=t[a.VERTICES],i=t[a.UVS],o=t[a.TRIANGLES],s=Math.floor(r.length/2),l=Math.floor(o.length/3),_=new Array(this._armature.sortedBones.length);if(n.skinned=a.WEIGHTS in t&&t[a.WEIGHTS].length>0,n.uvs.length=2*s,n.vertices.length=2*s,n.vertexIndices.length=3*l,n.skinned){if(n.boneIndices.length=s,n.weights.length=s,n.boneVertices.length=s,a.SLOT_POSE in t){var u=t[a.SLOT_POSE];n.slotPose.a=u[0],n.slotPose.b=u[1],n.slotPose.c=u[2],n.slotPose.d=u[3],n.slotPose.tx=u[4],n.slotPose.ty=u[5]}if(a.BONE_POSE in t)for(var f=t[a.BONE_POSE],m=0,h=f.length;h>m;m+=7){var c=f[m],d=_[c]=new e.Matrix;d.a=f[m+1],d.b=f[m+2],d.c=f[m+3],d.d=f[m+4],d.tx=f[m+5],d.ty=f[m+6],d.invert()}}for(var m=0,g=0,h=r.length;h>m;m+=2){var p=m+1,v=m/2,T=n.vertices[m]=r[m]*this._armatureScale,y=n.vertices[p]=r[p]*this._armatureScale;if(n.uvs[m]=i[m],n.uvs[p]=i[p],n.skinned){var D=t[a.WEIGHTS],b=D[g],E=n.boneIndices[v]=new Array(b),S=n.weights[v]=new Array(b),O=n.boneVertices[v]=new Array(2*b);n.slotPose.transformPoint(T,y,this._helpPoint),T=n.vertices[m]=this._helpPoint.x,y=n.vertices[p]=this._helpPoint.y;for(var B=0;b>B;++B){var A=g+1+2*B,c=D[A],w=this._rawBones[c],x=n.bones.indexOf(w);0>x&&(x=n.bones.length,n.bones[x]=w,n.inverseBindPose[x]=_[c]),n.inverseBindPose[x].transformPoint(T,y,this._helpPoint),E[B]=x,S[B]=D[A+1],O[2*B]=this._helpPoint.x,O[2*B+1]=this._helpPoint.y}g+=2*b+1}}for(var m=0,h=o.length;h>m;++m)n.vertexIndices[m]=o[m];return n},r._parseAnimation=function(t){var n=e.BaseObject.borrowObject(e.AnimationData);n.name=a._getString(t,a.NAME,"__default")||"__default",n.frameCount=Math.max(a._getNumber(t,a.DURATION,1),1),n.position=a._getNumber(t,a.POSITION,0)/this._armature.frameRate,n.duration=n.frameCount/this._armature.frameRate,n.playTimes=a._getNumber(t,a.PLAY_TIMES,1),n.fadeInTime=a._getNumber(t,a.FADE_IN_TIME,0),this._animation=n;var r=a._getString(t,a.ANIMATION,null);if(r)return n.animation=this._armature.getAnimation(r),!n.animation,n;if(this._parseTimeline(t,n,this._parseAnimationFrame),a.BONE in t)for(var i=t[a.BONE],o=0,s=i.length;s>o;++o)n.addBoneTimeline(this._parseBoneTimeline(i[o]));if(a.SLOT in t)for(var l=t[a.SLOT],o=0,s=l.length;s>o;++o)n.addSlotTimeline(this._parseSlotTimeline(l[o]));if(a.FFD in t)for(var _=t[a.FFD],o=0,s=_.length;s>o;++o)n.addFFDTimeline(this._parseFFDTimeline(_[o]));if(this._isParentCooriinate){if(this._isAutoTween=a._getBoolean(t,a.AUTO_TWEEN,!0),this._animationTweenEasing=a._getNumber(t,a.TWEEN_EASING,0)||0,n.playTimes=a._getNumber(t,a.LOOP,1),a.TIMELINE in t){for(var u=t[a.TIMELINE],o=0,s=u.length;s>o;++o)n.addBoneTimeline(this._parseBoneTimeline(u[o]));for(var o=0,s=u.length;s>o;++o)n.addSlotTimeline(this._parseSlotTimeline(u[o]))}}else this._isAutoTween=!1,this._animationTweenEasing=0;for(var o in this._armature.bones){var f=this._armature.bones[o];if(!n.getBoneTimeline(f.name)){var m=e.BaseObject.borrowObject(e.BoneTimelineData),h=e.BaseObject.borrowObject(e.BoneFrameData);m.bone=f,m.frames[0]=h,n.addBoneTimeline(m)}}for(var o in this._armature.slots){var c=this._armature.slots[o];if(!n.getSlotTimeline(c.name)){var d=e.BaseObject.borrowObject(e.SlotTimelineData),g=e.BaseObject.borrowObject(e.SlotFrameData);d.slot=c,g.displayIndex=c.displayIndex,c.color==e.SlotData.DEFAULT_COLOR?g.color=e.SlotFrameData.DEFAULT_COLOR:(g.color=e.SlotFrameData.generateColor(),g.color.copyFrom(c.color)),d.frames[0]=g,n.addSlotTimeline(d),this._isParentCooriinate&&(g.displayIndex=-1)}}return this._animation=null,n},r._parseBoneTimeline=function(t){var n=e.BaseObject.borrowObject(e.BoneTimelineData);n.bone=this._armature.getBone(a._getString(t,a.NAME,null)),this._parseTimeline(t,n,this._parseBoneFrame);for(var r=n.originTransform,i=null,o=0,s=n.frames.length;s>o;++o){var l=n.frames[o];i?i!=l&&l.transform.minus(r):(r.copyFrom(l.transform),l.transform.identity(),0==r.scaleX&&(r.scaleX=.001),0==r.scaleY&&(r.scaleY=.001)),i=l}return(1!=n.scale||0!=n.offset)&&(this._animation.hasAsynchronyTimeline=!0),n},r._parseSlotTimeline=function(t){var n=e.BaseObject.borrowObject(e.SlotTimelineData);return n.slot=this._armature.getSlot(a._getString(t,a.NAME,null)),this._parseTimeline(t,n,this._parseSlotFrame),(1!=n.scale||0!=n.offset)&&(this._animation.hasAsynchronyTimeline=!0),n},r._parseFFDTimeline=function(t){var n=e.BaseObject.borrowObject(e.FFDTimelineData);n.skin=this._armature.getSkin(a._getString(t,a.SKIN,null)),n.slot=n.skin.getSlot(a._getString(t,a.SLOT,null));for(var r=a._getString(t,a.NAME,null),i=0,o=n.slot.displays.length;o>i;++i){var s=n.slot.displays[i];if(s.meshData&&s.name==r){n.displayIndex=i,this._mesh=s.meshData;break}}return this._parseTimeline(t,n,this._parseFFDFrame),this._mesh=null,n},r._parseAnimationFrame=function(t,n,r){var i=e.BaseObject.borrowObject(e.AnimationFrameData);return this._parseFrame(t,i,n,r),(a.ACTION in t||a.ACTIONS in t)&&this._parseActionData(t,i.actions,null,null),(a.EVENT in t||a.SOUND in t)&&this._parseEventData(t,i.events,null,null),i},r._parseBoneFrame=function(t,n,r){var i=e.BaseObject.borrowObject(e.BoneFrameData);if(i.tweenRotate=a._getNumber(t,a.TWEEN_ROTATE,0),i.tweenScale=a._getBoolean(t,a.TWEEN_SCALE,!0),this._parseTweenFrame(t,i,n,r),a.TRANSFORM in t){var o=t[a.TRANSFORM];this._parseTransform(o,i.transform),this._isParentCooriinate&&(this._helpPoint.x=a._getNumber(o,a.PIVOT_X,0),this._helpPoint.y=a._getNumber(o,a.PIVOT_Y,0),i.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(this._helpPoint.x,this._helpPoint.y,this._helpPoint,!0),i.transform.x+=this._helpPoint.x,i.transform.y+=this._helpPoint.y)}var s=this._timeline.bone;if(a.ACTION in t||a.ACTIONS in t){var l=this._armature.getSlot(s.name),_=[];this._parseActionData(t,_,s,l),this._mergeFrameToAnimationTimeline(i,_,null)}if(a.EVENT in t||a.SOUND in t){var u=[];this._parseEventData(t,u,s,null),this._mergeFrameToAnimationTimeline(i,null,u)}return i},r._parseSlotFrame=function(t,n,r){var i=e.BaseObject.borrowObject(e.SlotFrameData);if(i.displayIndex=a._getNumber(t,a.DISPLAY_INDEX,0),this._parseTweenFrame(t,i,n,r),a.COLOR in t||a.COLOR_TRANSFORM in t?(i.color=e.SlotFrameData.generateColor(),this._parseColorTransform(t[a.COLOR]||t[a.COLOR_TRANSFORM],i.color)):i.color=e.SlotFrameData.DEFAULT_COLOR,this._isParentCooriinate)a._getBoolean(t,a.HIDE,!1)&&(i.displayIndex=-1);else if(a.ACTION in t||a.ACTIONS in t){var o=this._timeline.slot,s=[];this._parseActionData(t,s,o.parent,o),this._mergeFrameToAnimationTimeline(i,s,null)}return i},r._parseFFDFrame=function(t,n,r){var i=e.BaseObject.borrowObject(e.ExtensionFrameData);i.type=a._getNumber(t,a.TYPE,0),this._parseTweenFrame(t,i,n,r);for(var o=t[a.VERTICES],s=a._getNumber(t,a.OFFSET,0),l=0,_=0,u=0,f=this._mesh.vertices.length;f>u;u+=2)if(!o||s>u||u-s>=o.length?(l=0,_=0):(l=o[u-s]*this._armatureScale,_=o[u+1-s]*this._armatureScale),this._mesh.skinned){this._mesh.slotPose.transformPoint(l,_,this._helpPoint,!0),l=this._helpPoint.x,_=this._helpPoint.y;for(var m=this._mesh.boneIndices[u/2],h=0,c=m.length;c>h;++h){var d=m[h];this._mesh.inverseBindPose[d].transformPoint(l,_,this._helpPoint,!0),i.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else i.tweens.push(l,_);return i},r._parseTweenFrame=function(t,n,r,i){this._parseFrame(t,n,r,i),a.TWEEN_EASING in t?n.tweenEasing=a._getNumber(t,a.TWEEN_EASING,e.DragonBones.NO_TWEEN):this._isParentCooriinate&&(n.tweenEasing=this._isAutoTween?this._animationTweenEasing:e.DragonBones.NO_TWEEN),this._isParentCooriinate&&1==this._animation.scale&&1==this._timeline.scale&&n.duration*this._armature.frameRate<2&&(n.tweenEasing=e.DragonBones.NO_TWEEN),a.CURVE in t&&(n.curve=e.TweenFrameData.samplingCurve(t[a.CURVE],i))},r._parseFrame=function(e,t,a,n){t.position=a/this._armature.frameRate,t.duration=n/this._armature.frameRate},r._parseTimeline=function(t,n,r){if(n.scale=a._getNumber(t,a.SCALE,1),n.offset=a._getNumber(t,a.OFFSET,0),this._timeline=n,a.FRAME in t){var i=t[a.FRAME];if(i.length)if(1==i.length)n.frames.length=1,n.frames[0]=r.call(this,i[0],0,a._getNumber(i[0],a.DURATION,1));else{n.frames.length=this._animation.frameCount+1;for(var o=0,s=0,l=null,_=null,u=0,f=0,m=this._animation.frameCount+1;m>u;++u){if(u>=o+s&&f<i.length){var h=i[f++];o=u,s=a._getNumber(h,a.DURATION,1),l=r.call(this,h,o,s),_&&(_.next=l,l.prev=_,this._isParentCooriinate&&_ instanceof e.TweenFrameData&&-1==h[a.DISPLAY_INDEX]&&(_.tweenEasing=e.DragonBones.NO_TWEEN)),_=l}n.frames[u]=l}l.duration=this._animation.duration-l.position,l=n.frames[0],_.next=l,l.prev=_,this._isParentCooriinate&&_ instanceof e.TweenFrameData&&-1==i[0][a.DISPLAY_INDEX]&&(_.tweenEasing=e.DragonBones.NO_TWEEN)}}this._timeline=null},r._parseActionData=function(t,n,r,i){var o=t[a.ACTION]||t[a.ACTIONS]||t[a.DEFAULT_ACTIONS];if("string"==typeof o){var s=e.BaseObject.borrowObject(e.ActionData);s.type=4,s.data=[o,-1,-1],s.bone=r,s.slot=i,n.push(s)}else if(o instanceof Array)for(var l=0,_=o.length;_>l;++l){var u=o[l]instanceof Array?o[l]:null,s=e.BaseObject.borrowObject(e.ActionData),f=u?null:o[l].gotoAndPlay;if(u){var m=u[0];"string"==typeof m?s.type=a._getActionType(m):s.type=a._getParameter(u,0,4)}else s.type=2;switch(s.type){case 0:s.data=[u?a._getParameter(u,1,null):f,a._getParameter(u,2,-1)];break;case 1:s.data=[u?a._getParameter(u,1,null):f];break;case 2:s.data=[u?a._getParameter(u,1,null):f,a._getParameter(u,2,0),a._getParameter(u,3,-1)];break;case 3:s.data=[u?a._getParameter(u,1,null):f,a._getParameter(u,2,0)];break;case 4:s.data=[u?a._getParameter(u,1,null):f,a._getParameter(u,2,-1),a._getParameter(u,3,-1)];break;case 5:s.data=[u?a._getParameter(u,1,null):f,a._getParameter(u,2,0)]}s.bone=r,s.slot=i,n.push(s)}},r._parseEventData=function(t,n,r,i){if(a.SOUND in t){var o=e.BaseObject.borrowObject(e.EventData);o.type=1,o.name=t[a.SOUND],o.bone=r,o.slot=i,n.push(o)}if(a.EVENT in t){var s=e.BaseObject.borrowObject(e.EventData);s.type=0,s.name=t[a.EVENT],s.bone=r,s.slot=i,a.DATA in t&&(s.data=t[a.DATA]),n.push(s)}},r._parseTransform=function(t,n){n.x=a._getNumber(t,a.X,0)*this._armatureScale,n.y=a._getNumber(t,a.Y,0)*this._armatureScale,n.skewX=a._getNumber(t,a.SKEW_X,0)*e.DragonBones.ANGLE_TO_RADIAN,n.skewY=a._getNumber(t,a.SKEW_Y,0)*e.DragonBones.ANGLE_TO_RADIAN,n.scaleX=a._getNumber(t,a.SCALE_X,1),n.scaleY=a._getNumber(t,a.SCALE_Y,1)},r._parseColorTransform=function(e,t){t.alphaMultiplier=.01*a._getNumber(e,a.ALPHA_MULTIPLIER,100),t.redMultiplier=.01*a._getNumber(e,a.RED_MULTIPLIER,100),t.greenMultiplier=.01*a._getNumber(e,a.GREEN_MULTIPLIER,100),t.blueMultiplier=.01*a._getNumber(e,a.BLUE_MULTIPLIER,100),t.alphaOffset=a._getNumber(e,a.ALPHA_OFFSET,0),t.redOffset=a._getNumber(e,a.RED_OFFSET,0),t.greenOffset=a._getNumber(e,a.GREEN_OFFSET,0),t.blueOffset=a._getNumber(e,a.BLUE_OFFSET,0)},r.parseDragonBonesData=function(t,n){if(void 0===n&&(n=1),t){var r=a._getString(t,a.VERSION,null);if(this._isParentCooriinate=r==a.DATA_VERSION_2_3||r==a.DATA_VERSION_3_0,this._armatureScale=n,r==a.DATA_VERSION||r==a.DATA_VERSION_4_0||this._isParentCooriinate){var i=e.BaseObject.borrowObject(e.DragonBonesData);if(i.name=a._getString(t,a.NAME,null),i.frameRate=a._getNumber(t,a.FRAME_RATE,24)||24,a.ARMATURE in t){this._data=i;for(var o=t[a.ARMATURE],s=0,l=o.length;l>s;++s)i.addArmature(this._parseArmature(o[s]));this._data=null}return i}throw new Error("Nonsupport data version.")}throw new Error},r.parseTextureAtlasData=function(t,n,r){if(void 0===r&&(r=0),t){if(n.name=a._getString(t,a.NAME,null),n.imagePath=a._getString(t,a.IMAGE_PATH,null),r>0?n.scale=r:r=n.scale=a._getNumber(t,a.SCALE,n.scale),r=1/r,a.SUB_TEXTURE in t)for(var i=t[a.SUB_TEXTURE],o=0,s=i.length;s>o;++o){var l=i[o],_=n.generateTextureData();_.name=a._getString(l,a.NAME,null),_.rotated=a._getBoolean(l,a.ROTATED,!1),_.region.x=a._getNumber(l,a.X,0)*r,_.region.y=a._getNumber(l,a.Y,0)*r,_.region.width=a._getNumber(l,a.WIDTH,0)*r,_.region.height=a._getNumber(l,a.HEIGHT,0)*r;var u=a._getNumber(l,a.FRAME_WIDTH,-1),f=a._getNumber(l,a.FRAME_HEIGHT,-1);u>0&&f>0&&(_.frame=e.TextureData.generateRectangle(),_.frame.x=a._getNumber(l,a.FRAME_X,0)*r,_.frame.y=a._getNumber(l,a.FRAME_Y,0)*r,_.frame.width=u*r,_.frame.height=f*r),n.addTextureData(_)}return n}throw new Error},a.getInstance=function(){return a._instance||(a._instance=new a),a._instance},a._instance=null,a}(e.DataParser);e.ObjectDataParser=t,egret.registerClass(t,"dragonBones.ObjectDataParser")}(dragonBones||(dragonBones={}));