var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.DATA_VERSION="4.0",t.DATA_VERSION_4_5="4.5",t.PARENT_COORDINATE_DATA_VERSION="3.0",t.VERSION="4.5.10",t}();t.DragonBones=e,egret.registerClass(e,"dragonBones.DragonBones")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(t){this._animationStateCount=0,this._updateTimelineStates=!1,this._updateFFDTimelineStates=!1,this._armature=t,this._animationList=[],this._animationStateList=[],this._timeScale=1,this._isPlaying=!1,this.tweenEnabled=!0}var i=__define,a=e,n=a.prototype;return n.dispose=function(){this._armature&&(this._resetAnimationStateList(),this._animationList.length=0,this._armature=null,this._animationDataList=null,this._animationList=null,this._animationStateList=null)},n._resetAnimationStateList=function(){for(var e,i=this._animationStateList.length;i--;)e=this._animationStateList[i],e._resetTimelineStateList(),t.AnimationState._returnObject(e);this._animationStateList.length=0},n.gotoAndPlay=function(i,a,n,s,r,o,l,h,_){if(void 0===a&&(a=-1),void 0===n&&(n=-1),void 0===s&&(s=0/0),void 0===r&&(r=0),void 0===o&&(o=null),void 0===l&&(l=e.SAME_LAYER_AND_GROUP),void 0===h&&(h=!0),void 0===_&&(_=!0),!this._animationDataList)return null;for(var u,m=this._animationDataList.length;m--;)if(this._animationDataList[m].name==i){u=this._animationDataList[m];break}if(!u)return null;var f=0==this._isPlaying;this._isPlaying=!0,this._isFading=!0,a=0>a?u.fadeTime<0?.3:u.fadeTime:a;var d;d=0>n?u.scale<0?1:u.scale:1e3*n/u.duration,s=isNaN(s)?u.playTimes:s;var c;switch(l){case e.NONE:break;case e.SAME_LAYER:for(m=this._animationStateList.length;m--;)c=this._animationStateList[m],c.layer==r&&c.fadeOut(a,h);break;case e.SAME_GROUP:for(m=this._animationStateList.length;m--;)c=this._animationStateList[m],c.group==o&&c.fadeOut(a,h);break;case e.ALL:for(m=this._animationStateList.length;m--;)c=this._animationStateList[m],c.fadeOut(a,h);break;case e.SAME_LAYER_AND_GROUP:default:for(m=this._animationStateList.length;m--;)c=this._animationStateList[m],c.layer==r&&c.group==o&&c.fadeOut(a,h)}this._lastAnimationState=t.AnimationState._borrowObject(),this._lastAnimationState._layer=r,this._lastAnimationState._group=o,this._lastAnimationState.autoTween=this.tweenEnabled,this._lastAnimationState._fadeIn(this._armature,u,a,1/d,s,_),this.addState(this._lastAnimationState);var g=this._armature.getSlots(!1);for(m=g.length;m--;){var p=g[m];p.childArmature&&p.childArmature.animation.gotoAndPlay(i,a)}return f&&this._armature.advanceTime(0),this._lastAnimationState},n.gotoAndStop=function(t,i,a,n,s,r,o,l){void 0===a&&(a=-1),void 0===n&&(n=0),void 0===s&&(s=-1),void 0===r&&(r=0),void 0===o&&(o=null),void 0===l&&(l=e.ALL);var h=this.gotoAndPlay(t,n,s,0/0,r,o,l);return a>=0?h.setCurrentTime(h.totalTime*a):h.setCurrentTime(i),h.lastFrameAutoTween=!1,h.stop(),h},n.play=function(){this._animationDataList&&0!=this._animationDataList.length&&(this._lastAnimationState?this._isPlaying?this.gotoAndPlay(this._lastAnimationState.name):this._isPlaying=!0:this.gotoAndPlay(this._animationDataList[0].name))},n.stop=function(){this._isPlaying=!1},n.getState=function(t,e){void 0===e&&(e=0);for(var i=this._animationStateList.length;i--;){var a=this._animationStateList[i];if(a.name==t&&a.layer==e)return a}return null},n.hasAnimation=function(t){for(var e=this._animationDataList.length;e--;)if(this._animationDataList[e].name==t)return!0;return!1},n._advanceTime=function(t){if(this._isPlaying){this._updateTimelineStates?(this._updateTimelineStates=!1,this.updateTimelineStates()):this._updateFFDTimelineStates&&(this._updateFFDTimelineStates=!1,this.updateFFDTimelineStates());var e=!1;t*=this._timeScale;for(var i=this._animationStateList.length;i--;){var a=this._animationStateList[i];a._advanceTime(t)?this.removeState(a):1!=a.fadeState&&(e=!0)}this._isFading=e}},n.updateTimelineStates=function(){for(var t=this._animationStateList.length;t--;)this._animationStateList[t]._updateTimelineStates()},n.updateFFDTimelineStates=function(){for(var t=this._animationStateList.length;t--;)this._animationStateList[t]._updateFFDTimeline()},n.addState=function(t){this._animationStateList.indexOf(t)<0&&(this._animationStateList.unshift(t),this._animationStateCount=this._animationStateList.length)},n.removeState=function(e){var i=this._animationStateList.indexOf(e);i>=0&&(this._animationStateList.splice(i,1),t.AnimationState._returnObject(e),this._lastAnimationState==e&&(this._animationStateList.length>0?this._lastAnimationState=this._animationStateList[0]:this._lastAnimationState=null),this._animationStateCount=this._animationStateList.length)},i(n,"movementList",function(){return this._animationList}),i(n,"movementID",function(){return this.lastAnimationName}),i(n,"lastAnimationState",function(){return this._lastAnimationState}),i(n,"lastAnimationName",function(){return this._lastAnimationState?this._lastAnimationState.name:null}),i(n,"animationList",function(){return this._animationList}),i(n,"isPlaying",function(){return this._isPlaying&&!this.isComplete}),i(n,"isComplete",function(){if(this._lastAnimationState){if(!this._lastAnimationState.isComplete)return!1;for(var t=this._animationStateList.length;t--;)if(!this._animationStateList[t].isComplete)return!1;return!0}return!0}),i(n,"timeScale",function(){return this._timeScale},function(t){(isNaN(t)||0>t)&&(t=1),this._timeScale=t}),i(n,"animationDataList",function(){return this._animationDataList},function(t){this._animationDataList=t,this._animationList.length=0;for(var e=0,i=this._animationDataList.length;i>e;e++){var a=this._animationDataList[e];this._animationList[this._animationList.length]=a.name}}),e.NONE="none",e.SAME_LAYER="sameLayer",e.SAME_GROUP="sameGroup",e.SAME_LAYER_AND_GROUP="sameLayerAndGroup",e.ALL="all",e}();t.Animation=e,egret.registerClass(e,"dragonBones.Animation")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._layer=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._currentPlayTimes=0,this._totalTime=0,this._currentTime=0,this._lastTime=0,this._fadeState=0,this._playTimes=0,this._timelineStateList=[],this._slotTimelineStateList=[],this._ffdTimelineStateList=[],this._boneMasks=[]}var i=__define,a=e,n=a.prototype;return e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){t.clear(),e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t)},e._clear=function(){for(var i=e._pool.length;i--;)e._pool[i].clear();e._pool.length=0,t.TimelineState._clear()},n.clear=function(){this._resetTimelineStateList(),this._boneMasks.length=0,this._armature=null,this._clip=null},n._resetTimelineStateList=function(){for(var e=this._timelineStateList.length;e--;)t.TimelineState._returnObject(this._timelineStateList[e]);for(this._timelineStateList.length=0,e=this._slotTimelineStateList.length;e--;)t.SlotTimelineState._returnObject(this._slotTimelineStateList[e]);for(this._slotTimelineStateList.length=0,e=this._ffdTimelineStateList.length;e--;)t.FFDTimelineState._returnObject(this._ffdTimelineStateList[e]);this._ffdTimelineStateList.length=0},n.containsBoneMask=function(t){return 0==this._boneMasks.length||this._boneMasks.indexOf(t)>=0},n.addBoneMask=function(t,e){if(void 0===e&&(e=!0),this.addBoneToBoneMask(t),e){var i=this._armature.getBone(t);if(i)for(var a=this._armature.getBones(!1),n=a.length;n--;){var s=a[n];i.contains(s)&&this.addBoneToBoneMask(s.name)}}return this._updateTimelineStates(),this},n.removeBoneMask=function(t,e){if(void 0===e&&(e=!0),this.removeBoneFromBoneMask(t),e){var i=this._armature.getBone(t);if(i)for(var a=this._armature.getBones(!1),n=a.length;n--;){var s=a[n];i.contains(s)&&this.removeBoneFromBoneMask(s.name)}}return this._updateTimelineStates(),this},n.removeAllMixingTransform=function(){return this._boneMasks.length=0,this._updateTimelineStates(),this},n.addBoneToBoneMask=function(t){this._clip.getTimeline(t)&&this._boneMasks.indexOf(t)<0&&this._boneMasks.push(t)},n.removeBoneFromBoneMask=function(t){var e=this._boneMasks.indexOf(t);e>=0&&this._boneMasks.splice(e,1)},n._updateTimelineStates=function(){for(var t,e,i,a=this._timelineStateList.length;a--;)t=this._timelineStateList[a],this._armature.getBone(t.name)||this.removeTimelineState(t);for(a=this._slotTimelineStateList.length;a--;)e=this._slotTimelineStateList[a],this._armature.getSlot(e.name)||this.removeSlotTimelineState(e);if(this._boneMasks.length>0){for(a=this._timelineStateList.length;a--;)t=this._timelineStateList[a],this._boneMasks.indexOf(t.name)<0&&this.removeTimelineState(t);for(a=0,i=this._boneMasks.length;i>a;a++){var n=this._boneMasks[a];this.addTimelineState(n)}}else for(a=0,i=this._clip.timelineList.length;i>a;a++){var s=this._clip.timelineList[a];this.addTimelineState(s.name)}for(a=0,i=this._clip.slotTimelineList.length;i>a;a++){var r=this._clip.slotTimelineList[a];this.addSlotTimelineState(r.name)}this._updateFFDTimeline()},n._updateFFDTimeline=function(){var e,i,a=0,n=0,s={};for(n=this._ffdTimelineStateList.length,a=0;n>a;++a)e=this._ffdTimelineStateList[a],i=this._armature.getSlot(e.name),i&&i.displayIndex==e.displayIndex?s[e.name]=e:(this._ffdTimelineStateList.splice(a,1),t.FFDTimelineState._returnObject(o));if(this._clip.ffdTimelineList)for(n=this._clip.ffdTimelineList.length,a=0;n>a;++a){var r=this._clip.ffdTimelineList[a];if(i=this._armature.getSlot(r.name),!s[r.name]&&i&&i.displayList.length>0&&i.displayIndex>=0&&i.displayIndex==r.displayIndex){var o=t.FFDTimelineState._borrowObject();o._fadeIn(i,this,r),this._ffdTimelineStateList.push(o),s[r.name]=o}}var l=this._armature.getSlots(!1);for(a=0,n=l.length;n>a;++a)i=l[a],i._meshData&&!s[i.name]&&i._updateFFD(null,0)},n.addTimelineState=function(e){var i=this._armature.getBone(e);if(i){for(var a=0,n=this._timelineStateList.length;n>a;a++){var s=this._timelineStateList[a];if(s.name==e)return}var r=t.TimelineState._borrowObject();r._fadeIn(i,this,this._clip.getTimeline(e)),this._timelineStateList.push(r)}},n.removeTimelineState=function(e){var i=this._timelineStateList.indexOf(e);this._timelineStateList.splice(i,1),t.TimelineState._returnObject(e)},n.addSlotTimelineState=function(e){var i=this._armature.getSlot(e);if(i){for(var a=0,n=this._slotTimelineStateList.length;n>a;a++){var s=this._slotTimelineStateList[a];if(s.name==e)return}var r=t.SlotTimelineState._borrowObject();r._fadeIn(i,this,this._clip.getSlotTimeline(e)),this._slotTimelineStateList.push(r)}},n.removeSlotTimelineState=function(e){var i=this._slotTimelineStateList.indexOf(e);this._slotTimelineStateList.splice(i,1),t.SlotTimelineState._returnObject(e)},n.play=function(){return this._isPlaying=!0,this},n.stop=function(){return this._isPlaying=!1,this},n._fadeIn=function(t,e,i,a,n,s){return this._armature=t,this._clip=e,this._pausePlayheadInFade=s,this._name=this._clip.name,this._totalTime=this._clip.duration,this.autoTween=this._clip.autoTween,this.setTimeScale(a),this.setPlayTimes(n),this._isComplete=!1,this._currentFrameIndex=-1,this._currentPlayTimes=-1,Math.round(this._totalTime*this._clip.frameRate*.001)<2||a==1/0?this._currentTime=this._totalTime:this._currentTime=-1,this._time=0,this._boneMasks.length=0,this._isFadeOut=!1,this._fadeWeight=0,this._fadeTotalWeight=1,this._fadeState=-1,this._fadeCurrentTime=0,this._fadeBeginTime=this._fadeCurrentTime,this._fadeTotalTime=i*this._timeScale,this._isPlaying=!0,this.displayControl=!0,this.lastFrameAutoTween=!0,this.additiveBlending=!1,this.weight=1,this.fadeOutTime=i,this._updateTimelineStates(),this},n.fadeOut=function(t,e){if(!this._armature)return null;if((isNaN(t)||0>t)&&(t=0),this._pausePlayheadInFade=e,this._isFadeOut){if(t>this._fadeTotalTime/this._timeScale-(this._fadeCurrentTime-this._fadeBeginTime))return this}else for(var i=0,a=this._timelineStateList.length;a>i;i++){var n=this._timelineStateList[i];n._fadeOut()}return this._isFadeOut=!0,this._fadeTotalWeight=this._fadeWeight,this._fadeState=-1,this._fadeBeginTime=this._fadeCurrentTime,this._fadeTotalTime=this._fadeTotalWeight>=0?t*this._timeScale:0,this.displayControl=!1,this},n._advanceTime=function(t){return t*=this._timeScale,this.advanceFadeTime(t),this._fadeWeight&&this.advanceTimelinesTime(t),this._isFadeOut&&1==this._fadeState},n.advanceFadeTime=function(e){var i=!1,a=!1;if(this._fadeBeginTime>=0){var n=this._fadeState;this._fadeCurrentTime+=0>e?-e:e,this._fadeCurrentTime>=this._fadeBeginTime+this._fadeTotalTime?((1==this._fadeWeight||0==this._fadeWeight)&&(n=1,this._pausePlayheadInFade&&(this._pausePlayheadInFade=!1,this._currentTime=-1)),this._fadeWeight=this._isFadeOut?0:1):this._fadeCurrentTime>=this._fadeBeginTime?(n=0,this._fadeWeight=(this._fadeCurrentTime-this._fadeBeginTime)/this._fadeTotalTime*this._fadeTotalWeight,this._isFadeOut&&(this._fadeWeight=this._fadeTotalWeight-this._fadeWeight)):(n=-1,this._fadeWeight=this._isFadeOut?1:0),this._fadeState!=n&&(-1==this._fadeState&&(i=!0),1==n&&(a=!0),this._fadeState=n)}var s;i&&(this._isFadeOut?this._armature.hasEventListener(t.AnimationEvent.FADE_OUT)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_OUT),s.animationState=this,this._armature._eventList.push(s)):(this.hideBones(),this._armature.hasEventListener(t.AnimationEvent.FADE_IN)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_IN),s.animationState=this,this._armature._eventList.push(s)))),a&&(this._isFadeOut?this._armature.hasEventListener(t.AnimationEvent.FADE_OUT_COMPLETE)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_OUT_COMPLETE),s.animationState=this,this._armature._eventList.push(s)):this._armature.hasEventListener(t.AnimationEvent.FADE_IN_COMPLETE)&&(s=new t.AnimationEvent(t.AnimationEvent.FADE_IN_COMPLETE),s.animationState=this,this._armature._eventList.push(s)))},n.advanceTimelinesTime=function(e){this._isPlaying&&!this._pausePlayheadInFade&&(this._time+=e);var i=!1,a=!1,n=!1,s=!1,r=0,o=1e3*this._time;if(0==this._playTimes)s=!1,r=Math.ceil(Math.abs(o)/this._totalTime)||1,o-=o>=0?Math.floor(o/this._totalTime)*this._totalTime:Math.ceil(o/this._totalTime)*this._totalTime,0>o&&(o+=this._totalTime);else{var l=this._playTimes*this._totalTime;o>=l?(o=l,s=!0):-l>=o?(o=-l,s=!0):s=!1,0>o&&(o+=l),r=Math.ceil(o/this._totalTime)||1,o-=o>=0?Math.floor(o/this._totalTime)*this._totalTime:Math.ceil(o/this._totalTime)*this._totalTime,s&&(o=this._totalTime)}this._isComplete=s;var h=1e3*this._time/this._totalTime,_=0,u=0;for(_=0,u=this._timelineStateList.length;u>_;_++){var m=this._timelineStateList[_];m._update(h),this._isComplete=m._isComplete&&this._isComplete}for(_=0,u=this._slotTimelineStateList.length;u>_;_++){var f=this._slotTimelineStateList[_];f._update(h),this._isComplete=m._isComplete&&this._isComplete}for(_=0,u=this._ffdTimelineStateList.length;u>_;_++){var d=this._ffdTimelineStateList[_];d._update(h),this._isComplete=d._isComplete&&this._isComplete}this._currentTime!=o&&(this._currentPlayTimes!=r&&(this._currentPlayTimes>0&&r>1&&(n=!0),this._currentPlayTimes=r),this._currentTime<0&&(i=!0),this._isComplete&&(a=!0),this._lastTime=this._currentTime,this._currentTime=o,this.updateMainTimeline(s));var c;i&&this._armature.hasEventListener(t.AnimationEvent.START)&&(c=new t.AnimationEvent(t.AnimationEvent.START),c.animationState=this,this._armature._eventList.push(c)),a?(this._armature.hasEventListener(t.AnimationEvent.COMPLETE)&&(c=new t.AnimationEvent(t.AnimationEvent.COMPLETE),c.animationState=this,this._armature._eventList.push(c)),this.autoFadeOut&&this.fadeOut(this.fadeOutTime,!0)):n&&this._armature.hasEventListener(t.AnimationEvent.LOOP_COMPLETE)&&(c=new t.AnimationEvent(t.AnimationEvent.LOOP_COMPLETE),c.animationState=this,this._armature._eventList.push(c))},n.updateMainTimeline=function(t){var e=this._clip.frameList;if(e.length>0){for(var i,a,n=0,s=this._clip.frameList.length;s>n;++n){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._currentFrameIndex++,this._lastTime=this._currentTime,this._currentFrameIndex>=e.length){if(t){this._currentFrameIndex--;break}this._currentFrameIndex=0}}a=e[this._currentFrameIndex],i&&this._armature._arriveAtFrame(i,null,this,!0),this._currentFrameDuration=a.duration,this._currentFramePosition=a.position,i=a}a&&this._armature._arriveAtFrame(a,null,this,!1)}},n.hideBones=function(){for(var t=0,e=this._clip.hideTimelineNameMap.length;e>t;t++){var i=this._clip.hideTimelineNameMap[t],a=this._armature.getBone(i);a&&a._hideSlots()}var n;for(t=0,e=this._clip.hideSlotTimelineNameMap.length;e>t;t++){n=this._clip.hideSlotTimelineNameMap[t];var s=this._armature.getSlot(n);s&&s._resetToOrigin()}},n.setAdditiveBlending=function(t){return this.additiveBlending=t,this},n.setAutoFadeOut=function(t,e){return void 0===e&&(e=-1),this.autoFadeOut=t,e>=0&&(this.fadeOutTime=e*this._timeScale),this},n.setWeight=function(t){return(isNaN(t)||0>t)&&(t=1),this.weight=t,this},n.setFrameTween=function(t,e){return this.autoTween=t,this.lastFrameAutoTween=e,this},n.setCurrentTime=function(t){return(0>t||isNaN(t))&&(t=0),this._time=t,this._currentTime=1e3*this._time,this},n.setTimeScale=function(t){return(isNaN(t)||t==1/0)&&(t=1),this._timeScale=t,this},n.setPlayTimes=function(t){return void 0===t&&(t=0),Math.round(.001*this._totalTime*this._clip.frameRate)<2?this._playTimes=0>t?-1:1:this._playTimes=0>t?-t:t,this.autoFadeOut=0>t?!0:!1,this},i(n,"name",function(){return this._name}),i(n,"layer",function(){return this._layer}),i(n,"group",function(){return this._group}),i(n,"clip",function(){return this._clip}),i(n,"isComplete",function(){return this._isComplete}),i(n,"isPlaying",function(){return this._isPlaying&&!this._isComplete}),i(n,"currentPlayTimes",function(){return this._currentPlayTimes<0?0:this._currentPlayTimes}),i(n,"totalTime",function(){return.001*this._totalTime}),i(n,"currentTime",function(){return this._currentTime<0?0:.001*this._currentTime}),i(n,"fadeWeight",function(){return this._fadeWeight}),i(n,"fadeState",function(){return this._fadeState}),i(n,"fadeTotalTime",function(){return this._fadeTotalTime}),i(n,"timeScale",function(){return this._timeScale}),i(n,"playTimes",function(){return this._playTimes}),e._pool=[],e}();t.AnimationState=e,egret.registerClass(e,"dragonBones.AnimationState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.skin=null,this.name=null,this.displayIndex=0,this._isComplete=!1,this._animationState=null,this._totalTime=0,this._currentTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._tweenEasing=0/0,this._tweenCurve=null,this._tweenVertices=!1,this._offset=0,this._durationVertices=[],this._updateVertices=[],this._rawAnimationScale=1,this._updateMode=0,this._slot=null,this._timelineData=null}var i=(__define,e),a=i.prototype;return e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e._clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},a.clear=function(){this._slot=null,this._animationState=null,this._timelineData=null},a._fadeIn=function(t,e,i){switch(this._slot=t,this._animationState=e,this._timelineData=i,this.name=i.name,this.skin=i.skin,this.displayIndex=i.displayIndex,this._totalTime=this._timelineData.duration,this._rawAnimationScale=this._animationState.clip.scale,this._isComplete=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}},a._fadeOut=function(){},a._update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},a.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration))break;if(this._currentFrameIndex++,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&this.updateToNextFrame(e),this._tweenEasing==this._tweenEasing&&this.updateTween()}},a.updateToNextFrame=function(t){void 0===t&&(t=0);var e=this._currentFrameIndex+1;e>=this._timelineData.frameList.length&&(e=0);var i=this._timelineData.frameList[this._currentFrameIndex],a=this._timelineData.frameList[e],n=!1;if(0==e&&(!this._animationState.lastFrameAutoTween||this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+t-this._timelineData.offset)*this._timelineData.scale>.999999)?(this._tweenEasing=0/0,n=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=i.tweenEasing,this._tweenCurve=i.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?n=!1:(10==this._tweenEasing&&(this._tweenEasing=0),n=!0)):n=!0):(this._tweenEasing=i.tweenEasing,this._tweenCurve=i.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?n=!0:(this._tweenEasing=0/0,n=!1)),n){this._offset=i.offset<a.offset?i.offset:a.offset;var s=i.offset+i.vertices.length>a.offset+a.vertices.length?i.offset+i.vertices.length:a.offset+a.vertices.length;this._durationVertices.length=s-this._offset;var r,o;this._tweenVertices=!1;for(var l=this._offset;s>l;l++)r=0,o=0,i.offset<=l&&i.vertices.length+i.offset>l&&(r=Number(i.vertices[l-i.offset])),a.offset<=l&&a.vertices.length+a.offset>l&&(o=Number(a.vertices[l-a.offset])),this._durationVertices[l-this._offset]=o-r,0!=this._durationVertices[l-this._offset]&&(this._tweenVertices=!0)}else this._tweenVertices=!1,this._slot._updateFFD(i.vertices,i.offset)},a.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];if(this._tweenVertices&&this._animationState.displayControl){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve&&(i=this._tweenCurve.getValueByProgress(i)),this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing));var a=this._offset+this._durationVertices.length;this._updateVertices.length=this._durationVertices.length;for(var n,s=this._offset;a>s;s++)n=0,e.offset<=s&&e.vertices.length+e.offset>s&&(n=Number(e.vertices[s-e.offset])),this._updateVertices[s-this._offset]=n+this._durationVertices[s-this._offset]*i;this._slot._updateFFD(this._updateVertices,this._offset)}},a.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._isComplete=!0,this._tweenEasing=0/0,this._tweenVertices=!1,this._animationState.displayControl&&this._slot._updateFFD(t.vertices,t.offset)},e._pool=[],e}();t.FFDTimelineState=e,egret.registerClass(e,"dragonBones.FFDTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._durationColor=new t.ColorTransform}var i=(__define,e),a=i.prototype;return e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e._clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},a.clear=function(){this._slot&&(this._slot=null),this._armature=null,this._animation=null,this._animationState=null,this._timelineData=null},a._fadeIn=function(t,e,i){switch(this._slot=t,this._armature=this._slot.armature,this._animation=this._armature.animation,this._animationState=e,this._timelineData=i,this.name=i.name,this._totalTime=this._timelineData.duration,this._rawAnimationScale=this._animationState.clip.scale,this._isComplete=!1,this._blendEnabled=!1,this._tweenColor=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._weight=1,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}},a._fadeOut=function(){},a._update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},a.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration))break;if(this._currentFrameIndex++,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._slot._arriveAtFrame(s,this,this._animationState,!0),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._slot._arriveAtFrame(r,this,this._animationState,!1),this._blendEnabled=r.displayIndex>=0,this._blendEnabled?this.updateToNextFrame(e):(this._tweenEasing=0/0,this._tweenColor=!1)),this._blendEnabled&&this.updateTween()}},a.updateToNextFrame=function(t){void 0===t&&(t=0);var e=this._currentFrameIndex+1;e>=this._timelineData.frameList.length&&(e=0);var i=this._timelineData.frameList[this._currentFrameIndex],a=this._timelineData.frameList[e],n=!1;0==e&&(!this._animationState.lastFrameAutoTween||this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+t-this._timelineData.offset)*this._timelineData.scale>.999999)?(this._tweenEasing=0/0,n=!1):i.displayIndex<0||a.displayIndex<0?(this._tweenEasing=0/0,n=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=i.tweenEasing,this._tweenCurve=i.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?n=!1:(10==this._tweenEasing&&(this._tweenEasing=0),n=!0)):n=!0):(this._tweenEasing=i.tweenEasing,this._tweenCurve=i.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?n=!0:(this._tweenEasing=0/0,n=!1)),n?i.color&&a.color?(this._durationColor.alphaOffset=a.color.alphaOffset-i.color.alphaOffset,this._durationColor.redOffset=a.color.redOffset-i.color.redOffset,this._durationColor.greenOffset=a.color.greenOffset-i.color.greenOffset,this._durationColor.blueOffset=a.color.blueOffset-i.color.blueOffset,this._durationColor.alphaMultiplier=a.color.alphaMultiplier-i.color.alphaMultiplier,this._durationColor.redMultiplier=a.color.redMultiplier-i.color.redMultiplier,this._durationColor.greenMultiplier=a.color.greenMultiplier-i.color.greenMultiplier,this._durationColor.blueMultiplier=a.color.blueMultiplier-i.color.blueMultiplier,this._durationColor.alphaOffset||this._durationColor.redOffset||this._durationColor.greenOffset||this._durationColor.blueOffset||this._durationColor.alphaMultiplier||this._durationColor.redMultiplier||this._durationColor.greenMultiplier||this._durationColor.blueMultiplier?this._tweenColor=!0:this._tweenColor=!1):i.color?(this._tweenColor=!0,this._durationColor.alphaOffset=-i.color.alphaOffset,this._durationColor.redOffset=-i.color.redOffset,this._durationColor.greenOffset=-i.color.greenOffset,this._durationColor.blueOffset=-i.color.blueOffset,this._durationColor.alphaMultiplier=1-i.color.alphaMultiplier,this._durationColor.redMultiplier=1-i.color.redMultiplier,this._durationColor.greenMultiplier=1-i.color.greenMultiplier,this._durationColor.blueMultiplier=1-i.color.blueMultiplier):a.color?(this._tweenColor=!0,this._durationColor.alphaOffset=a.color.alphaOffset,this._durationColor.redOffset=a.color.redOffset,this._durationColor.greenOffset=a.color.greenOffset,this._durationColor.blueOffset=a.color.blueOffset,this._durationColor.alphaMultiplier=a.color.alphaMultiplier-1,this._durationColor.redMultiplier=a.color.redMultiplier-1,this._durationColor.greenMultiplier=a.color.greenMultiplier-1,this._durationColor.blueMultiplier=a.color.blueMultiplier-1):this._tweenColor=!1:this._tweenColor=!1,!this._tweenColor&&this._animationState.displayControl&&(i.color?this._slot._updateDisplayColor(i.color.alphaOffset,i.color.redOffset,i.color.greenOffset,i.color.blueOffset,i.color.alphaMultiplier,i.color.redMultiplier,i.color.greenMultiplier,i.color.blueMultiplier,!0):this._slot._isColorChanged&&this._slot._updateDisplayColor(0,0,0,0,1,1,1,1,!1))},a.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];if(this._tweenColor&&this._animationState.displayControl){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve?i=this._tweenCurve.getValueByProgress(i):this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing)),e.color?this._slot._updateDisplayColor(e.color.alphaOffset+this._durationColor.alphaOffset*i,e.color.redOffset+this._durationColor.redOffset*i,e.color.greenOffset+this._durationColor.greenOffset*i,e.color.blueOffset+this._durationColor.blueOffset*i,e.color.alphaMultiplier+this._durationColor.alphaMultiplier*i,e.color.redMultiplier+this._durationColor.redMultiplier*i,e.color.greenMultiplier+this._durationColor.greenMultiplier*i,e.color.blueMultiplier+this._durationColor.blueMultiplier*i,!0):this._slot._updateDisplayColor(this._durationColor.alphaOffset*i,this._durationColor.redOffset*i,this._durationColor.greenOffset*i,this._durationColor.blueOffset*i,1+this._durationColor.alphaMultiplier*i,1+this._durationColor.redMultiplier*i,1+this._durationColor.greenMultiplier*i,1+this._durationColor.blueMultiplier*i,!0)}},a.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._slot._arriveAtFrame(t,this,this._animationState,!1),this._isComplete=!0,this._tweenEasing=0/0,this._tweenColor=!1,this._blendEnabled=t.displayIndex>=0,this._blendEnabled&&this._animationState.displayControl&&(t.color?this._slot._updateDisplayColor(t.color.alphaOffset,t.color.redOffset,t.color.greenOffset,t.color.blueOffset,t.color.alphaMultiplier,t.color.redMultiplier,t.color.greenMultiplier,t.color.blueMultiplier,!0):this._slot._isColorChanged&&this._slot._updateDisplayColor(0,0,0,0,1,1,1,1,!1))},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._pool=[],e
}();t.SlotTimelineState=e,egret.registerClass(e,"dragonBones.SlotTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._lastTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._transform=new t.DBTransform,this._pivot=new t.Point,this._durationTransform=new t.DBTransform,this._durationPivot=new t.Point,this._durationColor=new t.ColorTransform}var i=(__define,e),a=i.prototype;return e._borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e._returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e._clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},a.clear=function(){this._bone&&(this._bone._removeState(this),this._bone=null),this._armature=null,this._animation=null,this._animationState=null,this._timelineData=null,this._originTransform=null,this._originPivot=null},a._fadeIn=function(t,e,i){switch(this._bone=t,this._armature=this._bone.armature,this._animation=this._armature.animation,this._animationState=e,this._timelineData=i,this._originTransform=this._timelineData.originTransform,this._originPivot=this._timelineData.originPivot,this.name=i.name,this._totalTime=this._timelineData.duration,this._rawAnimationScale=this._animationState.clip.scale,this._isComplete=!1,this._tweenTransform=!1,this._tweenScale=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._weight=1,this._transform.x=0,this._transform.y=0,this._transform.scaleX=1,this._transform.scaleY=1,this._transform.skewX=0,this._transform.skewY=0,this._pivot.x=0,this._pivot.y=0,this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.scaleX=1,this._durationTransform.scaleY=1,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationPivot.x=0,this._durationPivot.y=0,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}this._bone._addState(this)},a._fadeOut=function(){this._transform.skewX=t.TransformUtil.formatRadian(this._transform.skewX),this._transform.skewY=t.TransformUtil.formatRadian(this._transform.skewY)},a._update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},a.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=i>=0?Math.floor(i/this._totalTime)*this._totalTime:Math.ceil(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._lastTime=this._currentTime,this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._currentFrameIndex++,this._lastTime=this._currentTime,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._bone._arriveAtFrame(s,this,this._animationState,!0),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._bone._arriveAtFrame(r,this,this._animationState,!1),this.updateToNextFrame(e)),this.updateTween()}},a.updateToNextFrame=function(e){void 0===e&&(e=0);var i=this._currentFrameIndex+1;i>=this._timelineData.frameList.length&&(i=0);var a=this._timelineData.frameList[this._currentFrameIndex],n=this._timelineData.frameList[i],s=!1;0==i&&(!this._animationState.lastFrameAutoTween||this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timelineData.offset)*this._timelineData.scale>.999999)?(this._tweenEasing=0/0,s=!1):a.displayIndex<0||n.displayIndex<0?(this._tweenEasing=0/0,s=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?s=!1:(10==this._tweenEasing&&(this._tweenEasing=0),s=!0)):s=!0):(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?s=!0:(this._tweenEasing=0/0,s=!1)),s?(this._durationTransform.x=n.transform.x-a.transform.x,this._durationTransform.y=n.transform.y-a.transform.y,this._durationTransform.skewX=n.transform.skewX-a.transform.skewX,this._durationTransform.skewY=n.transform.skewY-a.transform.skewY,this._durationTransform.scaleX=n.transform.scaleX-a.transform.scaleX+n.scaleOffset.x,this._durationTransform.scaleY=n.transform.scaleY-a.transform.scaleY+n.scaleOffset.y,this._durationTransform.normalizeRotation(),0==i&&(this._durationTransform.skewX=t.TransformUtil.formatRadian(this._durationTransform.skewX),this._durationTransform.skewY=t.TransformUtil.formatRadian(this._durationTransform.skewY)),this._durationPivot.x=n.pivot.x-a.pivot.x,this._durationPivot.y=n.pivot.y-a.pivot.y,this._durationTransform.x||this._durationTransform.y||this._durationTransform.skewX||this._durationTransform.skewY||this._durationTransform.scaleX||this._durationTransform.scaleY||this._durationPivot.x||this._durationPivot.y?(this._tweenTransform=!0,this._tweenScale=a.tweenScale):(this._tweenTransform=!1,this._tweenScale=!1)):(this._tweenTransform=!1,this._tweenScale=!1),this._tweenTransform?this._tweenScale||(this._animationState.additiveBlending?(this._transform.scaleX=a.transform.scaleX,this._transform.scaleY=a.transform.scaleY):(this._transform.scaleX=this._originTransform.scaleX*a.transform.scaleX,this._transform.scaleY=this._originTransform.scaleY*a.transform.scaleY)):(this._animationState.additiveBlending?(this._transform.x=a.transform.x,this._transform.y=a.transform.y,this._transform.skewX=a.transform.skewX,this._transform.skewY=a.transform.skewY,this._transform.scaleX=a.transform.scaleX,this._transform.scaleY=a.transform.scaleY,this._pivot.x=a.pivot.x,this._pivot.y=a.pivot.y):(this._transform.x=this._originTransform.x+a.transform.x,this._transform.y=this._originTransform.y+a.transform.y,this._transform.skewX=this._originTransform.skewX+a.transform.skewX,this._transform.skewY=this._originTransform.skewY+a.transform.skewY,this._transform.scaleX=this._originTransform.scaleX*a.transform.scaleX,this._transform.scaleY=this._originTransform.scaleY*a.transform.scaleY,this._pivot.x=this._originPivot.x+a.pivot.x,this._pivot.y=this._originPivot.y+a.pivot.y),this._bone.invalidUpdate())},a.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];if(this._tweenTransform){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve?i=this._tweenCurve.getValueByProgress(i):this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing));var a=e.transform,n=e.pivot;this._animationState.additiveBlending?(this._transform.x=a.x+this._durationTransform.x*i,this._transform.y=a.y+this._durationTransform.y*i,this._transform.skewX=a.skewX+this._durationTransform.skewX*i,this._transform.skewY=a.skewY+this._durationTransform.skewY*i,this._tweenScale&&(this._transform.scaleX=a.scaleX+this._durationTransform.scaleX*i,this._transform.scaleY=a.scaleY+this._durationTransform.scaleY*i),this._pivot.x=n.x+this._durationPivot.x*i,this._pivot.y=n.y+this._durationPivot.y*i):(this._transform.x=this._originTransform.x+a.x+this._durationTransform.x*i,this._transform.y=this._originTransform.y+a.y+this._durationTransform.y*i,this._transform.skewX=this._originTransform.skewX+a.skewX+this._durationTransform.skewX*i,this._transform.skewY=this._originTransform.skewY+a.skewY+this._durationTransform.skewY*i,this._tweenScale&&(this._transform.scaleX=this._originTransform.scaleX*a.scaleX+this._durationTransform.scaleX*i,this._transform.scaleY=this._originTransform.scaleY*a.scaleY+this._durationTransform.scaleY*i),this._pivot.x=this._originPivot.x+n.x+this._durationPivot.x*i,this._pivot.y=this._originPivot.y+n.y+this._durationPivot.y*i),this._bone.invalidUpdate()}},a.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._bone._arriveAtFrame(t,this,this._animationState,!1),this._isComplete=!0,this._tweenEasing=0/0,this._tweenTransform=!1,this._tweenScale=!1,this._tweenColor=!1,this._animationState.additiveBlending?(this._transform.x=t.transform.x,this._transform.y=t.transform.y,this._transform.skewX=t.transform.skewX,this._transform.skewY=t.transform.skewY,this._transform.scaleX=t.transform.scaleX,this._transform.scaleY=t.transform.scaleY,this._pivot.x=t.pivot.x,this._pivot.y=t.pivot.y):(this._transform.x=this._originTransform.x+t.transform.x,this._transform.y=this._originTransform.y+t.transform.y,this._transform.skewX=this._originTransform.skewX+t.transform.skewX,this._transform.skewY=this._originTransform.skewY+t.transform.skewY,this._transform.scaleX=this._originTransform.scaleX*t.transform.scaleX,this._transform.scaleY=this._originTransform.scaleY*t.transform.scaleY,this._pivot.x=this._originPivot.x+t.pivot.x,this._pivot.y=this._originPivot.y+t.pivot.y),this._bone.invalidUpdate()},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._pool=[],e}();t.TimelineState=e,egret.registerClass(e,"dragonBones.TimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=-1),void 0===e&&(e=1),this._time=t>=0?t:.001*(new Date).getTime(),this._timeScale=isNaN(e)?1:e,this._animatableList=[]}var e=__define,i=t,a=i.prototype;return e(a,"time",function(){return this._time}),e(a,"timeScale",function(){return this._timeScale},function(t){(isNaN(t)||0>t)&&(t=1),this._timeScale=t}),a.contains=function(t){return this._animatableList.indexOf(t)>=0},a.add=function(t){t&&-1==this._animatableList.indexOf(t)&&this._animatableList.push(t)},a.remove=function(t){var e=this._animatableList.indexOf(t);e>=0&&(this._animatableList[e]=null)},a.clear=function(){this._animatableList.length=0},a.advanceTime=function(t){if(void 0===t&&(t=-1),0>t&&(t=.001*(new Date).getTime()-this._time),t*=this._timeScale,this._time+=t,this._length=this._animatableList.length,0!=this._length){for(this._currentIndex=0,this._i=0;this._i<this._length;this._i++)this._animatable=this._animatableList[this._i],this._animatable&&(this._currentIndex!=this._i&&(this._animatableList[this._currentIndex]=this._animatable,this._animatableList[this._i]=null),this._animatable.advanceTime(t),this._currentIndex++);if(this._currentIndex!=this._i){for(this._length=this._animatableList.length;this._i<this._length;)this._animatableList[this._currentIndex++]=this._animatableList[this._i++];this._animatableList.length=this._currentIndex}}},t.clock=new t,t}();t.WorldClock=e,egret.registerClass(e,"dragonBones.WorldClock",["dragonBones.IAnimatable"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e){void 0===e&&(e=null),t.call(this,e)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.EventDispatcher);t.EventDispatcher=e,egret.registerClass(e,"dragonBones.EventDispatcher")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){if(t.call(this),e._instance)throw new Error("Singleton already constructed!")}__extends(e,t);var i=(__define,e);i.prototype;return e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(t.EventDispatcher);t.SoundEventManager=e,egret.registerClass(e,"dragonBones.SoundEventManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){e.call(this),this._boneIKList=[],this._display=i,this._animation=new t.Animation(this),this._slotsZOrderChanged=!1,this._slotList=[],this._boneList=[],this._eventList=[],this._ikList=[],this._delayDispose=!1,this._lockDispose=!1,this._armatureData=null}__extends(i,e);var a=__define,n=i,s=n.prototype;return a(s,"armatureData",function(){return this._armatureData}),a(s,"display",function(){return this._display}),s.getDisplay=function(){return this._display},a(s,"animation",function(){return this._animation}),s.dispose=function(){if(this._delayDispose=!0,this._animation&&!this._lockDispose){this.userData=null,this._animation.dispose();for(var t=this._slotList.length;t--;)this._slotList[t].dispose();for(t=this._boneList.length;t--;)this._boneList[t].dispose();for(t=this._ikList.length;t--;)this._ikList[t].dispose();this._armatureData=null,this._animation=null,this._slotList=null,this._boneList=null,this._eventList=null,this._ikList=null}},s.invalidUpdate=function(t){if(void 0===t&&(t=null),t){var e=this.getBone(t);e&&e.invalidUpdate()}else for(var i=this._boneList.length;i--;)this._boneList[i].invalidUpdate()},s.advanceTime=function(e){this._lockDispose=!0,this._animation._advanceTime(e),e*=this._animation.timeScale,this._isFading=this._animation._isFading;var i,a,n,s=this._boneIKList.length;for(this._i=0;this._i<s;this._i++)for(a=0,n=this._boneIKList[this._i].length;n>a;a++)if(i=this._boneIKList[this._i][a],i.isIKConstraint){var r=this._ikList[this._i-1];r.bones[0].name==i.name&&(i._update(this._isFading),i.rotationIK=i.global.rotation,r.bones.length>1&&(r.bones[1]._update(this._isFading),r.bones[1].rotationIK=r.bones[1].global.rotation),r.compute()),i.adjustGlobalTransformMatrixByIK()}else i._update(this._isFading),i.rotationIK=i.global.rotation;for(this._i=this._slotList.length;this._i--;)if(this._tmpSlot=this._slotList[this._i],this._tmpSlot._update(),this._tmpSlot._isShowDisplay){var o=this._tmpSlot.childArmature;o&&o.advanceTime(e)}if(this._slotsZOrderChanged&&(this.updateSlotsZOrder(),this.hasEventListener(t.ArmatureEvent.Z_ORDER_UPDATED)&&this.dispatchEvent(new t.ArmatureEvent(t.ArmatureEvent.Z_ORDER_UPDATED))),this._eventList.length>0){for(this._i=0,this._len=this._eventList.length;this._i<this._len;this._i++){var l=this._eventList[this._i];this.dispatchEvent(l)}this._eventList.length=0}this._lockDispose=!1,this._delayDispose&&this.dispose()},s.resetAnimation=function(){this.animation.stop(),this.animation._resetAnimationStateList();for(var t=0,e=this._boneList.length;e>t;t++)this._boneList[t]._removeAllStates()},s.getSlots=function(t){return void 0===t&&(t=!0),t?this._slotList.concat():this._slotList},s.getSlot=function(t){for(var e=this._slotList.length,i=0;e>i;i++){var a=this._slotList[i];if(a.name==t)return a}return null},s.getSlotByDisplay=function(t){if(t)for(var e=this._slotList.length,i=0;e>i;i++){var a=this._slotList[i];if(a.display==t)return a}return null},s.addSlot=function(t,e){var i=this.getBone(e);if(!i)throw new Error;i.addSlot(t)},s.removeSlot=function(t){if(!t||t.armature!=this)throw new Error;t.parent.removeSlot(t)},s.removeSlotByName=function(t){var e=this.getSlot(t);return e&&this.removeSlot(e),e},s.getBones=function(t){return void 0===t&&(t=!0),t?this._boneList.concat():this._boneList},s.getBone=function(t){for(var e=this._boneList.length,i=0;e>i;i++){var a=this._boneList[i];if(a.name==t)return a}return null},s.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},s.addBone=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1);var a;if(e&&(a=this.getBone(e),!a))throw new Error;a?a.addChildBone(t,i):(t.parent&&t.parent.removeChildBone(t,i),t._setArmature(this),i||this._updateAnimationAfterBoneListChanged())},s.removeBone=function(t,e){if(void 0===e&&(e=!1),!t||t.armature!=this)throw new Error;t.parent?t.parent.removeChildBone(t,e):(t._setArmature(null),e||this._updateAnimationAfterBoneListChanged(!1))},s.removeBoneByName=function(t){var e=this.getBone(t);return e&&this.removeBone(e),e},s._addBoneToBoneList=function(t){this._boneList.indexOf(t)<0&&(this._boneList[this._boneList.length]=t)},s._removeBoneFromBoneList=function(t){var e=this._boneList.indexOf(t);e>=0&&this._boneList.splice(e,1)},s._addSlotToSlotList=function(t){this._slotList.indexOf(t)<0&&(this._slotList[this._slotList.length]=t)},s._removeSlotFromSlotList=function(t){var e=this._slotList.indexOf(t);e>=0&&this._slotList.splice(e,1)},s.updateSlotsZOrder=function(){this._slotList.sort(this.sortSlot);for(var t=this._slotList.length;t--;){var e=this._slotList[t];e._isShowDisplay&&e._addDisplayToContainer(this._display)}this._slotsZOrderChanged=!1},s._updateAnimationAfterBoneListChanged=function(t){void 0===t&&(t=!0),t&&this.sortBoneList(),this._animation._updateTimelineStates=!0},s.sortBoneList=function(){var e=this._boneList.length;if(0!=e){for(var i=[];e--;){for(var a=0,n=this._boneList[e],s=n;s;)a++,s=s.parent;i[e]=[a,n]}for(i.sort(t.ArmatureData.sortBoneDataHelpArrayDescending),e=i.length;e--;)this._boneList[e]=i[e][1];i.length=0}},s._arriveAtFrame=function(e,a,n,s){if(e.event&&this.hasEventListener(t.FrameEvent.ANIMATION_FRAME_EVENT)){var r=new t.FrameEvent(t.FrameEvent.ANIMATION_FRAME_EVENT);r.animationState=n,r.frameLabel=e.event,this._eventList.push(r)}if(e.sound&&i._soundManager.hasEventListener(t.SoundEvent.SOUND)){var o=new t.SoundEvent(t.SoundEvent.SOUND);o.armature=this,o.animationState=n,o.sound=e.sound,i._soundManager.dispatchEvent(o)}e.action&&n.displayControl&&this.animation.gotoAndPlay(e.action)},s.sortSlot=function(t,e){return t.zOrder<e.zOrder?1:-1},s.getAnimation=function(){return this._animation},s.getIKs=function(t){return void 0===t&&(t=!0),t?this._ikList.concat():this._ikList},s.buildIK=function(){var e;this._ikList.length=0;for(var i=0,a=this._armatureData.ikDataList.length;a>i;i++)e=this._armatureData.ikDataList[i],this._ikList.push(new t.IKConstraint(e,this))},s.updateBoneCache=function(){this._boneList.reverse();var t,e,i,a,n={},s=this._ikList.length,r=s+1;for(this._boneIKList=[];this._boneIKList.length<r;)this._boneIKList[this._boneIKList.length]=[];for(n[this._boneList[0].name]=0,t=0,e=this._ikList.length;e>t;t++)n[this._ikList[t].bones[0].name]=t+1;t:for(t=0,e=this._boneList.length;e>t;t++)for(i=this._boneList[t],a=i;a;){if(null==a.parent&&(n[a.name]=0),n.hasOwnProperty(a.name)){this._boneIKList[n[a.name]].push(i);continue t}a=a.parent}},s.getIKTargetData=function(t){for(var e,i=[],a=0,n=this._ikList.length;n>a;a++)e=this._ikList[a],t.name==e.target.name&&i.push(e);return i},i._soundManager=t.SoundEventManager.getInstance(),i}(t.EventDispatcher);t.Armature=e,egret.registerClass(e,"dragonBones.Armature",["dragonBones.IAnimatable"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var e=(__define,t),i=e.prototype;return i.invert=function(){var t=this.a,e=this.b,i=this.c,a=this.d,n=this.tx,s=t*a-e*i;this.a=a/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-a*n)/s,this.ty=-(t*this.ty-e*n)/s},i.concat=function(t){var e=t.a,i=t.b,a=t.c,n=t.d,s=this.tx,r=this.ty;if(1!=e||0!=i||0!=a||1!=n){var o=this.a,l=this.b,h=this.c,_=this.d;this.a=o*e+l*a,this.b=o*i+l*n,this.c=h*e+_*a,this.d=h*i+_*n}this.tx=s*e+r*a+t.tx,this.ty=s*i+r*n+t.ty},i.copyFrom=function(t){this.tx=t.tx,this.ty=t.ty,this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d},i.transformPoint=function(t,e,i,a){void 0===a&&(a=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,a||(i.x+=this.tx,i.y+=this.ty)},t}();t.Matrix=e,egret.registerClass(e,"dragonBones.Matrix")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1}var i=__define,a=e,n=a.prototype;return i(n,"rotation",function(){return this.skewX},function(t){this.skewX=this.skewY=t}),n.copy=function(t){this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY},n.add=function(t){this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY},n.minus=function(t){this.x-=t.x,this.y-=t.y,this.skewX-=t.skewX,this.skewY-=t.skewY,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY},n.normalizeRotation=function(){this.skewX=t.TransformUtil.normalizeRotation(this.skewX),this.skewY=t.TransformUtil.normalizeRotation(this.skewY)},n.clone=function(){var t=new e;return t.copy(this),t},n.toString=function(){var t="x:"+this.x+" y:"+this.y+" skewX:"+this.skewX+" skewY:"+this.skewY+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY;return t},e}();t.DBTransform=e,egret.registerClass(e,"dragonBones.DBTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._globalTransformMatrix=new t.Matrix,this._global=new t.DBTransform,this._origin=new t.DBTransform,this._offset=new t.DBTransform,this._offset.scaleX=this._offset.scaleY=1,this._visible=!0,this._armature=null,this._parent=null,this.userData=null,this.inheritRotation=!0,this.inheritScale=!0,this.inheritTranslation=!0}var i=__define,a=e,n=a.prototype;return i(n,"global",function(){return this._global}),i(n,"origin",function(){return this._origin}),i(n,"offset",function(){return this._offset}),i(n,"armature",function(){return this._armature}),n._setArmature=function(t){this._armature=t},i(n,"parent",function(){return this._parent}),n._setParent=function(t){this._parent=t},n.dispose=function(){this.userData=null,this._globalTransformMatrix=null,this._global=null,this._origin=null,this._offset=null,this._armature=null,this._parent=null},n._calculateRelativeParentTransform=function(){},n._calculateParentTransform=function(){if(this.parent&&(this.inheritTranslation||this.inheritRotation||this.inheritScale)){var e=this._parent._globalTransformForChild,i=this._parent._globalTransformMatrixForChild;return t.ParentTransformObject.create().setTo(e,i)}return t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix),null},n._updateGlobal=function(){this._calculateRelativeParentTransform();var e=this._calculateParentTransform();if(null!=e){var i=e.parentGlobalTransformMatrix,a=e.parentGlobalTransform,n=this._global.x,s=this._global.y;this._global.x=i.a*n+i.c*s+i.tx,this._global.y=i.d*s+i.b*n+i.ty,this.inheritRotation&&(this._global.skewX+=a.skewX,this._global.skewY+=a.skewY),this.inheritScale&&(this._global.scaleX*=a.scaleX,this._global.scaleY*=a.scaleY)}return t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix),e},e._tempParentGlobalTransformMatrix=new t.Matrix,e._tempParentGlobalTransform=new t.DBTransform,e}();t.DBObject=e,egret.registerClass(e,"dragonBones.DBObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.applyOffsetTranslationToChild=!0,this.applyOffsetRotationToChild=!0,this.applyOffsetScaleToChild=!1,this.isIKConstraint=!1,this.childrenBones=[],this._needUpdate=0,this._tween=new t.DBTransform,this._tweenPivot=new t.Point,this._tween.scaleX=this._tween.scaleY=1,this._boneList=[],this._slotList=[],this._timelineStateList=[],this._needUpdate=2,this._isColorChanged=!1}__extends(i,e);var a=__define,n=i,s=n.prototype;return i.initWithBoneData=function(t){var e=new i;return e.name=t.name,e.length=t.length,e.inheritRotation=t.inheritRotation,e.inheritScale=t.inheritScale,e.origin.copy(t.transform),e},s.dispose=function(){if(this._boneList){e.prototype.dispose.call(this);for(var t=this._boneList.length;t--;)this._boneList[t].dispose();for(t=this._slotList.length;t--;)this._slotList[t].dispose();this._tween=null,this._tweenPivot=null,this._boneList=null,this._slotList=null,this._timelineStateList=null}},s.contains=function(t){if(!t)throw new Error;if(t==this)return!1;for(var e=t;e!=this&&null!=e;)e=e.parent;return e==this},s.addChildBone=function(t,e){if(void 0===e&&(e=!1),!t)throw new Error;if(t==this||t.contains(this))throw new Error;if(t.parent!=this){t.parent&&t.parent.removeChildBone(t,e),this._boneList[this._boneList.length]=t,t._setParent(this),t._setArmature(this._armature);var i=this.childrenBones.indexOf(t);0>i&&this.childrenBones.push(t),this._armature&&!e&&this._armature._updateAnimationAfterBoneListChanged()}},s.removeChildBone=function(t,e){if(void 0===e&&(e=!1),!t)throw new Error;var i=this._boneList.indexOf(t);if(0>i)throw new Error;this._boneList.splice(i,1),t._setParent(null),t._setArmature(null);var a=this.childrenBones.indexOf(t);a>=0&&this.childrenBones.splice(a,1),this._armature&&!e&&this._armature._updateAnimationAfterBoneListChanged(!1)},s.addSlot=function(t){if(!t)throw new Error;t.parent&&t.parent.removeSlot(t),this._slotList[this._slotList.length]=t,t._setParent(this),t.setArmature(this._armature)},s.removeSlot=function(t){if(!t)throw new Error;var e=this._slotList.indexOf(t);if(0>e)throw new Error;this._slotList.splice(e,1),t._setParent(null),t.setArmature(null)},s._setArmature=function(t){if(this._armature!=t){this._armature&&(this._armature._removeBoneFromBoneList(this),this._armature._updateAnimationAfterBoneListChanged(!1)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this);for(var e=this._boneList.length;e--;)this._boneList[e]._setArmature(this._armature);for(e=this._slotList.length;e--;)this._slotList[e].setArmature(this._armature)}},s.getBones=function(t){return void 0===t&&(t=!0),t?this._boneList.concat():this._boneList},s.getSlots=function(t){return void 0===t&&(t=!0),t?this._slotList.concat():this._slotList},s.invalidUpdate=function(){this._needUpdate=2,this.operationInvalidUpdate(this);var t,e;for(t=0,e=this.childrenBones.length;e>t;t++)2!=this.childrenBones[t]._needUpdate&&(this.operationInvalidUpdate(this.childrenBones[t]),this.childrenBones[t].invalidUpdate())},s.operationInvalidUpdate=function(t){var e,i,a,n,s,r,o=this.armature.getIKTargetData(t);for(e=0,i=o.length;i>e;e++)for(s=o[e],a=0,n=s.bones.length;n>a;a++)r=s.bones[a],2!=r._needUpdate&&r.invalidUpdate()},s._calculateRelativeParentTransform=function(){this._global.scaleX=this._origin.scaleX*this._tween.scaleX*this._offset.scaleX,this._global.scaleY=this._origin.scaleY*this._tween.scaleY*this._offset.scaleY,this._global.skewX=this._origin.skewX+this._tween.skewX+this._offset.skewX,this._global.skewY=this._origin.skewY+this._tween.skewY+this._offset.skewY,this._global.x=this._origin.x+this._tween.x+this._offset.x,this._global.y=this._origin.y+this._tween.y+this._offset.y},s._update=function(t){void 0===t&&(t=!1),this._needUpdate--,(t||this._needUpdate>0||this._parent&&this._parent._needUpdate>0)&&(this._needUpdate=1,this.updataLocalTransform(),this.updateGlobalTransform())},s.updataLocalTransform=function(){this.blendingTimeline(),this._calculateRelativeParentTransform()},s.updateGlobalTransform=function(){var e,i,a=this._updateGlobal();a&&(e=a.parentGlobalTransform,i=a.parentGlobalTransformMatrix,a.release());var n=0!=this._offset.x||0!=this._offset.y,s=1!=this._offset.scaleX||1!=this._offset.scaleY,r=0!=this._offset.skewX||0!=this._offset.skewY;n&&!this.applyOffsetTranslationToChild||s&&!this.applyOffsetScaleToChild||r&&!this.applyOffsetRotationToChild?(this._tempGlobalTransformForChild||(this._tempGlobalTransformForChild=new t.DBTransform),this._globalTransformForChild=this._tempGlobalTransformForChild,this._tempGlobalTransformMatrixForChild||(this._tempGlobalTransformMatrixForChild=new t.Matrix),this._globalTransformMatrixForChild=this._tempGlobalTransformMatrixForChild,this._globalTransformForChild.x=this._origin.x+this._tween.x,this._globalTransformForChild.y=this._origin.y+this._tween.y,this._globalTransformForChild.scaleX=this._origin.scaleX*this._tween.scaleX,this._globalTransformForChild.scaleY=this._origin.scaleY*this._tween.scaleY,this._globalTransformForChild.skewX=this._origin.skewX+this._tween.skewX,this._globalTransformForChild.skewY=this._origin.skewY+this._tween.skewY,this.applyOffsetTranslationToChild&&(this._globalTransformForChild.x+=this._offset.x,this._globalTransformForChild.y+=this._offset.y),this.applyOffsetScaleToChild&&(this._globalTransformForChild.scaleX*=this._offset.scaleX,this._globalTransformForChild.scaleY*=this._offset.scaleY),this.applyOffsetRotationToChild&&(this._globalTransformForChild.skewX+=this._offset.skewX,this._globalTransformForChild.skewY+=this._offset.skewY),t.TransformUtil.transformToMatrix(this._globalTransformForChild,this._globalTransformMatrixForChild),i&&(this._globalTransformMatrixForChild.concat(i),t.TransformUtil.matrixToTransform(this._globalTransformMatrixForChild,this._globalTransformForChild,this._globalTransformForChild.scaleX*e.scaleX>=0,this._globalTransformForChild.scaleY*e.scaleY>=0))):(this._globalTransformForChild=this._global,this._globalTransformMatrixForChild=this._globalTransformMatrix)},s._updateColor=function(t,e,i,a,n,s,r,o,l){for(var h=this._slotList.length,_=0;h>_;_++){var u=this._slotList[_];u._updateDisplayColor(t,e,i,a,n,s,r,o)}this._isColorChanged=l},s.adjustGlobalTransformMatrixByIK=function(){this.parent&&(this.updataLocalTransform(),this._global.rotation=this.rotationIK-this.parentBoneRotation,this.updateGlobalTransform())},s._hideSlots=function(){for(var t=this._slotList.length,e=0;t>e;e++){var i=this._slotList[e];i._changeDisplay(-1)}},s._arriveAtFrame=function(e,a,n,s){var r=n.displayControl&&(!this.displayController||this.displayController==n.name)&&n.containsBoneMask(this.name);if(r){var o,l=e;l.displayIndex;if(e.event&&this._armature.hasEventListener(t.FrameEvent.BONE_FRAME_EVENT)){var h=new t.FrameEvent(t.FrameEvent.BONE_FRAME_EVENT);h.bone=this,h.animationState=n,h.frameLabel=e.event,this._armature._eventList.push(h)}if(e.sound&&i._soundManager.hasEventListener(t.SoundEvent.SOUND)){var _=new t.SoundEvent(t.SoundEvent.SOUND);_.armature=this._armature,_.animationState=n,_.sound=e.sound,i._soundManager.dispatchEvent(_)}if(e.action)for(var u=this._slotList.length,m=0;u>m;m++){o=this._slotList[m];var f=o.childArmature;f&&f.animation.gotoAndPlay(e.action)}}},s._updateGlobal=function(){if(!this._armature._skewEnable)return e.prototype._updateGlobal.call(this);var i=this._calculateParentTransform();if(null!=i&&i.parentGlobalTransformMatrix&&i.parentGlobalTransform){var a=i.parentGlobalTransformMatrix,n=i.parentGlobalTransform,s=this._global.scaleX*n.scaleX>0,r=this._global.scaleY*n.scaleY>0,o=(this._global.rotation,this._global.scaleX,this._global.scaleY,this.parentBoneRotation);this._localTransform=this._global,this.inheritScale&&!this.inheritRotation&&0!=o&&(this._localTransform=this._localTransform.clone(),this._localTransform.rotation-=o),t.TransformUtil.transformToMatrix(this._localTransform,this._globalTransformMatrix),this._globalTransformMatrix.concat(a),this.inheritScale?t.TransformUtil.matrixToTransform(this._globalTransformMatrix,this._global,s,r):(t.TransformUtil.matrixToTransformPosition(this._globalTransformMatrix,this._global),this._global.scaleX=this._localTransform.scaleX,this._global.scaleY=this._localTransform.scaleY,this._global.rotation=this._localTransform.rotation+(this.inheritRotation?o:0),t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix))}return i},s._addState=function(t){this._timelineStateList.indexOf(t)<0&&(this._timelineStateList.push(t),this._timelineStateList.sort(this.sortState))},s._removeState=function(t){var e=this._timelineStateList.indexOf(t);e>=0&&this._timelineStateList.splice(e,1)},s._removeAllStates=function(){this._timelineStateList.length=0},s.blendingTimeline=function(){var t,e,i,a,n=this._timelineStateList.length;if(1==n)t=this._timelineStateList[0],a=t._animationState.weight*t._animationState.fadeWeight,t._weight=a,e=t._transform,i=t._pivot,this._tween.x=e.x*a,this._tween.y=e.y*a,this._tween.skewX=e.skewX*a,this._tween.skewY=e.skewY*a,this._tween.scaleX=1+(e.scaleX-1)*a,this._tween.scaleY=1+(e.scaleY-1)*a,this._tweenPivot.x=i.x*a,this._tweenPivot.y=i.y*a;
else if(n>1){for(var s=0,r=0,o=0,l=0,h=1,_=1,u=0,m=0,f=1,d=0,c=this._timelineStateList[n-1]._animationState.layer,g=0;n--;){if(t=this._timelineStateList[n],g=t._animationState.layer,c!=g){if(d>=f){t._weight=0;break}f-=d}c=g,a=t._animationState.weight*t._animationState.fadeWeight*f,t._weight=a,a&&(e=t._transform,i=t._pivot,s+=e.x*a,r+=e.y*a,o+=e.skewX*a,l+=e.skewY*a,h+=(e.scaleX-1)*a,_+=(e.scaleY-1)*a,u+=i.x*a,m+=i.y*a,d+=a)}this._tween.x=s,this._tween.y=r,this._tween.skewX=o,this._tween.skewY=l,this._tween.scaleX=h,this._tween.scaleY=_,this._tweenPivot.x=u,this._tweenPivot.y=m}},s.sortState=function(t,e){return t._animationState.layer<e._animationState.layer?-1:1},a(s,"childArmature",function(){return this.slot?this.slot.childArmature:null}),a(s,"display",function(){return this.slot?this.slot.display:null},function(t){this.slot&&(this.slot.display=t)}),a(s,"node",function(){return this._offset}),a(s,"visible",void 0,function(t){if(this._visible!=t){this._visible=t;for(var e=this._slotList.length,i=0;e>i;i++){var a=this._slotList[i];a._updateDisplayVisible(this._visible)}}}),a(s,"slot",function(){return this._slotList.length>0?this._slotList[0]:null}),a(s,"parentBoneRotation",function(){return this.parent?this.parent.rotationIK:0}),i._soundManager=t.SoundEventManager.getInstance(),i}(t.DBObject);t.Bone=e,egret.registerClass(e,"dragonBones.Bone")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(t,e){this.animationCacheBend=0,this.animationCacheWeight=-1,this.ikdata=t,this.armature=e,this.weight=t.weight,this.bendDirection=t.bendPositive?1:-1,this.bones=[];var i;t.chain&&(i=e.getBone(t.bones).parent,i.isIKConstraint=!0,this.bones.push(i)),i=e.getBone(t.bones),i.isIKConstraint=!0,this.bones.push(i),this.target=e.getBone(t.target)}var i=(__define,e),a=i.prototype;return a.dispose=function(){},a.compute=function(){switch(this.bones.length){case 1:var t=this.animationCacheWeight>=0?this.animationCacheWeight:this.weight;this.compute1(this.bones[0],this.target,t);break;case 2:var e=0!=this.animationCacheBend?this.animationCacheBend:this.bendDirection,i=this.animationCacheWeight>=0?this.animationCacheWeight:this.weight,a=this.compute2(this.bones[0],this.bones[1],this.target.global.x,this.target.global.y,e,i);this.bones[0].rotationIK=this.bones[0].origin.rotation+(a.x-this.bones[0].origin.rotation)*i+this.bones[0].parent.rotationIK,this.bones[1].rotationIK=this.bones[1].origin.rotation+(a.y-this.bones[1].origin.rotation)*i+this.bones[0].rotationIK}},a.compute1=function(t,e,i){var a=(t.inheritRotation&&null!=t.parent?t.parent.global.rotation:0,t.global.rotation),n=Math.atan2(e.global.y-t.global.y,e.global.x-t.global.x);t.rotationIK=a+(n-a)*i},a.compute2=function(e,i,a,n,s,r){if(0==r)return new t.Point(e.global.rotation,i.global.rotation);var o=new t.Point,l=new t.Point(e.global.x,e.global.y),h=new t.Point(i.global.x,i.global.y),_=new t.Matrix;t.TransformUtil.transformToMatrix(e.parent.global,_),_.invert();var u=t.TransformUtil.applyMatrixToPoint(new t.Point(a,n),_,!0);a=u.x,n=u.y,l=t.TransformUtil.applyMatrixToPoint(l,_,!0),h=t.TransformUtil.applyMatrixToPoint(h,_,!0);var m,f,d=e.origin.scaleX,c=e.origin.scaleY,g=i.origin.scaleX,p=h.x-l.x,T=h.y-l.y,v=Math.sqrt(p*p+T*T),D=1,y=0,A=0;0>d?(d=-d,y=Math.PI,D=-1):(y=0,D=1),0>c&&(c=-c,D=-D),0>g?(g=-g,A=Math.PI):A=0,s=D*s;t:if(Math.abs(d-c)<=.001){var b=i.length,C=b*g;a-=l.x,n-=l.y;var w=2*v*C,L=(a*a+n*n-v*v-C*C)/w;-1>L?L=-1:L>1&&(L=1),f=Math.acos(L)*s;var S=v+C*L,E=C*Math.sin(f);m=Math.atan2(n*S-a*E,a*S+n*E)}else{var M=v,x=a-l.x,B=n-l.y,F=i.length*i.origin.scaleX,O=d*F,I=c*F,P=Math.atan2(B,x),N=O*O,k=I*I,V=M*M,R=x*x+B*B,Y=k*V+N*R-N*k,X=-2*k*M,U=k-N,G=X*X-4*U*Y;if(G>=0){var K=Math.sqrt(G);0>X&&(K=-K),K=-(X+K)/2;var W=K/U,H=Y/K,Z=Math.abs(W)<Math.abs(H)?W:H;if(R>=Z*Z){var j=Math.sqrt(R-Z*Z)*s;m=P-Math.atan2(j,Z),f=Math.atan2(j/c,(Z-M)/d);break t}}var z=0,q=Number.MAX_VALUE,$=0,J=0,Q=0,te=0,ee=0,ie=0,ae=M+O,ne=ae*ae;ne>te&&(Q=0,te=ne,ee=ae),ae=M-O,ne=ae*ae,q>ne&&(z=Math.PI,q=ne,$=ae);var se=Math.acos(-O*M/(N-k));ae=O*Math.cos(se)+M;var re=I*Math.sin(se);ne=ae*ae+re*re,q>ne&&(z=se,q=ne,$=ae,J=re),ne>te&&(Q=se,te=ne,ee=ae,ie=re),(q+te)/2>=R?(m=P-Math.atan2(J*s,$),f=z*s):(m=P-Math.atan2(ie*s,ee),f=Q*s)}var oe=i.origin.x,le=i.origin.y*c,he=Math.atan2(le,oe)*D;return o.x=m-he+y,o.y=(f+he)*D+A,this.normalize(o.x),this.normalize(o.y),o},a.normalize=function(t){t>Math.PI?t-=2*Math.PI:t<-Math.PI&&(t+=2*Math.PI)},e}();t.IKConstraint=e,egret.registerClass(e,"dragonBones.IKConstraint")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.isMeshEnabled=!1,this._currentDisplayIndex=0,this._ffdChanged=!1,this._ffdVertices=null,this._meshBones=null,this._meshData=null,this._ffdOffset=0,this._displayList=[],this._currentDisplayIndex=-1,this._originZOrder=0,this._tweenZOrder=0,this._offsetZOrder=0,this._isShowDisplay=!1,this._colorTransform=new t.ColorTransform,this._displayDataList=null,this._currentDisplay=null,this.inheritRotation=!0,this.inheritScale=!0}__extends(i,e);var a=__define,n=i,s=n.prototype;return a(s,"displayIndex",function(){return this._currentDisplayIndex}),s.initWithSlotData=function(t){this.name=t.name,this.blendMode=t.blendMode,this._defaultGotoAndPlay=t.gotoAndPlay,this._originZOrder=t.zOrder,this._displayDataList=t.displayDataList,this._originDisplayIndex=t.displayIndex},s.dispose=function(){this._displayList&&(e.prototype.dispose.call(this),this._displayList.length=0,this._displayDataList=null,this._displayList=null,this._currentDisplay=null)},s.setArmature=function(t){this._armature!=t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._armature?(this._armature._addSlotToSlotList(this),this._armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this._armature.display)):this._removeDisplayFromContainer())},s._update=function(){if(this._parent._needUpdate>0||this._needUpdate||this._ffdChanged||this.isMeshUpdate()){var t=this._updateGlobal();t&&t.release(),this._updateTransform(),this._meshData&&this._updateMesh(),this._needUpdate=!1}},s.isMeshUpdate=function(){if(this._meshData&&this._meshBones.length)for(var t=0,e=this._meshBones.length;e>t;++t){var i=this._meshBones[t];if(i._needUpdate>0)return!0}return!1},s._calculateRelativeParentTransform=function(){this._global.scaleX=this._origin.scaleX*this._offset.scaleX,this._global.scaleY=this._origin.scaleY*this._offset.scaleY,this._global.skewX=this._origin.skewX+this._offset.skewX,this._global.skewY=this._origin.skewY+this._offset.skewY,this._global.x=this._origin.x+this._offset.x+this._parent._tweenPivot.x,this._global.y=this._origin.y+this._offset.y+this._parent._tweenPivot.y},s.updateChildArmatureAnimation=function(){if(this.childArmature)if(this._isShowDisplay){var t=this._gotoAndPlay;null==t&&(t=this._defaultGotoAndPlay,null==t&&this.childArmature.armatureData.defaultAnimation),null==t&&this._armature&&this._armature.animation.lastAnimationState&&(t=this._armature.animation.lastAnimationState.name),t&&this.childArmature.animation.hasAnimation(t)?this.childArmature.animation.gotoAndPlay(t):this.childArmature.animation.play()}else this.childArmature.animation.stop(),this.childArmature.animation._lastAnimationState=null},s._changeDisplay=function(e){if(void 0===e&&(e=0),0>e)this._isShowDisplay&&(this._isShowDisplay=!1,this._removeDisplayFromContainer(),this.updateChildArmatureAnimation(),this._armature.animation._updateFFDTimelineStates=!0);else if(this._displayList.length>0){var i=this._displayList.length;e>=i&&(e=i-1),this._currentDisplayIndex!=e?(this._isShowDisplay=!0,this._currentDisplayIndex=e,this._updateSlotDisplay(),this.updateChildArmatureAnimation(),this._displayDataList&&this._displayDataList.length>0&&this._currentDisplayIndex<this._displayDataList.length&&this._origin.copy(this._displayDataList[this._currentDisplayIndex].transform),this._needUpdate=!0,this._armature.animation._updateFFDTimelineStates=!0):this._isShowDisplay||(this._isShowDisplay=!0,this._armature&&(this._armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this._armature.display)),this.updateChildArmatureAnimation(),this._armature.animation._updateFFDTimelineStates=!0)}if(this._currentDisplayIndex>=0&&this._armature.animation._updateFFDTimelineStates){var a=this._displayDataList[this._currentDisplayIndex];if(a.type==t.DisplayData.MESH?this._meshData=a:this._meshData=null,this._meshData){this._meshBones?this._meshBones.length=this._meshData.bones.length:this._meshBones=[];for(var n=0,s=this._meshData.bones.length;s>n;++n){var r=this._meshData.bones[n];this._meshBones[n]=this._armature.getBone(r.name)}}else this._ffdVertices&&(this._ffdVertices.length=0),this._meshBones&&(this._meshBones.length=0)}},s._updateSlotDisplay=function(){var e=-1;this._currentDisplay&&(e=this._getDisplayIndex(),this._removeDisplayFromContainer());var i=this._displayList[this._currentDisplayIndex];i?i instanceof t.Armature?this._currentDisplay=i.display:this._currentDisplay=i:this._currentDisplay=null,this._updateDisplay(this._currentDisplay),this._currentDisplay&&(this._armature&&this._isShowDisplay&&(0>e?(this._armature._slotsZOrderChanged=!0,this._addDisplayToContainer(this._armature.display)):this._addDisplayToContainer(this._armature.display,e)),this._updateDisplayBlendMode(this._blendMode),this._updateDisplayColor(this._colorTransform.alphaOffset,this._colorTransform.redOffset,this._colorTransform.greenOffset,this._colorTransform.blueOffset,this._colorTransform.alphaMultiplier,this._colorTransform.redMultiplier,this._colorTransform.greenMultiplier,this._colorTransform.blueMultiplier,!0),this._updateDisplayVisible(this._visible),this._updateTransform())},a(s,"visible",void 0,function(t){this._visible!=t&&(this._visible=t,this._updateDisplayVisible(this._visible))}),a(s,"displayList",function(){return this._displayList},function(t){if(!t)throw new Error;this._currentDisplayIndex<0&&(this._currentDisplayIndex=0);for(var e=this._displayList.length=t.length;e--;)this._displayList[e]=t[e];var i=this._currentDisplayIndex;this._currentDisplayIndex=-1,this._changeDisplay(i)}),a(s,"display",function(){return this._currentDisplay},function(t){this._currentDisplayIndex<0&&(this._currentDisplayIndex=0),this._displayList[this._currentDisplayIndex]!=t&&(this._displayList[this._currentDisplayIndex]=t,this._updateSlotDisplay(),this.updateChildArmatureAnimation(),this._updateTransform())}),s.getDisplay=function(){return this.display},s.setDisplay=function(t){this.display=t},a(s,"childArmature",function(){return this._displayList[this._currentDisplayIndex]instanceof t.Armature?this._displayList[this._currentDisplayIndex]:null},function(t){this.display=t}),a(s,"zOrder",function(){return this._originZOrder+this._tweenZOrder+this._offsetZOrder},function(t){this.zOrder!=t&&(this._offsetZOrder=t-this._originZOrder-this._tweenZOrder,this._armature&&(this._armature._slotsZOrderChanged=!0))}),a(s,"blendMode",function(){return this._blendMode},function(t){this._blendMode!=t&&(this._blendMode=t,this._updateDisplayBlendMode(this._blendMode))}),a(s,"gotoAndPlay",void 0,function(t){this._gotoAndPlay!=t&&(this._gotoAndPlay=t,this.updateChildArmatureAnimation())}),s._updateDisplay=function(t){throw new Error("")},s._getDisplayIndex=function(){throw new Error(egret.getString(4001))},s._addDisplayToContainer=function(t,e){throw void 0===e&&(e=-1),new Error(egret.getString(4001))},s._removeDisplayFromContainer=function(){throw new Error(egret.getString(4001))},s._updateTransform=function(){throw new Error(egret.getString(4001))},s._updateDisplayVisible=function(t){throw new Error(egret.getString(4001))},s._updateFFD=function(t,e){this._ffdChanged=!0,this._ffdVertices=t,this._ffdOffset=e},s._updateDisplayColor=function(t,e,i,a,n,s,r,o,l){void 0===l&&(l=!1),this._colorTransform.alphaOffset=t,this._colorTransform.redOffset=e,this._colorTransform.greenOffset=i,this._colorTransform.blueOffset=a,this._colorTransform.alphaMultiplier=n,this._colorTransform.redMultiplier=s,this._colorTransform.greenMultiplier=r,this._colorTransform.blueMultiplier=o,this._isColorChanged=l},s._updateDisplayBlendMode=function(t){throw new Error("Abstract method needs to be implemented in subclass!")},s._arriveAtFrame=function(t,e,i,a){var n=i.displayControl&&i.containsBoneMask(this.parent.name);if(n){var s=t,r=s.displayIndex;this._changeDisplay(r),this._updateDisplayVisible(s.visible),r>=0&&(isNaN(s.zOrder)||s.zOrder==this._tweenZOrder||(this._tweenZOrder=s.zOrder,this._armature._slotsZOrderChanged=!0)),t.action?this.childArmature&&this.childArmature.animation.gotoAndPlay(t.action):this.gotoAndPlay=s.gotoAndPlay}},s._updateGlobal=function(){this._calculateRelativeParentTransform(),t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix);var e=this._calculateParentTransform();return e&&(this._globalTransformMatrix.concat(e.parentGlobalTransformMatrix),t.TransformUtil.matrixToTransform(this._globalTransformMatrix,this._global,this._global.scaleX*e.parentGlobalTransform.scaleX>=0,this._global.scaleY*e.parentGlobalTransform.scaleY>=0)),e},s._resetToOrigin=function(){this._changeDisplay(this._originDisplayIndex),this._updateDisplayColor(0,0,0,0,1,1,1,1,!0)},s._updateMesh=function(){},i}(t.DBObject);t.Slot=e,egret.registerClass(e,"dragonBones.Slot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.slotTimelineCacheList=[],this.slotTimelineCacheDic={},this.frameNum=0,this._cahceList=[]}var i=(__define,e),a=i.prototype;return e.initWithAnimationData=function(i,a){var n=new e;n.name=i.name;for(var s,r,o,l,h=0,_=a.boneDataList.length;_>h;h++){s=a.boneDataList[h].name;for(var u=0,m=a.slotDataList.length;m>u;u++)r=a.slotDataList[u],l=r.name,r.parent==s&&null==n.slotTimelineCacheDic[l]&&(o=new t.SlotTimelineCache,o.name=l,n.slotTimelineCacheList.push(o),n.slotTimelineCacheDic[l]=o)}return n},a.initSlotTimelineCacheDic=function(t,e){var i;for(var a in this.slotTimelineCacheDic){var n=this.slotTimelineCacheDic[a];i=n.name,n.cacheGenerator=t[i],n.currentFrameCache=e[i]}},a.bindCacheUserSlotDic=function(t){for(var e in t)this.slotTimelineCacheDic[e].bindCacheUser(t[e])},a.addFrame=function(t,e){for(var i,a=0,n=this.slotTimelineCacheList.length;n>a;a++)i=this.slotTimelineCacheList[a],i.addFrame(t,e);this._cahceList[t]=!0},a.update=function(t){for(var e,i=Math.floor(t*(this.frameNum-1)),a=0,n=this.slotTimelineCacheList.length;n>a;a++)e=this.slotTimelineCacheList[a],e.update(i)},e}();t.AnimationCache=e,egret.registerClass(e,"dragonBones.AnimationCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.animationCacheDic={},this.slotFrameCacheDic={}}var i=(__define,e),a=i.prototype;return e.initWithArmatureData=function(t,i){void 0===i&&(i=0);var a=new e;if(a.armatureData=t,0>=i){var n=t.animationDataList[0];n&&(a.frameRate=n.frameRate)}else a.frameRate=i;return a},a.initAllAnimationCache=function(){for(var e=this.armatureData.animationDataList.length,i=0;e>i;i++){var a=this.armatureData.animationDataList[i];this.animationCacheDic[a.name]=t.AnimationCache.initWithAnimationData(a,this.armatureData)}},a.initAnimationCache=function(e){this.animationCacheDic[e]=t.AnimationCache.initWithAnimationData(this.armatureData.getAnimationData(e),this.armatureData)},a.bindCacheUserArmatures=function(t){for(var e=t.length,i=0;e>i;i++){var a=t[i];this.bindCacheUserArmature(a)}},a.bindCacheUserArmature=function(t){t.animation.animationCacheManager=this},a.setCacheGeneratorArmature=function(e){this.cacheGeneratorArmature=e;var i;for(var a in e._slotDic)i=e._slotDic[a],this.slotFrameCacheDic[i.name]=new t.SlotFrameCache;for(var n in this.animationCacheDic){var s=this.animationCacheDic[n];s.initSlotTimelineCacheDic(e._slotDic,this.slotFrameCacheDic)}},a.generateAllAnimationCache=function(t){for(var e in this.animationCacheDic){var i=this.animationCacheDic[e];this.generateAnimationCache(i.name,t)}},a.generateAnimationCache=function(t,e){var i=this.cacheGeneratorArmature.enableCache;this.cacheGeneratorArmature.enableCache=!1;var a=this.animationCacheDic[t];if(a){var n=this.cacheGeneratorArmature.getAnimation().animationState,s=1/this.frameRate;e?this.cacheGeneratorArmature.getAnimation().gotoAndPlay(t,0,-1,0):this.cacheGeneratorArmature.getAnimation().gotoAndPlay(t,0,-1,1);var r=this.cacheGeneratorArmature.enableEventDispatch;this.cacheGeneratorArmature.enableEventDispatch=!1;var o;do o=n.progress,this.cacheGeneratorArmature.advanceTime(s);while(n.progress>=o&&n.progress<1);this.cacheGeneratorArmature.enableEventDispatch=r,this.resetCacheGeneratorArmature(),this.cacheGeneratorArmature.enableCache=i}},a.resetCacheGeneratorArmature=function(){this.cacheGeneratorArmature.resetAnimation()},a.getAnimationCache=function(t){return this.animationCacheDic[t]},e}();t.AnimationCacheManager=e,egret.registerClass(e,"dragonBones.AnimationCacheManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.globalTransform=new t.DBTransform,this.globalTransformMatrix=new t.Matrix}var i=(__define,e),a=i.prototype;return a.copy=function(t){this.globalTransform=t.globalTransform,this.globalTransformMatrix=t.globalTransformMatrix},a.clear=function(){this.globalTransform=e.ORIGIN_TRAMSFORM,this.globalTransformMatrix=e.ORIGIN_MATRIX},e.ORIGIN_TRAMSFORM=new t.DBTransform,e.ORIGIN_MATRIX=new t.Matrix,e}();t.FrameCache=e,egret.registerClass(e,"dragonBones.FrameCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.displayIndex=-1}__extends(e,t);var i=(__define,e),a=i.prototype;return a.copy=function(e){t.prototype.copy.call(this,e),this.colorTransform=e.colorTransform,this.displayIndex=e.displayIndex,this.gotoAndPlay=e.gotoAndPlay},a.clear=function(){t.prototype.clear.call(this),this.colorTransform=null,this.displayIndex=-1,this.gotoAndPlay=null},e}(t.FrameCache);t.SlotFrameCache=e,egret.registerClass(e,"dragonBones.SlotFrameCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.frameCacheList=new Array}var e=(__define,t),i=e.prototype;return i.addFrame=function(t,e){},i.update=function(t){void 0===t&&(t=0),this.currentFrameCache.copy(this.frameCacheList[t])},i.bindCacheUser=function(t){t.frameCache=this.currentFrameCache},t}();t.TimelineCache=e,egret.registerClass(e,"dragonBones.TimelineCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var a=(__define,i),n=a.prototype;return n.addFrame=function(e,i){var a=new t.SlotFrameCache,n=i.getSlot(this.name);n.global!=n._globalBackup?(a.globalTransform=n.global,a.globalTransformMatrix=n.globalTransformMatrix):(a.globalTransform.copy(n.global),a.globalTransformMatrix.copyFrom(n.globalTransformMatrix)),n.colorChanged&&(a.colorTransform=t.ColorTransformUtil.cloneColor(n.colorTransform)),a.displayIndex=n.displayIndex,a.gotoAndPlay=n.gotoAndPlay,this.frameCacheList[e]=a},i}(t.TimelineCache);t.SlotTimelineCache=e,egret.registerClass(e,"dragonBones.SlotTimelineCache")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i,a){void 0===i&&(i=!1),void 0===a&&(a=!1),t.call(this,e,i,a)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Event);t.Event=e,egret.registerClass(e,"dragonBones.Event")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1),t.call(this,e)}__extends(e,t);var i=__define,a=e,n=a.prototype;return i(e,"MOVEMENT_CHANGE",function(){return e.FADE_IN}),i(n,"movementID",function(){return this.animationName}),i(n,"armature",function(){return this.target}),i(n,"animationName",function(){return this.animationState.name}),e.FADE_IN="fadeIn",e.FADE_OUT="fadeOut",e.START="start",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT_COMPLETE="fadeOutComplete",e}(t.Event);t.AnimationEvent=e,egret.registerClass(e,"dragonBones.AnimationEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e);i.prototype;return e.Z_ORDER_UPDATED="zOrderUpdated",e}(t.Event);t.ArmatureEvent=e,egret.registerClass(e,"dragonBones.ArmatureEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1),t.call(this,e)}__extends(e,t);var i=__define,a=e,n=a.prototype;return i(e,"MOVEMENT_FRAME_EVENT",function(){return e.ANIMATION_FRAME_EVENT}),i(n,"armature",function(){return this.target}),e.ANIMATION_FRAME_EVENT="animationFrameEvent",e.BONE_FRAME_EVENT="boneFrameEvent",e}(t.Event);t.FrameEvent=e,egret.registerClass(e,"dragonBones.FrameEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1),t.call(this,e)}__extends(e,t);var i=(__define,e);i.prototype;return e.SOUND="sound",e}(t.Event);t.SoundEvent=e,egret.registerClass(e,"dragonBones.SoundEvent")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this.dragonBonesDataDic={},this.textureAtlasDic={}}__extends(a,e);var n=(__define,a),s=n.prototype;return s.dispose=function(t){if(void 0===t&&(t=!0),t){for(var e in this.dragonBonesDataDic)this.dragonBonesDataDic[e].dispose(),delete this.dragonBonesDataDic[e];for(var i in this.textureAtlasDic){var a=this.textureAtlasDic[i];if(a)for(var n=0,s=a.length;s>n;n++)a[n].dispose();delete this.textureAtlasDic[i]}}this.dragonBonesDataDic=null,this.textureAtlasDic=null},s.getDragonBonesData=function(t){return this.dragonBonesDataDic[t]},s.getSkeletonData=function(t){return this.getDragonBonesData(t)},s.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(e=e||t.name,!e)throw new Error(egret.getString(4002));this.dragonBonesDataDic[e]=t},s.addSkeletonData=function(t,e){void 0===e&&(e=null),this.addDragonBonesData(t,e)},s.removeDragonBonesData=function(t){delete this.dragonBonesDataDic[t]},s.removeSkeletonData=function(t){delete this.dragonBonesDataDic[t]},s.getTextureAtlas=function(t){return this.textureAtlasDic[t]},s.addTextureAtlas=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(!e&&t.hasOwnProperty("name")&&(e=t.name),!e)throw new Error(egret.getString(4002));var i=this.textureAtlasDic[e];null==i&&(i=[],this.textureAtlasDic[e]=i),-1==i.indexOf(t)&&i.push(t)},s.removeTextureAtlas=function(t){delete this.textureAtlasDic[t]},s.getTextureDisplay=function(t,e,i,a){void 0===e&&(e=null),void 0===i&&(i=0/0),void 0===a&&(a=0/0);var n,s,r,o;if(e){if(s=this.textureAtlasDic[e])for(r=0,o=s.length;o>r&&(n=s[r],!n.getRegion(t));r++)n=null}else for(e in this.textureAtlasDic)if(s=this.textureAtlasDic[e]){for(r=0,o=s.length;o>r&&(n=s[r],!n.getRegion(t));r++)n=null;if(null!=n)break}if(!n)return null;if(isNaN(i)||isNaN(a)){var l=this.dragonBonesDataDic[e];if(l=l?l:this.findFirstDragonBonesData()){var h=l.getDisplayDataByName(t);h&&(i=h.pivot.x,a=h.pivot.y)}}return this._generateDisplay(n,t,i,a)},s.getMeshDisplay=function(t,e,i){void 0===i&&(i=null);var a,n,s,r,o=t.name;if(i){if(n=this.textureAtlasDic[i])for(s=0,r=n.length;r>s&&(a=n[s],!a.getRegion(o));s++)a=null}else for(i in this.textureAtlasDic)if(n=this.textureAtlasDic[i]){for(s=0,r=n.length;r>s&&(a=n[s],!a.getRegion(o));s++)a=null;if(null!=a)break}return a?this._generateMesh(a,o,t,e):null},s.buildArmature=function(t,e,i,a){void 0===e&&(e=null),void 0===i&&(i=null),void 0===a&&(a=null);var n={};this.fillBuildArmatureDataPackageArmatureInfo(t,e,n),null==i&&(i=n.dragonBonesDataName);var s=n.dragonBonesData,r=n.armatureData;return r?this.buildArmatureUsingArmatureDataFromTextureAtlas(s,r,i,a):null},s.buildFastArmature=function(t,e,a,n){void 0===e&&(e=null),void 0===a&&(a=null),void 0===n&&(n=null);var s=new i;this.fillBuildArmatureDataPackageArmatureInfo(t,e,s),null==a&&(a=s.dragonBonesDataName);var r=s.dragonBonesData,o=s.armatureData;return o?this.buildFastArmatureUsingArmatureDataFromTextureAtlas(r,o,a,n):null},s.buildArmatureUsingArmatureDataFromTextureAtlas=function(t,e,i,a){void 0===a&&(a=null);var n=this._generateArmature();return n.name=e.name,n.__dragonBonesData=t,n._armatureData=e,n._skewEnable=t.version>=4.5,n.animation.animationDataList=e.animationDataList,this._buildBones(n),n.buildIK(),n.updateBoneCache(),this._buildSlots(n,a,i),n.advanceTime(0),n},s.buildFastArmatureUsingArmatureDataFromTextureAtlas=function(t,e,i,a){void 0===a&&(a=null);var n=this._generateFastArmature();return n.name=e.name,n.__dragonBonesData=t,n._armatureData=e,n._skewEnable=t.version>=4.5,n.animation.animationDataList=e.animationDataList,this._buildFastBones(n),n.buildIK(),n.updateBoneCache(),this._buildFastSlots(n,a,i),n.updateSlotsZOrder(),n.advanceTime(0),n},s.copyAnimationsToArmature=function(e,i,a,n){void 0===a&&(a=null),void 0===n&&(n=!0);var s={};if(!this.fillBuildArmatureDataPackageArmatureInfo(i,a,s))return!1;var r=s.armatureData;e.animation.animationDataList=r.animationDataList;for(var o,l,h,_,u,m,f=r.getSkinData(""),d=e.getSlots(!1),c=0,g=d.length,p=0;g>p;p++){h=d[p],_=h.displayList,c=_.length;for(var T=0;c>T;T++)u=_[T],u instanceof t.Armature&&(m=u,o=f.getSlotData(h.name),l=o.displayDataList[T],l.type==t.DisplayData.ARMATURE&&this.copyAnimationsToArmature(m,l.name,s.dragonBonesDataName,n))}return!0},s.fillBuildArmatureDataPackageArmatureInfo=function(t,e,i){if(e)return i.dragonBonesDataName=e,i.dragonBonesData=this.dragonBonesDataDic[e],i.armatureData=i.dragonBonesData.getArmatureDataByName(t),!0;for(e in this.dragonBonesDataDic)if(i.dragonBonesData=this.dragonBonesDataDic[e],i.armatureData=i.dragonBonesData.getArmatureDataByName(t),i.armatureData)return i.dragonBonesDataName=e,!0;return!1},s.fillBuildArmatureDataPackageTextureInfo=function(t,e){e.textureAtlas=this.textureAtlasDic[t?t:e.dragonBonesDataName]},s.findFirstDragonBonesData=function(){for(var t in this.dragonBonesDataDic){var e=this.dragonBonesDataDic[t];if(e)return e}return null},s.findFirstTextureAtlas=function(){for(var t in this.textureAtlasDic){var e=this.textureAtlasDic[t];if(e)return e}return null},s._buildBones=function(e){for(var i,a,n,s=e.armatureData.boneDataList,r=0;r<s.length;r++)i=s[r],a=t.Bone.initWithBoneData(i),n=i.parent,n&&null==e.armatureData.getBoneData(n)&&(n=null),e.addBone(a,n,!0);e._updateAnimationAfterBoneListChanged()},s._buildSlots=function(e,i,a){var n=e.armatureData.getSkinData(i);if(n){e.armatureData.setSkinData(i);for(var s,r,o,l=[],h=e.armatureData.slotDataList,_=0;_<h.length;_++)if(s=h[_],o=e.getBone(s.parent)){r=this._generateSlot(),r.initWithSlotData(s),o.addSlot(r),l.length=0;for(var u=s.displayDataList.length;u--;){var m=s.displayDataList[u];switch(m.type){case t.DisplayData.ARMATURE:var f=this.buildArmatureUsingArmatureDataFromTextureAtlas(e.__dragonBonesData,e.__dragonBonesData.getArmatureDataByName(m.name),a,i);l[u]=f;break;case t.DisplayData.MESH:l[u]=this.getMeshDisplay(m,r,a);break;case t.DisplayData.IMAGE:default:l[u]=this.getTextureDisplay(m.name,a,m.pivot.x,m.pivot.y)}}for(var d=0,c=l.length;c>d;d++){var g=l[d];if(g&&(g instanceof t.Armature&&(g=g.display),g.hasOwnProperty("name")))try{g.name=r.name}catch(p){}}r.displayList=l,r._changeDisplay(s.displayIndex)}}},s._buildFastBones=function(e){for(var i,a,n=e.armatureData.boneDataList,s=0;s<n.length;s++)i=n[s],a=t.FastBone.initWithBoneData(i),e.addBone(a,i.parent)},s._buildFastSlots=function(e,i,a){var n=e.armatureData.getSkinData(i);if(n){e.armatureData.setSkinData(i);for(var s,r,o=e.armatureData.slotDataList,l=[],h=[],_=0;_<o.length;_++){l.length=0,h.length=0,s=o[_],r=this._generateFastSlot(),r.initWithSlotData(s);for(var u=s.displayDataList.length;u--;){var m=s.displayDataList[u];switch(m.type){case t.DisplayData.ARMATURE:var f=this.buildFastArmatureUsingArmatureDataFromTextureAtlas(e.__dragonBonesData,e.__dragonBonesData.getArmatureDataByName(m.name),a,i);l[u]=[m,null],h[u]=f,r.hasChildArmature=!0;break;case t.DisplayData.IMAGE:case t.DisplayData.MESH:l[u]=[m,this.getTextureData(m.name,a)],h[u]=r._rawDisplay;break;default:l[u]=[m,null],h[u]=null}}for(var d=h.length,c=0;d>c;c++){var g=h[c];if(g&&(g instanceof t.FastArmature&&(g=g.display),g.hasOwnProperty("name")))try{g.name=r.name}catch(p){}}e.addSlot(r,s.parent),r.displayDataList=l,r.displayList=h,r.displayIndex=s.displayIndex}}},s.getTextureData=function(t,e){var i=null,a=null,n=this.textureAtlasDic[e];if(n)for(var s in n)if(a=n[s],i=a.getTextureData(t)){i.textureAtlas=a;break}return i},s._generateArmature=function(){return null},s._generateSlot=function(){return null},s._generateFastArmature=function(){return null},s._generateFastSlot=function(){return null},s._generateDisplay=function(t,e,i,a){return null},s._generateMesh=function(t,e,i,a){return null},a._helpMatrix=new t.Matrix,a}(t.EventDispatcher);t.BaseFactory=e,egret.registerClass(e,"dragonBones.BaseFactory");var i=function(){function t(){}var e=(__define,t);e.prototype;return t}();t.BuildArmatureDataPackage=i,egret.registerClass(i,"dragonBones.BuildArmatureDataPackage")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){e.call(this),this.isCacheManagerExclusive=!1,this._cacheFrameIndex=-1,this._boneIKList=[],this._enableEventDispatch=!0,this._useCache=!0,this._isFrameCached=!1,this._display=i,this._animation=new t.FastAnimation(this),this._slotsZOrderChanged=!1,this._armatureData=null,this.boneList=[],this._boneDic={},this.slotList=[],this._slotDic={},this.slotHasChildArmatureList=[],this._eventList=[],this._ikList=[],this._delayDispose=!1,this._lockDispose=!1}__extends(i,e);var a=__define,n=i,s=n.prototype;return s.dispose=function(){if(this._delayDispose=!0,this._animation&&!this._lockDispose){this.userData=null,this._animation.dispose();for(var t=this.slotList.length;t--;)this.slotList[t].dispose();for(t=this.boneList.length;t--;)this.boneList[t].dispose();for(t=this._ikList.length;t--;)this._ikList[t].dispose();this.slotList.length=0,this.boneList.length=0,this._armatureData=null,this._animation=null,this.slotList=null,this.boneList=null,this._eventList=null,this._ikList=null}},s.advanceTime=function(t){this._lockDispose=!0,this._isFrameCached=!1,this._animation.advanceTime(t);var e,i,a,n,s=0,r=this._boneIKList.length;if(this._isFrameCached)for(this._useCache||(this._useCache=!0),s=this.slotList.length;s--;)i=this.slotList[s],i.updateByCache(this._cacheFrameIndex);else{for(this._useCache&&(this._useCache=!1),s=0;r>s;s++)for(a=0,n=this._boneIKList[s].length;n>a;a++)if(e=this._boneIKList[s][a],e.isIKConstraint){var o=this._ikList[s-1];o.bones[0].name==e.name&&(e.update(),e.rotationIK=e.global.rotation,o.bones.length>1&&(o.bones[1].update(),o.bones[1].rotationIK=o.bones[1].global.rotation),o.compute()),e.adjustGlobalTransformMatrixByIK()}else e.update(),e.rotationIK=e.global.rotation;for(s=this.slotList.length;s--;)i=this.slotList[s],i._update()}for(s=this.slotHasChildArmatureList.length;s--;){i=this.slotHasChildArmatureList[s];var l=i.childArmature;l&&l.advanceTime(t)}if(this._slotsZOrderChanged&&this.updateSlotsZOrder(),!this._isFrameCached){var h=this._animation.animationState.animationCache;h&&h.addFrame(this._cacheFrameIndex,this)}for(;this._eventList.length>0;)this.dispatchEvent(this._eventList.shift());this._lockDispose=!1,this._delayDispose&&this.dispose()},s.enableAnimationCache=function(e,i,a){void 0===i&&(i=null),void 0===a&&(a=!0);var n=this._armatureData._cacheManager;return n?(this.enableCache=!0,n):(this._armatureData._cacheManager=n=t.AnimationCacheManager.initWithArmatureData(this.armatureData,e),n.initAllAnimationCache(),this.enableCache=!0,n)},s.getBone=function(t){return this._boneDic[t]},s.getSlot=function(t){return this._slotDic[t]},s.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},s.getSlotByDisplay=function(t){if(t)for(var e=0,i=this.slotList.length;i>e;e++)if(this.slotList[e].display==t)return this.slotList[e];
return null},s.getSlots=function(t){return void 0===t&&(t=!0),t?this.slotList.concat():this.slotList},s._updateBonesByCache=function(){for(var t,e=this.boneList.length;e--;)t=this.boneList[e],t.update()},s.addBone=function(t,e){void 0===e&&(e=null);var i;e&&(i=this.getBone(e),i.boneList.push(t)),t.armature=this,t.parentBoneData=i,this.boneList.unshift(t),this._boneDic[t.name]=t},s.addSlot=function(t,e){var i=this.getBone(e);if(!i)throw new Error;t.armature=this,t.setParent(i),i.slotList.push(t),t._addDisplayToContainer(this.display),this.slotList.push(t),this._slotDic[t.name]=t,t.hasChildArmature&&this.slotHasChildArmatureList.push(t)},s.updateSlotsZOrder=function(){this.slotList.sort(this.sortSlot);for(var t=this.slotList.length;t--;){var e=this.slotList[t];(e._frameCache&&e._frameCache.displayIndex>=0||!e._frameCache&&e.displayIndex>=0)&&e._addDisplayToContainer(this._display)}this._slotsZOrderChanged=!1},s.sortBoneList=function(){var e=this.boneList.length;if(0!=e){for(var i=[];e--;){for(var a=0,n=this.boneList[e],s=n;s;)a++,s=s.parent;i[e]=[a,n]}for(i.sort(t.ArmatureData.sortBoneDataHelpArrayDescending),e=i.length;e--;)this.boneList[e]=i[e][1];i.length=0}},s.arriveAtFrame=function(e,i){if(e.event&&this.hasEventListener(t.FrameEvent.ANIMATION_FRAME_EVENT)){var a=new t.FrameEvent(t.FrameEvent.ANIMATION_FRAME_EVENT);a.animationState=i,a.frameLabel=e.event,a.bone=e.bone?this.getBone(e.bone):null,this._addEvent(a)}e.action&&this.animation.gotoAndPlay(e.action)},s.invalidUpdate=function(t){if(void 0===t&&(t=null),t){var e=this.getBone(t);e&&e.invalidUpdate()}else for(var i=this.boneList.length;i--;)this.boneList[i].invalidUpdate()},s.resetAnimation=function(){this.animation.animationState._resetTimelineStateList();for(var t=this.boneList.length,e=0;t>e;e++){var i=this.boneList[e];i._timelineState=null}this.animation.stop()},s.sortSlot=function(t,e){return t.zOrder<e.zOrder?1:-1},s.getAnimation=function(){return this._animation},a(s,"armatureData",function(){return this._armatureData}),a(s,"animation",function(){return this._animation}),a(s,"display",function(){return this._display}),a(s,"enableCache",function(){return this._enableCache},function(t){this._enableCache=t}),a(s,"enableEventDispatch",function(){return this._enableEventDispatch},function(t){this._enableEventDispatch=t}),s._addEvent=function(t){this._enableEventDispatch&&this._eventList.push(t)},s.getIKs=function(t){return void 0===t&&(t=!0),t?this._ikList.concat():this._ikList},s.buildIK=function(){var e;this._ikList.length=0;for(var i=0,a=this._armatureData.ikDataList.length;a>i;i++)e=this._armatureData.ikDataList[i],this._ikList.push(new t.FastIKConstraint(e,this))},s.updateBoneCache=function(){this.boneList.reverse();var t,e,i,a,n={},s=this._ikList.length,r=s+1;for(this._boneIKList=[];this._boneIKList.length<r;)this._boneIKList[this._boneIKList.length]=[];for(n[this.boneList[0].name]=0,t=0,e=this._ikList.length;e>t;t++)n[this._ikList[t].bones[0].name]=t+1;t:for(t=0,e=this.boneList.length;e>t;t++)for(i=this.boneList[t],a=i;a;){if(null==a.parent&&(n[a.name]=0),n.hasOwnProperty(a.name)){this._boneIKList[n[a.name]].push(i);continue t}a=a.parent}},s.getIKTargetData=function(t){for(var e,i=[],a=0,n=this._ikList.length;n>a;a++)e=this._ikList[a],t.name==e.target.name&&i.push(e);return i},i}(t.EventDispatcher);t.FastArmature=e,egret.registerClass(e,"dragonBones.FastArmature",["dragonBones.ICacheableArmature","dragonBones.IArmature","dragonBones.IAnimatable"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._globalTransformMatrixBackup=this._globalTransformMatrix=new t.Matrix,this._globalBackup=this._global=new t.DBTransform,this._origin=new t.DBTransform,this._visible=!0,this.armature=null,this._parent=null,this.userData=null,this.inheritRotation=!0,this.inheritScale=!0,this.inheritTranslation=!0}var i=__define,a=e,n=a.prototype;return n.updateByCache=function(t){this._global=this._frameCache.globalTransform,this._globalTransformMatrix=this._frameCache.globalTransformMatrix},n.switchTransformToBackup=function(){},n.setParent=function(t){this._parent=t},n.dispose=function(){this.userData=null,this._globalTransformMatrix=null,this._global=null,this._origin=null,this.armature=null,this._parent=null},n._calculateParentTransform=function(){if(this.parent&&(this.inheritTranslation||this.inheritRotation||this.inheritScale)){var e=this._parent._global,i=this._parent._globalTransformMatrix;return t.ParentTransformObject.create().setTo(e,i)}return t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix),null},n._updateGlobal=function(){this._calculateRelativeParentTransform();var e=this._calculateParentTransform();if(null!=e){var i=e.parentGlobalTransformMatrix,a=e.parentGlobalTransform,n=this._global.x,s=this._global.y;this._global.x=i.a*n+i.c*s+i.tx,this._global.y=i.d*s+i.b*n+i.ty,this.inheritRotation&&(this._global.skewX+=a.skewX,this._global.skewY+=a.skewY),this.inheritScale&&(this._global.scaleX*=a.scaleX,this._global.scaleY*=a.scaleY)}return t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix),e},n._calculateRelativeParentTransform=function(){},i(n,"name",function(){return this._name},function(t){this._name=t}),i(n,"global",function(){return this._global}),i(n,"globalTransformMatrix",function(){return this._globalTransformMatrix}),i(n,"origin",function(){return this._origin}),i(n,"parent",function(){return this._parent}),i(n,"visible",function(){return this._visible},function(t){this._visible=t}),i(n,"frameCache",void 0,function(t){this._frameCache=t}),e._tempParentGlobalTransform=new t.DBTransform,e}();t.FastDBObject=e,egret.registerClass(e,"dragonBones.FastDBObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.slotList=[],this.boneList=[],this._needUpdate=0,this.isIKConstraint=!1,this.childrenBones=[],this._needUpdate=2,this._tweenPivot=new t.Point}__extends(i,e);var a=__define,n=i,s=n.prototype;return i.initWithBoneData=function(t){var e=new i;return e.name=t.name,e.length=t.length,e.inheritRotation=t.inheritRotation,e.inheritScale=t.inheritScale,e.origin.copy(t.transform),e},s.getBones=function(t){return void 0===t&&(t=!0),t?this.boneList.concat():this.boneList},s.getSlots=function(t){return void 0===t&&(t=!0),t?this.slotList.concat():this.slotList},s.dispose=function(){e.prototype.dispose.call(this),this._timelineState=null,this._tweenPivot=null},s.invalidUpdate=function(){this._needUpdate=2,this.operationInvalidUpdate(this);var t,e;for(t=0,e=this.childrenBones.length;e>t;t++)2!=this.childrenBones[t]._needUpdate&&(this.operationInvalidUpdate(this.childrenBones[t]),this.childrenBones[t].invalidUpdate())},s.operationInvalidUpdate=function(t){var e,i,a,n,s,r,o=this.armature.getIKTargetData(t);for(e=0,i=o.length;i>e;e++)for(s=o[e],a=0,n=s.bones.length;n>a;a++)r=s.bones[a],2!=r._needUpdate&&r.invalidUpdate()},s._calculateRelativeParentTransform=function(){this._global.copy(this._origin),this._timelineState&&this._global.add(this._timelineState._transform)},s.updateByCache=function(t){e.prototype.updateByCache.call(this,t),this._global=this._frameCache.globalTransform,this._globalTransformMatrix=this._frameCache.globalTransformMatrix},s.update=function(t){void 0===t&&(t=!1),this._needUpdate--,(t||this._needUpdate>0||this._parent&&this._parent._needUpdate>0)&&(this._needUpdate=1,this.updataLocalTransform(),this.updateGlobalTransform())},s.updataLocalTransform=function(){this.blendingTimeline(),this._calculateRelativeParentTransform()},s.updateGlobalTransform=function(){var t=this._updateGlobal();t&&t.release()},s._updateGlobal=function(){if(!this.armature._skewEnable)return e.prototype._updateGlobal.call(this);var i=this._calculateParentTransform();if(null!=i&&i.parentGlobalTransformMatrix&&i.parentGlobalTransform){var a=i.parentGlobalTransformMatrix,n=i.parentGlobalTransform,s=this._global.scaleX*n.scaleX>0,r=this._global.scaleY*n.scaleY>0,o=(this._global.rotation,this._global.scaleX,this._global.scaleY,this.parentBoneRotation);this._localTransform=this._global,this.inheritScale&&!this.inheritRotation&&0!=o&&(this._localTransform=this._localTransform.clone(),this._localTransform.rotation-=o),t.TransformUtil.transformToMatrix(this._localTransform,this._globalTransformMatrix),this._globalTransformMatrix.concat(a),this.inheritScale?t.TransformUtil.matrixToTransform(this._globalTransformMatrix,this._global,s,r):(t.TransformUtil.matrixToTransformPosition(this._globalTransformMatrix,this._global),this._global.scaleX=this._localTransform.scaleX,this._global.scaleY=this._localTransform.scaleY,this._global.rotation=this._localTransform.rotation+(this.inheritRotation?o:0),t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix))}return i},s.adjustGlobalTransformMatrixByIK=function(){this.parent&&(this.updataLocalTransform(),this._global.rotation=this.rotationIK-this.parentBoneRotation,this.updateGlobalTransform())},s._hideSlots=function(){for(var t=this.slotList.length,e=0;t>e;e++){var i=this.slotList[e];i.hideSlots()}},s.blendingTimeline=function(){this._timelineState&&(this._tweenPivot.x=this._timelineState._pivot.x,this._tweenPivot.y=this._timelineState._pivot.y)},s.arriveAtFrame=function(e,i){if(e.event&&this.armature.hasEventListener(t.FrameEvent.BONE_FRAME_EVENT)){var a=new t.FrameEvent(t.FrameEvent.BONE_FRAME_EVENT);a.bone=this,a.animationState=i,a.frameLabel=e.event,this.armature._addEvent(a)}},a(s,"childArmature",function(){var t=this.slot;return t?t.childArmature:null}),a(s,"display",function(){var t=this.slot;return t?t.display:null},function(t){var e=this.slot;e&&(e.display=t)}),a(s,"visible",void 0,function(t){if(this._visible!=t){this._visible=t;for(var e=0,i=this.armature.slotList.length;i>e;e++)this.armature.slotList[e].parent==this&&this.armature.slotList[e]._updateDisplayVisible(this._visible)}}),a(s,"slot",function(){return this.slotList.length>0?this.slotList[0]:null}),a(s,"parentBoneRotation",function(){return this.parent?this.parent.rotationIK:0}),a(s,"parentBoneData",void 0,function(t){if(this._parent!=t){if(null!=this._parent){var e=this._parent.childrenBones.indexOf(this);e>=0&&this._parent.childrenBones.splice(e,1)}if(this.setParent(t),null!=this._parent){var i=this._parent.childrenBones.indexOf(this);0>i&&this._parent.childrenBones.push(this)}}}),i}(t.FastDBObject);t.FastBone=e,egret.registerClass(e,"dragonBones.FastBone")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(t,e){this.animationCacheBend=0,this.animationCacheWeight=-1,this.ikdata=t,this.armature=e,this.weight=t.weight,this.bendDirection=t.bendPositive?1:-1,this.bones=[];var i;t.chain&&(i=e.getBone(t.bones).parent,i.isIKConstraint=!0,this.bones.push(i)),i=e.getBone(t.bones),i.isIKConstraint=!0,this.bones.push(i),this.target=e.getBone(t.target)}var i=(__define,e),a=i.prototype;return a.dispose=function(){},a.compute=function(){switch(this.bones.length){case 1:var t=this.animationCacheWeight>=0?this.animationCacheWeight:this.weight;this.compute1(this.bones[0],this.target,t);break;case 2:var e=0!=this.animationCacheBend?this.animationCacheBend:this.bendDirection,i=this.animationCacheWeight>=0?this.animationCacheWeight:this.weight,a=this.compute2(this.bones[0],this.bones[1],this.target.global.x,this.target.global.y,e,i);this.bones[0].rotationIK=this.bones[0].origin.rotation+(a.x-this.bones[0].origin.rotation)*i+this.bones[0].parent.rotationIK,this.bones[1].rotationIK=this.bones[1].origin.rotation+(a.y-this.bones[1].origin.rotation)*i+this.bones[0].rotationIK}},a.compute1=function(t,e,i){var a=(t.inheritRotation&&null!=t.parent?t.parent.global.rotation:0,t.global.rotation),n=Math.atan2(e.global.y-t.global.y,e.global.x-t.global.x);t.rotationIK=a+(n-a)*i},a.compute2=function(e,i,a,n,s,r){if(0==r)return new t.Point(e.global.rotation,i.global.rotation);var o=new t.Point,l=new t.Point(e.global.x,e.global.y),h=new t.Point(i.global.x,i.global.y),_=new t.Matrix;t.TransformUtil.transformToMatrix(e.parent.global,_),_.invert();var u=t.TransformUtil.applyMatrixToPoint(new t.Point(a,n),_,!0);a=u.x,n=u.y,l=t.TransformUtil.applyMatrixToPoint(l,_,!0),h=t.TransformUtil.applyMatrixToPoint(h,_,!0);var m,f,d=e.origin.scaleX,c=e.origin.scaleY,g=i.origin.scaleX,p=h.x-l.x,T=h.y-l.y,v=Math.sqrt(p*p+T*T),D=1,y=0,A=0;0>d?(d=-d,y=Math.PI,D=-1):(y=0,D=1),0>c&&(c=-c,D=-D),0>g?(g=-g,A=Math.PI):A=0,s=D*s;t:if(Math.abs(d-c)<=.001){var b=i.length,C=b*g;a-=l.x,n-=l.y;var w=2*v*C,L=(a*a+n*n-v*v-C*C)/w;-1>L?L=-1:L>1&&(L=1),f=Math.acos(L)*s;var S=v+C*L,E=C*Math.sin(f);m=Math.atan2(n*S-a*E,a*S+n*E)}else{var M=v,x=a-l.x,B=n-l.y,F=i.length*i.origin.scaleX,O=d*F,I=c*F,P=Math.atan2(B,x),N=O*O,k=I*I,V=M*M,R=x*x+B*B,Y=k*V+N*R-N*k,X=-2*k*M,U=k-N,G=X*X-4*U*Y;if(G>=0){var K=Math.sqrt(G);0>X&&(K=-K),K=-(X+K)/2;var W=K/U,H=Y/K,Z=Math.abs(W)<Math.abs(H)?W:H;if(R>=Z*Z){var j=Math.sqrt(R-Z*Z)*s;m=P-Math.atan2(j,Z),f=Math.atan2(j/c,(Z-M)/d);break t}}var z=0,q=Number.MAX_VALUE,$=0,J=0,Q=0,te=0,ee=0,ie=0,ae=M+O,ne=ae*ae;ne>te&&(Q=0,te=ne,ee=ae),ae=M-O,ne=ae*ae,q>ne&&(z=Math.PI,q=ne,$=ae);var se=Math.acos(-O*M/(N-k));ae=O*Math.cos(se)+M;var re=I*Math.sin(se);ne=ae*ae+re*re,q>ne&&(z=se,q=ne,$=ae,J=re),ne>te&&(Q=se,te=ne,ee=ae,ie=re),(q+te)/2>=R?(m=P-Math.atan2(J*s,$),f=z*s):(m=P-Math.atan2(ie*s,ee),f=Q*s)}var oe=i.origin.x,le=i.origin.y*c,he=Math.atan2(le,oe)*D;return o.x=m-he+y,o.y=(f+he)*D+A,this.normalize(o.x),this.normalize(o.y),o},a.normalize=function(t){t>Math.PI?t-=2*Math.PI:t<-Math.PI&&(t+=2*Math.PI)},e}();t.FastIKConstraint=e,egret.registerClass(e,"dragonBones.FastIKConstraint")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(i){e.call(this),this.hasChildArmature=!1,this._displayIndex=-1,this._rawDisplay=null,this._display=null,this._childArmature=null,this._displayList=[],this._displayDataList=[],this._cacheTimeline=null,this.hasChildArmature=!1,this.inheritRotation=!0,this.inheritScale=!0,this._originZOrder=0,this._tweenZOrder=0,this._offsetZOrder=0,this._colorTransform=new t.ColorTransform,this._isColorChanged=!1,this._rawDisplay=i}__extends(i,e);var a=__define,n=i,s=n.prototype;return s.initWithSlotData=function(t){this.name=t.name,this.blendMode=t.blendMode,this._defaultGotoAndPlay=t.gotoAndPlay,this._originZOrder=t.zOrder,this._originDisplayIndex=t.displayIndex},s.dispose=function(){this._displayList&&(e.prototype.dispose.call(this),this._rawDisplay=null,this._display=null,this._childArmature=null,this._displayDataList=null,this._displayList=null)},s.updateByCache=function(i){var a=this._cacheTimeline.frameCacheList[i],n=a.displayIndex;if(n!=this._displayIndex&&(this._displayIndex=n,this.changeDisplay()),!(this._displayIndex<0)){this._frameCache&&a.globalTransform==this._frameCache.globalTransform?this._frameCache=a:(this._frameCache=a,e.prototype.updateByCache.call(this,i),this._updateTransform());var s=this._frameCache.colorTransform,r=null!=s;(this._isColorChanged!=r||this._isColorChanged&&r&&!t.ColorTransformUtil.isEqual(this._colorTransform,s))&&(s=s||t.ColorTransformUtil.originalColor,this._updateDisplayColor(s.alphaOffset,s.redOffset,s.greenOffset,s.blueOffset,s.alphaMultiplier,s.redMultiplier,s.greenMultiplier,s.blueMultiplier,r));var o=this._frameCache.gotoAndPlay;this._gotoAndPlay!=o&&(this._gotoAndPlay=o,this.updateChildArmatureAnimation())}},s._update=function(t){if(void 0===t&&(t=!1),this._parent&&(this._parent._needUpdate>0||t)){this._global!=this._globalBackup&&(this._global=this._globalBackup,this._globalTransformMatrix=this._globalTransformMatrixBackup);var e=this._updateGlobal();e&&e.release(),this._updateTransform()}},s._calculateRelativeParentTransform=function(){this._global.copy(this._origin),this._global.x+=this._parent._tweenPivot.x,this._global.y+=this._parent._tweenPivot.y},s.updateChildArmatureAnimation=function(){if(this.childArmature)if(this._displayIndex>=0){var t=this._gotoAndPlay;null==t&&(t=this._defaultGotoAndPlay,null==t&&this.childArmature.armatureData.defaultAnimation),null==t&&this.armature&&this.armature.animation.lastAnimationState&&(t=this.armature.animation.lastAnimationState.name),t&&this.childArmature.animation.hasAnimation(t)?this.childArmature.animation.gotoAndPlay(t):this.childArmature.animation.play()}else this.childArmature.animation.stop(),this.childArmature.animation._lastAnimationState=null},s.changeDisplay=function(){var e=this._display,i=this._childArmature;this._displayIndex<0||this._displayIndex>=this._displayList.length?this._display=this._rawDisplay:this._display=this._displayList[this._displayIndex],this._display instanceof t.FastArmature?(this._childArmature=this._display,this._display=this._display.display):(this._childArmature=null,this._display||(this._display=this._rawDisplay)),this._childArmature!=i&&this._childArmature&&this._childArmature.animation.play(),this._display!=e&&(this._updateDisplay(this._display),this.armature&&(e?this._replaceDisplay(e):this._addDisplay())),this._display==this._rawDisplay&&this._updateFrame(),this._display!=e&&(this._updateDisplayBlendMode(this._blendMode),this._updateDisplayColor(this._colorTransform.alphaOffset,this._colorTransform.redOffset,this._colorTransform.greenOffset,this._colorTransform.blueOffset,this._colorTransform.alphaMultiplier,this._colorTransform.redMultiplier,this._colorTransform.greenMultiplier,this._colorTransform.blueMultiplier)),this._displayIndex>=0&&this._displayIndex<this._displayDataList.length&&this._origin.copy(this._displayDataList[this._displayIndex][0].transform),this.armature&&!this.armature._isFrameCached&&this._update(!0)},a(s,"visible",void 0,function(t){this._visible!=t&&(this._visible=t,this._updateDisplayVisible(this._visible))}),a(s,"displayIndex",function(){return this._displayIndex},function(t){this._displayIndex!=t&&(this._displayIndex=t,this.changeDisplay())}),a(s,"display",function(){return this._display},function(t){var e=this._displayList.length;this._displayIndex>=e?0==e?this._displayList[0]=t:this._displayList[e-1]=t:this._displayList[this._displayIndex]=t,this._displayIndex>=0&&this.changeDisplay()}),a(s,"childArmature",function(){return this._childArmature},function(t){this._childArmature!=t&&(this.display=t)}),a(s,"displayDataList",function(){return this._displayDataList},function(t){if(this._displayDataList!=t)if(t&&t.length){this._displayDataList.length=t.length;for(var e=0,i=this._displayDataList.length;i>e;++e)this._displayDataList[e]=t[e]}else this._displayDataList.length=0}),a(s,"displayList",function(){return this._displayList},function(t){if(this._displayList!=t)if(t&&t.length){this._displayList.length=t.length;for(var e=0,i=this._displayList.length;i>e;++e)this._displayList[e]=t[e]}else this._displayList.length=0;this.changeDisplay()}),a(s,"zOrder",function(){return this._originZOrder+this._tweenZOrder+this._offsetZOrder},function(t){this.zOrder!=t&&(this._offsetZOrder=t-this._originZOrder-this._tweenZOrder,this.armature&&(this.armature._slotsZOrderChanged=!0))}),a(s,"blendMode",function(){return this._blendMode},function(t){this._blendMode!=t&&(this._blendMode=t,this._updateDisplayBlendMode(this._blendMode))}),a(s,"gotoAndPlay",function(){return this._gotoAndPlay},function(t){this._gotoAndPlay!=t&&(this._gotoAndPlay=t,this.updateChildArmatureAnimation())}),a(s,"colorTransform",function(){return this._colorTransform}),a(s,"colorChanged",function(){return this._isColorChanged}),s._updateDisplay=function(t){throw new Error("Abstract method needs to be implemented in subclass!")},s._addDisplay=function(){throw new Error("Abstract method needs to be implemented in subclass!")},s._replaceDisplay=function(t){throw new Error("Abstract method needs to be implemented in subclass!")},s._removeDisplay=function(){throw new Error("Abstract method needs to be implemented in subclass!")},s._getDisplayIndex=function(){throw new Error("Abstract method needs to be implemented in subclass!")},s._addDisplayToContainer=function(t,e){throw void 0===e&&(e=-1),new Error("Abstract method needs to be implemented in subclass!")},s._removeDisplayFromContainer=function(){throw new Error("Abstract method needs to be implemented in subclass!")},s._updateTransform=function(){throw new Error("Abstract method needs to be implemented in subclass!")},s._updateFrame=function(){throw new Error("Abstract method needs to be implemented in subclass!")},s._updateDisplayVisible=function(t){throw new Error("Abstract method needs to be implemented in subclass!")},s._updateDisplayColor=function(t,e,i,a,n,s,r,o,l){void 0===l&&(l=!1),this._colorTransform.alphaOffset=t,this._colorTransform.redOffset=e,this._colorTransform.greenOffset=i,this._colorTransform.blueOffset=a,this._colorTransform.alphaMultiplier=n,this._colorTransform.redMultiplier=s,this._colorTransform.greenMultiplier=r,this._colorTransform.blueMultiplier=o,this._isColorChanged=l},s._updateDisplayBlendMode=function(t){throw new Error("Abstract method needs to be implemented in subclass!")},s._arriveAtFrame=function(t,e){var i=t;if(this.displayIndex=i.displayIndex,this._updateDisplayVisible(i.visible),this._displayIndex>=0&&(isNaN(i.zOrder)||i.zOrder==this._tweenZOrder||(this._tweenZOrder=i.zOrder,this.armature._slotsZOrderChanged=!0)),t.action){var a=this.childArmature;a&&a.getAnimation().gotoAndPlay(t.action)}else i.gotoAndPlay&&(this.gotoAndPlay=i.gotoAndPlay)},s.hideSlots=function(){this.displayIndex=-1},s._updateGlobal=function(){this._calculateRelativeParentTransform(),t.TransformUtil.transformToMatrix(this._global,this._globalTransformMatrix);var e=this._calculateParentTransform();return e&&(this._globalTransformMatrix.concat(e.parentGlobalTransformMatrix),t.TransformUtil.matrixToTransform(this._globalTransformMatrix,this._global,this._global.scaleX*e.parentGlobalTransform.scaleX>=0,this._global.scaleY*e.parentGlobalTransform.scaleY>=0)),e},s._resetToOrigin=function(){this.displayIndex=this._originDisplayIndex,this._updateDisplayColor(0,0,0,0,1,1,1,1,!0)},i}(t.FastDBObject);t.FastSlot=e,egret.registerClass(e,"dragonBones.FastSlot",["dragonBones.ISlotCacheGenerator","dragonBones.ICacheUser"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e){this.animationState=new t.FastAnimationState,this._armature=e,this.animationState._armature=e,this.animationList=[],this._animationDataObj={},this._isPlaying=!1,this._timeScale=1}var i=__define,a=e,n=a.prototype;return n.dispose=function(){this._armature&&(this._armature=null,this._animationDataList=null,this.animationList=null,this.animationState=null)},n.gotoAndPlay=function(t,e,i,a){if(void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=0/0),!this._animationDataList)return null;var n=this._animationDataObj[t];if(!n)return null;if(this._armature.enableCache){this.animationCacheManager=this._armature._armatureData._cacheManager;var s=this.animationCacheManager.getAnimationCache(t);for(s.frameNum=Math.ceil(.001*n.duration*this.animationCacheManager.frameRate/n.scale),this.animationState.animationCache=s,l=this._armature.slotList.length;l--;){var r=this._armature.slotList[l];r._cacheTimeline=s.slotTimelineCacheDic[r.name]}}this._isPlaying=!0,e=0;var o;o=0>i?n.scale<0?1:n.scale:1e3*i/n.duration,a=isNaN(a)?n.playTimes:a,this.animationState._fadeIn(n,a,1/o,e);for(var l=this._armature.slotHasChildArmatureList.length;l--;){var r=this._armature.slotHasChildArmatureList[l],h=r.childArmature;h&&h.getAnimation().gotoAndPlay(t)}return this.animationState},n.gotoAndStop=function(t,e,i,a,n){return void 0===i&&(i=-1),void 0===a&&(a=0),void 0===n&&(n=-1),this.animationState.name!=t&&this.gotoAndPlay(t,a,n),i>=0?this.animationState.setCurrentTime(this.animationState.totalTime*i):this.animationState.setCurrentTime(e),this.animationState.stop(),this.animationState},n.play=function(){this._animationDataList&&(this.animationState.name?this._isPlaying?this.gotoAndPlay(this.animationState.name):this._isPlaying=!0:this.gotoAndPlay(this._animationDataList[0].name))},n.stop=function(){this._isPlaying=!1},n.advanceTime=function(t){this._isPlaying&&this.animationState._advanceTime(t*this._timeScale)},n.hasAnimation=function(t){return null!=this._animationDataObj[t]},i(n,"timeScale",function(){return this._timeScale},function(t){(isNaN(t)||0>t)&&(t=1),this._timeScale=t}),i(n,"animationDataList",function(){return this._animationDataList},function(t){this._animationDataList=t,this.animationList.length=0;for(var e=this._animationDataList.length,i=0;e>i;i++){var a=this._animationDataList[i];this.animationList.push(a.name),this._animationDataObj[a.name]=a}}),i(n,"movementList",function(){return this.animationList}),i(n,"movementID",function(){return this.lastAnimationName}),n.isPlaying=function(){return this._isPlaying&&!this.isComplete},i(n,"isComplete",function(){return this.animationState.isComplete}),i(n,"lastAnimationState",function(){return this.animationState}),i(n,"lastAnimationName",function(){return this.animationState?this.animationState.name:null}),e}();t.FastAnimation=e,egret.registerClass(e,"dragonBones.FastAnimation")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._boneTimelineStateList=[],this._slotTimelineStateList=[],this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._currentPlayTimes=0,this._totalTime=0,this._currentTime=0,this._lastTime=0,this._playTimes=0,this._fading=!1}var i=__define,a=e,n=a.prototype;return n.dispose=function(){this._resetTimelineStateList(),this._armature=null},n.play=function(){return this._isPlaying=!0,this},n.stop=function(){return this._isPlaying=!1,this},n.setCurrentTime=function(t){return(0>t||isNaN(t))&&(t=0),this._time=t,this._currentTime=1e3*this._time,this},n._resetTimelineStateList=function(){for(var e=this._boneTimelineStateList.length;e--;)t.FastBoneTimelineState.returnObject(this._boneTimelineStateList[e]);for(this._boneTimelineStateList.length=0,e=this._slotTimelineStateList.length;e--;)t.FastSlotTimelineState.returnObject(this._slotTimelineStateList[e]);this._slotTimelineStateList.length=0,this.name=null},n._fadeIn=function(t,e,i,a){this.animationData=t,this.name=this.animationData.name,this._totalTime=this.animationData.duration,this.autoTween=t.autoTween,this.setTimeScale(i),this.setPlayTimes(e),this._isComplete=!1,this._currentFrameIndex=-1,this._currentPlayTimes=-1,Math.round(this._totalTime*this.animationData.frameRate*.001)<2?this._currentTime=this._totalTime:this._currentTime=-1,this._fadeTotalTime=a*this._timeScale,this._fading=this._fadeTotalTime>0,this._isPlaying=!0,this._armature.enableCache&&this.animationCache&&this._fading&&this._boneTimelineStateList&&this.updateTransformTimeline(this._progress),this._time=0,this._progress=0,this._updateTimelineStateList(),this.hideBones()},n._updateTimelineStateList=function(){this._resetTimelineStateList();for(var e,i=this.animationData.timelineList.length,a=0;i>a;a++){var n=this.animationData.timelineList[a];e=n.name;var s=this._armature.getBone(e);if(s){var r=t.FastBoneTimelineState.borrowObject();r.fadeIn(s,this,n),this._boneTimelineStateList.push(r)}}for(var o=this.animationData.slotTimelineList.length,l=0;o>l;l++){var h=this.animationData.slotTimelineList[l];e=h.name;var _=this._armature.getSlot(e);if(_&&_.displayList.length>0){var u=t.FastSlotTimelineState.borrowObject();u.fadeIn(_,this,h),this._slotTimelineStateList.push(u)}}},n._advanceTime=function(t){if(t*=this._timeScale,this._fading&&(this._time+=t,this._progress=this._time/this._fadeTotalTime,this._progress>=1&&(this._progress=0,this._time=0,this._fading=!1)),this._fading){for(var e=this._boneTimelineStateList.length,i=0;e>i;i++){var a=this._boneTimelineStateList[i];a.updateFade(this._progress)}for(var n=this._slotTimelineStateList.length,s=0;n>s;s++){var r=this._slotTimelineStateList[s];r.updateFade(this._progress)}}else this.advanceTimelinesTime(t)},n.advanceTimelinesTime=function(e){this._isPlaying&&(this._time+=e);var i=!1,a=!1,n=!1,s=!1,r=0,o=1e3*this._time;if(0==this._playTimes||o<this._playTimes*this._totalTime?(s=!1,this._progress=o/this._totalTime,r=Math.ceil(this._progress)||1,this._progress-=Math.floor(this._progress),o%=this._totalTime):(r=this._playTimes,o=this._totalTime,s=!0,this._progress=1),this._isComplete=s,this.animationCache){var l=Math.floor(this._progress*(this.animationCache.frameNum-1));this._armature._cacheFrameIndex=l,this._armature._isFrameCached=this.animationCache._cahceList[l],this._armature._isFrameCached||this.updateTransformTimeline(this._progress)}else this.updateTransformTimeline(this._progress);this._currentTime!=o&&(this._currentPlayTimes!=r&&(this._currentPlayTimes>0&&r>1&&(a=!0),this._currentPlayTimes=r),this._currentTime<0&&(i=!0),this._isComplete&&(n=!0),this._lastTime=this._currentTime,this._currentTime=o,this.updateMainTimeline(s));var h;i&&this._armature.hasEventListener(t.AnimationEvent.START)&&(h=new t.AnimationEvent(t.AnimationEvent.START),h.animationState=this,this._armature._addEvent(h)),n?this._armature.hasEventListener(t.AnimationEvent.COMPLETE)&&(h=new t.AnimationEvent(t.AnimationEvent.COMPLETE),h.animationState=this,this._armature._addEvent(h)):a&&this._armature.hasEventListener(t.AnimationEvent.LOOP_COMPLETE)&&(h=new t.AnimationEvent(t.AnimationEvent.LOOP_COMPLETE),h.animationState=this,this._armature._addEvent(h))},n.updateTransformTimeline=function(t){var e,i,a=this._boneTimelineStateList.length;if(this._isComplete){for(;a--;)e=this._boneTimelineStateList[a],e.update(t),this._isComplete=e._isComplete&&this._isComplete;for(a=this._slotTimelineStateList.length;a--;)i=this._slotTimelineStateList[a],i.update(t),this._isComplete=i._isComplete&&this._isComplete}else{for(;a--;)e=this._boneTimelineStateList[a],e.update(t);for(a=this._slotTimelineStateList.length;a--;)i=this._slotTimelineStateList[a],i.update(t)}},n.updateMainTimeline=function(t){var e=this.animationData._frameList;if(e.length>0){for(var i,a,n=0,s=e.length;s>n;++n){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._lastTime=this._currentTime,this._currentFrameIndex++,this._currentFrameIndex>=e.length){if(t){this._currentFrameIndex--;break}this._currentFrameIndex=0}}a=e[this._currentFrameIndex],i&&this._armature.arriveAtFrame(i,this),this._currentFrameDuration=a.duration,this._currentFramePosition=a.position,i=a}a&&this._armature.arriveAtFrame(a,this)}},n.setTimeScale=function(t){return(isNaN(t)||t==1/0)&&(t=1),this._timeScale=t,this},n.setPlayTimes=function(t){return void 0===t&&(t=0),Math.round(.001*this._totalTime*this.animationData.frameRate)<2?this._playTimes=1:this._playTimes=t,this},i(n,"playTimes",function(){return this._playTimes}),i(n,"currentPlayTimes",function(){return this._currentPlayTimes<0?0:this._currentPlayTimes}),i(n,"isComplete",function(){return this._isComplete}),i(n,"isPlaying",function(){return this._isPlaying&&!this._isComplete}),i(n,"totalTime",function(){return.001*this._totalTime}),i(n,"currentTime",function(){return this._currentTime<0?0:.001*this._currentTime}),n.isUseCache=function(){return this._armature.enableCache&&this.animationCache&&!this._fading},n.hideBones=function(){for(var t=this.animationData.hideTimelineNameMap.length,e=0;t>e;e++){var i=this.animationData.hideTimelineNameMap[e],a=this._armature.getBone(i);a&&a._hideSlots()}var n;for(e=0,t=this.animationData.hideSlotTimelineNameMap.length;t>e;e++){n=this.animationData.hideSlotTimelineNameMap[e];var s=this._armature.getSlot(n);s&&s._resetToOrigin()}},i(n,"progress",function(){return this._progress}),e}();t.FastAnimationState=e,egret.registerClass(e,"dragonBones.FastAnimationState",["dragonBones.IAnimationState"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._lastTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._transform=new t.DBTransform,this._durationTransform=new t.DBTransform,this._transformToFadein=new t.DBTransform,this._pivot=new t.Point,this._durationPivot=new t.Point
}var i=(__define,e),a=i.prototype;return e.borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e.returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e.clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},a.clear=function(){this._bone&&(this._bone._timelineState=null,this._bone=null),this._animationState=null,this._timelineData=null,this._originPivot=null},a.fadeIn=function(e,i,a){switch(this._bone=e,this._animationState=i,this._timelineData=a,this.name=a.name,this._totalTime=this._timelineData.duration,this._isComplete=!1,this._tweenTransform=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._durationPivot.x=0,this._durationPivot.y=0,this._pivot.x=0,this._pivot.y=0,this._originPivot=this._timelineData.originPivot,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}if(i._fadeTotalTime>0){this._bone._timelineState?this._transformToFadein.copy(this._bone._timelineState._transform):this._transformToFadein=new t.DBTransform;var n=this._timelineData.frameList[0];this._durationTransform.copy(n.transform),this._durationTransform.minus(this._transformToFadein)}this._bone._timelineState=this},a.updateFade=function(t){this._transform.x=this._transformToFadein.x+this._durationTransform.x*t,this._transform.y=this._transformToFadein.y+this._durationTransform.y*t,this._transform.scaleX=this._transformToFadein.scaleX*(1+(this._durationTransform.scaleX-1)*t),this._transform.scaleY=this._transformToFadein.scaleX*(1+(this._durationTransform.scaleY-1)*t),this._transform.rotation=this._transformToFadein.rotation+this._durationTransform.rotation*t,this._bone.invalidUpdate()},a.update=function(t){1==this._updateMode?(this._updateMode=0,this.updateSingleFrame()):-1==this._updateMode&&this.updateMultipleFrame(t)},a.updateSingleFrame=function(){var t=this._timelineData.frameList[0];this._bone.arriveAtFrame(t,this._animationState),this._isComplete=!0,this._tweenEasing=0/0,this._tweenTransform=!1,this._pivot.x=this._originPivot.x+t.pivot.x,this._pivot.y=this._originPivot.y+t.pivot.y,this._transform.copy(t.transform),this._bone.invalidUpdate()},a.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=Math.floor(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=Math.floor(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._lastTime=this._currentTime,this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration||this._currentTime<this._lastTime))break;if(this._currentFrameIndex++,this._lastTime=this._currentTime,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._bone.arriveAtFrame(s,this._animationState),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._bone.arriveAtFrame(r,this._animationState),this.updateToNextFrame(e)),this._tweenTransform&&this.updateTween()}},a.updateToNextFrame=function(e){void 0===e&&(e=0);var i=this._currentFrameIndex+1;i>=this._timelineData.frameList.length&&(i=0);var a=this._timelineData.frameList[this._currentFrameIndex],n=this._timelineData.frameList[i],s=!1;0==i&&this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timelineData.offset)*this._timelineData.scale>.999999?(this._tweenEasing=0/0,s=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.animationData.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?s=!1:(10==this._tweenEasing&&(this._tweenEasing=0),s=!0)):s=!0):(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?s=!0:(this._tweenEasing=0/0,s=!1)),s?(this._durationTransform.x=n.transform.x-a.transform.x,this._durationTransform.y=n.transform.y-a.transform.y,this._durationTransform.skewX=n.transform.skewX-a.transform.skewX,this._durationTransform.skewY=n.transform.skewY-a.transform.skewY,this._durationTransform.scaleX=n.transform.scaleX-a.transform.scaleX+n.scaleOffset.x,this._durationTransform.scaleY=n.transform.scaleY-a.transform.scaleY+n.scaleOffset.y,this._durationPivot.x=n.pivot.x-a.pivot.x,this._durationPivot.y=n.pivot.y-a.pivot.y,this._durationTransform.normalizeRotation(),0==i&&(this._durationTransform.skewX=t.TransformUtil.formatRadian(this._durationTransform.skewX),this._durationTransform.skewY=t.TransformUtil.formatRadian(this._durationTransform.skewY)),this._durationTransform.x||this._durationTransform.y||this._durationTransform.skewX||this._durationTransform.skewY||1!=this._durationTransform.scaleX||1!=this._durationTransform.scaleY||this._durationPivot.x||this._durationPivot.y?this._tweenTransform=!0:this._tweenTransform=!1):this._tweenTransform=!1,this._tweenTransform||(this._transform.copy(a.transform),this._pivot.x=this._originPivot.x+a.pivot.x,this._pivot.y=this._originPivot.y+a.pivot.y,this._bone.invalidUpdate())},a.updateTween=function(){var e=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;this._tweenCurve?e=this._tweenCurve.getValueByProgress(e):this._tweenEasing&&(e=t.MathUtil.getEaseValue(e,this._tweenEasing));var i=this._timelineData.frameList[this._currentFrameIndex],a=i.transform,n=i.pivot;this._transform.x=a.x+this._durationTransform.x*e,this._transform.y=a.y+this._durationTransform.y*e,this._transform.skewX=a.skewX+this._durationTransform.skewX*e,this._transform.skewY=a.skewY+this._durationTransform.skewY*e,this._transform.scaleX=a.scaleX+this._durationTransform.scaleX*e,this._transform.scaleY=a.scaleY+this._durationTransform.scaleY*e,this._pivot.x=n.x+this._durationPivot.x*e,this._pivot.y=n.y+this._durationPivot.y*e,this._bone.invalidUpdate()},e._pool=[],e}();t.FastBoneTimelineState=e,egret.registerClass(e,"dragonBones.FastBoneTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._totalTime=0,this._currentTime=0,this._currentFrameIndex=0,this._currentFramePosition=0,this._currentFrameDuration=0,this._updateMode=0,this._durationColor=new t.ColorTransform}var i=(__define,e),a=i.prototype;return e.borrowObject=function(){return 0==e._pool.length?new e:e._pool.pop()},e.returnObject=function(t){e._pool.indexOf(t)<0&&(e._pool[e._pool.length]=t),t.clear()},e.clear=function(){for(var t=e._pool.length;t--;)e._pool[t].clear();e._pool.length=0},a.clear=function(){this._slot=null,this._armature=null,this._animation=null,this._animationState=null,this._timelineData=null},a.fadeIn=function(t,e,i){switch(this._slot=t,this._armature=this._slot.armature,this._animation=this._armature.animation,this._animationState=e,this._timelineData=i,this.name=i.name,this._totalTime=this._timelineData.duration,this._isComplete=!1,this._blendEnabled=!1,this._tweenColor=!1,this._currentFrameIndex=-1,this._currentTime=-1,this._tweenEasing=0/0,this._weight=1,this._timelineData.frameList.length){case 0:this._updateMode=0;break;case 1:this._updateMode=1;break;default:this._updateMode=-1}},a.updateFade=function(t){},a.update=function(t){-1==this._updateMode?this.updateMultipleFrame(t):1==this._updateMode&&(this._updateMode=0,this.updateSingleFrame())},a.updateMultipleFrame=function(t){var e=0;t/=this._timelineData.scale,t+=this._timelineData.offset;var i=this._totalTime*t,a=this._animationState.playTimes;if(0==a)this._isComplete=!1,e=Math.ceil(Math.abs(i)/this._totalTime)||1,i-=Math.floor(i/this._totalTime)*this._totalTime,0>i&&(i+=this._totalTime);else{var n=a*this._totalTime;i>=n?(i=n,this._isComplete=!0):-n>=i?(i=-n,this._isComplete=!0):this._isComplete=!1,0>i&&(i+=n),e=Math.ceil(i/this._totalTime)||1,this._isComplete?i=this._totalTime:i-=Math.floor(i/this._totalTime)*this._totalTime}if(this._currentTime!=i){this._currentTime=i;for(var s,r,o=this._timelineData.frameList,l=0,h=this._timelineData.frameList.length;h>l;++l){if(this._currentFrameIndex<0)this._currentFrameIndex=0;else{if(!(this._currentTime<this._currentFramePosition||this._currentTime>=this._currentFramePosition+this._currentFrameDuration))break;if(this._currentFrameIndex++,this._currentFrameIndex>=o.length){if(this._isComplete){this._currentFrameIndex--;break}this._currentFrameIndex=0}}r=o[this._currentFrameIndex],s&&this._slot._arriveAtFrame(s,this._animationState),this._currentFrameDuration=r.duration,this._currentFramePosition=r.position,s=r}r&&(this._slot._arriveAtFrame(r,this._animationState),this._blendEnabled=r.displayIndex>=0,this._blendEnabled?this.updateToNextFrame(e):(this._tweenEasing=0/0,this._tweenColor=!1)),this._blendEnabled&&this.updateTween()}},a.updateToNextFrame=function(e){void 0===e&&(e=0);var i=this._currentFrameIndex+1;i>=this._timelineData.frameList.length&&(i=0);var a=this._timelineData.frameList[this._currentFrameIndex],n=this._timelineData.frameList[i],s=!1;if(0==i&&this._animationState.playTimes&&this._animationState.currentPlayTimes>=this._animationState.playTimes&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timelineData.offset)*this._timelineData.scale>.999999?(this._tweenEasing=0/0,s=!1):a.displayIndex<0||n.displayIndex<0?(this._tweenEasing=0/0,s=!1):this._animationState.autoTween?(this._tweenEasing=this._animationState.animationData.tweenEasing,isNaN(this._tweenEasing)?(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,isNaN(this._tweenEasing)&&null==this._tweenCurve?s=!1:(10==this._tweenEasing&&(this._tweenEasing=0),s=!0)):s=!0):(this._tweenEasing=a.tweenEasing,this._tweenCurve=a.curve,!isNaN(this._tweenEasing)&&10!=this._tweenEasing||null!=this._tweenCurve?s=!0:(this._tweenEasing=0/0,s=!1)),s&&(a.color||n.color)?(t.ColorTransformUtil.minus(n.color||t.ColorTransformUtil.originalColor,a.color||t.ColorTransformUtil.originalColor,this._durationColor),this._tweenColor=0!=this._durationColor.alphaOffset||0!=this._durationColor.redOffset||0!=this._durationColor.greenOffset||0!=this._durationColor.blueOffset||0!=this._durationColor.alphaMultiplier||0!=this._durationColor.redMultiplier||0!=this._durationColor.greenMultiplier||0!=this._durationColor.blueMultiplier):this._tweenColor=!1,!this._tweenColor){var r,o;a.color?(r=a.color,o=!0):(r=t.ColorTransformUtil.originalColor,o=!1),(this._slot._isColorChanged||o)&&(t.ColorTransformUtil.isEqual(this._slot._colorTransform,r)||this._slot._updateDisplayColor(r.alphaOffset,r.redOffset,r.greenOffset,r.blueOffset,r.alphaMultiplier,r.redMultiplier,r.greenMultiplier,r.blueMultiplier,o))}},a.updateTween=function(){var e=this._timelineData.frameList[this._currentFrameIndex];if(this._tweenColor){var i=(this._currentTime-this._currentFramePosition)/this._currentFrameDuration;null!=this._tweenCurve?i=this._tweenCurve.getValueByProgress(i):this._tweenEasing&&(i=t.MathUtil.getEaseValue(i,this._tweenEasing)),e.color?this._slot._updateDisplayColor(e.color.alphaOffset+this._durationColor.alphaOffset*i,e.color.redOffset+this._durationColor.redOffset*i,e.color.greenOffset+this._durationColor.greenOffset*i,e.color.blueOffset+this._durationColor.blueOffset*i,e.color.alphaMultiplier+this._durationColor.alphaMultiplier*i,e.color.redMultiplier+this._durationColor.redMultiplier*i,e.color.greenMultiplier+this._durationColor.greenMultiplier*i,e.color.blueMultiplier+this._durationColor.blueMultiplier*i,!0):this._slot._updateDisplayColor(this._durationColor.alphaOffset*i,this._durationColor.redOffset*i,this._durationColor.greenOffset*i,this._durationColor.blueOffset*i,this._durationColor.alphaMultiplier*i+1,this._durationColor.redMultiplier*i+1,this._durationColor.greenMultiplier*i+1,this._durationColor.blueMultiplier*i+1,!0)}},a.updateSingleFrame=function(){var e=this._timelineData.frameList[0];if(this._slot._arriveAtFrame(e,this._animationState),this._isComplete=!0,this._tweenEasing=0/0,this._tweenColor=!1,this._blendEnabled=e.displayIndex>=0,this._blendEnabled){var i,a;e.color?(i=e.color,a=!0):(i=t.ColorTransformUtil.originalColor,a=!1),(this._slot._isColorChanged||a)&&(t.ColorTransformUtil.isEqual(this._slot._colorTransform,i)||this._slot._updateDisplayColor(i.alphaOffset,i.redOffset,i.greenOffset,i.blueOffset,i.alphaMultiplier,i.redMultiplier,i.greenMultiplier,i.blueMultiplier,a))}},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._pool=[],e}();t.FastSlotTimelineState=e,egret.registerClass(e,"dragonBones.FastSlotTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var e=(__define,t),i=e.prototype;return i.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},t}();t.Point=e,egret.registerClass(e,"dragonBones.Point")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),this.x=t,this.y=e,this.width=i,this.height=a}var e=(__define,t);e.prototype;return t}();t.Rectangle=e,egret.registerClass(e,"dragonBones.Rectangle")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.duration=0,this._frameList=[],this.duration=0,this.scale=1}var e=__define,i=t,a=i.prototype;return a.dispose=function(){for(var t=this._frameList.length;t--;)this._frameList[t].dispose();this._frameList=null},a.addFrame=function(t){if(!t)throw new Error;if(!(this._frameList.indexOf(t)<0))throw new Error;this._frameList[this._frameList.length]=t},e(a,"frameList",function(){return this._frameList}),t}();t.Timeline=e,egret.registerClass(e,"dragonBones.Timeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.frameRate=0,this.playTimes=0,this.lastFrameDuration=0,this.fadeTime=0,this.playTimes=0,this.autoTween=!0,this.tweenEasing=0/0,this.hideTimelineNameMap=[],this.hideSlotTimelineNameMap=[],this._timelineList=[],this._slotTimelineList=[],this._ffdTimelineList=[]}__extends(e,t);var i=__define,a=e,n=a.prototype;return i(n,"timelineList",function(){return this._timelineList}),i(n,"slotTimelineList",function(){return this._slotTimelineList}),i(n,"ffdTimelineList",function(){return this._ffdTimelineList}),n.dispose=function(){t.prototype.dispose.call(this),this.hideTimelineNameMap=null;var e=0,i=0;for(e=0,i=this._timelineList.length;i>e;e++){var a=this._timelineList[e];a.dispose()}for(this._timelineList=null,e=0,i=this._slotTimelineList.length;i>e;e++){var n=this._slotTimelineList[e];n.dispose()}this._slotTimelineList=null},n.getTimeline=function(t){for(var e=this._timelineList.length;e--;)if(this._timelineList[e].name==t)return this._timelineList[e];return null},n.addTimeline=function(t){if(!t)throw new Error;this._timelineList.indexOf(t)<0&&(this._timelineList[this._timelineList.length]=t)},n.getSlotTimeline=function(t){for(var e=this._slotTimelineList.length;e--;)if(this._slotTimelineList[e].name==t)return this._slotTimelineList[e];return null},n.addSlotTimeline=function(t){if(!t)throw new Error;this._slotTimelineList.indexOf(t)<0&&(this._slotTimelineList[this._slotTimelineList.length]=t)},n.addFFDTimeline=function(t){if(!t)throw new Error;this._ffdTimelineList.indexOf(t)<0&&(this._ffdTimelineList[this._ffdTimelineList.length]=t)},e}(t.Timeline);t.AnimationData=e,egret.registerClass(e,"dragonBones.AnimationData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this._cacheManager=null,this._boneDataList=[],this._ikDataList=[],this._skinDataList=[],this._slotDataList=[],this._animationDataList=[]}var e=__define,i=t,a=i.prototype;return t.sortBoneDataHelpArray=function(t,e){return t[0]>e[0]?1:-1},t.sortBoneDataHelpArrayDescending=function(t,e){return t[0]>e[0]?-1:1},a.setSkinData=function(t){var e=0,i=this._slotDataList.length;for(e=0;i>e;e++)this._slotDataList[e].dispose();var a;if(!t&&this._skinDataList.length>0)a=this._skinDataList[0];else for(e=0,i=this._skinDataList.length;i>e;e++)if(this._skinDataList[e].name==t){a=this._skinDataList[e];break}if(a){var n;for(e=0,i=a.slotDataList.length,e=0;i>e;e++)if(n=this.getSlotData(a.slotDataList[e].name)){var s=0,r=a.slotDataList[e].displayDataList.length;for(s=0;r>s;s++)n.addDisplayData(a.slotDataList[e].displayDataList[s])}}},a.dispose=function(){for(var t=this._boneDataList.length;t--;)this._boneDataList[t].dispose();for(t=this._ikDataList.length;t--;)this._ikDataList[t].dispose();for(t=this._skinDataList.length;t--;)this._skinDataList[t].dispose();for(t=this._slotDataList.length;t--;)this._slotDataList[t].dispose();for(t=this._animationDataList.length;t--;)this._animationDataList[t].dispose();this._boneDataList=null,this._ikDataList=null,this._slotDataList=null,this._skinDataList=null,this._animationDataList=null},a.getBoneData=function(t){for(var e=this._boneDataList.length;e--;)if(this._boneDataList[e].name==t)return this._boneDataList[e];return null},a.getIKData=function(t){for(var e=this._ikDataList.length;e--;)if(this._ikDataList[e].name==t)return this._ikDataList[e];return null},a.getSlotData=function(t){for(var e=this._slotDataList.length;e--;)if(this._slotDataList[e].name==t)return this._slotDataList[e];return null},a.getSkinData=function(t){if(!t&&this._skinDataList.length>0)return this._skinDataList[0];for(var e=this._skinDataList.length;e--;)if(this._skinDataList[e].name==t)return this._skinDataList[e];return null},a.getAnimationData=function(t){for(var e=this._animationDataList.length;e--;)if(this._animationDataList[e].name==t)return this._animationDataList[e];return null},a.addBoneData=function(t){if(!t)throw new Error;if(!(this._boneDataList.indexOf(t)<0))throw new Error;this._boneDataList[this._boneDataList.length]=t},a.addIKData=function(t){if(!t)throw new Error;if(!(this._ikDataList.indexOf(t)<0))throw new Error;this._ikDataList[this._ikDataList.length]=t},a.addSlotData=function(t){if(!t)throw new Error;if(!(this._slotDataList.indexOf(t)<0))throw new Error;this._slotDataList[this._slotDataList.length]=t},a.addSkinData=function(t){if(!t)throw new Error;if(!(this._skinDataList.indexOf(t)<0))throw new Error;this._skinDataList[this._skinDataList.length]=t},a.addAnimationData=function(t){if(!t)throw new Error;this._animationDataList.indexOf(t)<0&&(this._animationDataList[this._animationDataList.length]=t)},a.sortBoneDataList=function(){var e=this._boneDataList.length;if(0!=e){for(var i=[];e--;){for(var a=this._boneDataList[e],n=0,s=a;s;)n++,s=this.getBoneData(s.parent);i[e]=[n,a]}for(i.sort(t.sortBoneDataHelpArray),e=i.length;e--;)this._boneDataList[e]=i[e][1]}},e(a,"boneDataList",function(){return this._boneDataList}),e(a,"ikDataList",function(){return this._ikDataList}),e(a,"slotDataList",function(){return this._slotDataList}),e(a,"skinDataList",function(){return this._skinDataList}),e(a,"animationDataList",function(){return this._animationDataList}),t}();t.ArmatureData=e,egret.registerClass(e,"dragonBones.ArmatureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.length=0,this.global=new t.DBTransform,this.transform=new t.DBTransform,this.inheritRotation=!0,this.inheritScale=!1}var i=(__define,e),a=i.prototype;return a.dispose=function(){this.global=null,this.transform=null},e}();t.BoneData=e,egret.registerClass(e,"dragonBones.BoneData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.alphaMultiplier=1,this.alphaOffset=0,this.blueMultiplier=1,this.blueOffset=0,this.greenMultiplier=1,this.greenOffset=0,this.redMultiplier=1,this.redOffset=0}var e=(__define,t);e.prototype;return t}();t.ColorTransform=e,egret.registerClass(e,"dragonBones.ColorTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._dataChanged=!1,this._pointList=[],this.sampling=new Array(e.SamplingTimes);for(var i=0;i<e.SamplingTimes-1;i++)this.sampling[i]=new t.Point}var i=__define,a=e,n=a.prototype;return n.getValueByProgress=function(t){this._dataChanged&&this.refreshSampling();for(var i=0;i<e.SamplingTimes-1;i++){var a=this.sampling[i];if(a.x>=t){if(0==i)return a.y*t/a.x;var n=this.sampling[i-1];return n.y+(a.y-n.y)*(t-n.x)/(a.x-n.x)}}return a.y+(1-a.y)*(t-a.x)/(1-a.x)},n.refreshSampling=function(){for(var t=0;t<e.SamplingTimes-1;t++)this.bezierCurve(e.SamplingStep*(t+1),this.sampling[t]);this._dataChanged=!1},n.bezierCurve=function(t,e){var i=1-t;e.x=3*this.point1.x*t*i*i+3*this.point2.x*t*t*i+Math.pow(t,3),e.y=3*this.point1.y*t*i*i+3*this.point2.y*t*t*i+Math.pow(t,3)},i(n,"pointList",function(){return this._pointList},function(t){this._pointList=t,this._dataChanged=!0}),n.isCurve=function(){return 0!=this.point1.x||0!=this.point1.y||1!=this.point2.x||1!=this.point2.y},i(n,"point1",function(){return this.pointList[0]}),i(n,"point2",function(){return this.pointList[1]}),e.SamplingTimes=20,e.SamplingStep=.05,e}();t.CurveData=e,egret.registerClass(e,"dragonBones.CurveData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.transform=new t.DBTransform,this.pivot=new t.Point}var i=(__define,e),a=i.prototype;return a.dispose=function(){this.transform=null,this.pivot=null},e.ARMATURE="armature",e.IMAGE="image",e.MESH="mesh",e}();t.DisplayData=e,egret.registerClass(e,"dragonBones.DisplayData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.version=0,this._armatureDataList=[],this._displayDataDictionary={}}var e=__define,i=t,a=i.prototype;return a.dispose=function(){for(var t=0,e=this._armatureDataList.length;e>t;t++){var i=this._armatureDataList[t];i.dispose()}this._armatureDataList=null,this.removeAllDisplayData(),this._displayDataDictionary=null},e(a,"armatureDataList",function(){return this._armatureDataList}),a.getArmatureDataByName=function(t){for(var e=this._armatureDataList.length;e--;)if(this._armatureDataList[e].name==t)return this._armatureDataList[e];return null},a.addArmatureData=function(t){if(!t)throw new Error;if(!(this._armatureDataList.indexOf(t)<0))throw new Error;this._armatureDataList[this._armatureDataList.length]=t},a.removeArmatureData=function(t){var e=this._armatureDataList.indexOf(t);e>=0&&this._armatureDataList.splice(e,1)},a.removeArmatureDataByName=function(t){for(var e=this._armatureDataList.length;e--;)this._armatureDataList[e].name==t&&this._armatureDataList.splice(e,1)},a.getDisplayDataByName=function(t){return this._displayDataDictionary[t]},a.addDisplayData=function(t){this._displayDataDictionary[t.name]=t},a.removeDisplayDataByName=function(t){delete this._displayDataDictionary[t]},a.removeAllDisplayData=function(){for(var t in this._displayDataDictionary)delete this._displayDataDictionary[t]},t}();t.DragonBonesData=e,egret.registerClass(e,"dragonBones.DragonBonesData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.position=0,this.duration=0,this.position=0,this.duration=0}var e=(__define,t),i=e.prototype;return i.dispose=function(){},t}();t.Frame=e,egret.registerClass(e,"dragonBones.Frame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(t.Frame);t.FFDFrame=e,egret.registerClass(e,"dragonBones.FFDFrame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.offset=0}__extends(e,t);var i=(__define,e),a=i.prototype;return a.dispose=function(){t.prototype.dispose.call(this)},e}(t.Timeline);t.FFDTimeline=e,egret.registerClass(e,"dragonBones.FFDTimeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t),i=e.prototype;return i.constructora=function(){},i.dispose=function(){},t}();t.IKData=e,egret.registerClass(e,"dragonBones.IKData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.skinned=!1,this.numVertex=0,this.numTriangle=0,this.triangles=[],this.vertices=[],this.vertexBones=[],this.bones=[],this.inverseBindPose=[],this.slotPose=new t.Matrix}__extends(i,e);var a=(__define,i),n=a.prototype;return n.dispose=function(){e.prototype.dispose.call(this),this.triangles.length=0,this.vertices.length=0,this.vertexBones.length=0,this.bones.length=0,this.inverseBindPose.length=0},i}(t.DisplayData);t.MeshData=e,egret.registerClass(e,"dragonBones.MeshData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t),i=e.prototype;return i.setTo=function(t,e){return this.parentGlobalTransform=t,this.parentGlobalTransformMatrix=e,this},i.release=function(){t.dispose(this)},t.create=function(){return t._poolSize>0?(t._poolSize--,t._pool.pop()):new t},t.dispose=function(e){e.parentGlobalTransform=null,e.parentGlobalTransformMatrix=null,t._pool[t._poolSize++]=e},t._pool=[],t._poolSize=0,t}();t.ParentTransformObject=e,egret.registerClass(e,"dragonBones.ParentTransformObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.hasMesh=!1,this._slotDataList=[]}var e=__define,i=t,a=i.prototype;return a.dispose=function(){for(var t=this._slotDataList.length;t--;)this._slotDataList[t].dispose();this._slotDataList=null},a.getSlotData=function(t){for(var e=this._slotDataList.length;e--;)if(this._slotDataList[e].name==t)return this._slotDataList[e];return null},a.addSlotData=function(t){if(!t)throw new Error;if(!(this._slotDataList.indexOf(t)<0))throw new Error;this._slotDataList[this._slotDataList.length]=t},e(a,"slotDataList",function(){return this._slotDataList}),t}();t.SkinData=e,egret.registerClass(e,"dragonBones.SkinData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this._displayDataList=[],this.zOrder=0}var e=__define,i=t,a=i.prototype;return a.dispose=function(){this._displayDataList.length=0},a.addDisplayData=function(t){if(!t)throw new Error;if(!(this._displayDataList.indexOf(t)<0))throw new Error;this._displayDataList[this._displayDataList.length]=t},a.getDisplayData=function(t){for(var e=this._displayDataList.length;e--;)if(this._displayDataList[e].name==t)return this._displayDataList[e];return null},e(a,"displayDataList",function(){return this._displayDataList}),t}();t.SlotData=e,egret.registerClass(e,"dragonBones.SlotData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.displayIndex=0,this.tweenEasing=10,this.displayIndex=0,this.visible=!0,this.zOrder=0/0}__extends(e,t);var i=(__define,e),a=i.prototype;return a.dispose=function(){t.prototype.dispose.call(this),this.color=null},e}(t.Frame);t.SlotFrame=e,egret.registerClass(e,"dragonBones.SlotFrame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.offset=0}__extends(e,t);var i=(__define,e),a=i.prototype;return a.dispose=function(){t.prototype.dispose.call(this)},e}(t.Timeline);t.SlotTimeline=e,egret.registerClass(e,"dragonBones.SlotTimeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.tweenRotate=0,this.displayIndex=0,this.tweenEasing=10,this.tweenRotate=0,this.tweenScale=!0,this.displayIndex=0,this.visible=!0,this.zOrder=0/0,this.global=new t.DBTransform,this.transform=new t.DBTransform,this.pivot=new t.Point,this.scaleOffset=new t.Point}__extends(i,e);var a=(__define,i),n=a.prototype;return n.dispose=function(){e.prototype.dispose.call(this),this.global=null,this.transform=null,this.pivot=null,this.scaleOffset=null,this.color=null},i}(t.Frame);t.TransformFrame=e,egret.registerClass(e,"dragonBones.TransformFrame")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.originTransform=new t.DBTransform,this.originTransform.scaleX=1,this.originTransform.scaleY=1,this.originPivot=new t.Point,this.offset=0}__extends(i,e);var a=(__define,i),n=a.prototype;return n.dispose=function(){e.prototype.dispose.call(this),this.originTransform=null,this.originPivot=null},i}(t.Timeline);t.TransformTimeline=e,egret.registerClass(e,"dragonBones.TransformTimeline")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.indices=[],this.weights=[],this.vertices=[]}var e=(__define,t);e.prototype;return t}();t.VertexBoneData=e,egret.registerClass(e,"dragonBones.VertexBoneData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.u=0,this.v=0}__extends(e,t);var i=(__define,e);i.prototype;return e}(t.Point);t.VertexData=e,egret.registerClass(e,"dragonBones.VertexData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.parseDragonBonesData=function(i){if(!i)throw new Error;var a=i[t.ConstValues.A_VERSION];if(a=a.toString(),a.toString()!=t.DragonBones.DATA_VERSION&&a.toString()!=t.DragonBones.PARENT_COORDINATE_DATA_VERSION&&"2.3"!=a.toString())throw new Error("Nonsupport version!");var n=e.getNumber(i,t.ConstValues.A_FRAME_RATE,0)||0,s=new t.DragonBonesData;s.name=i[t.ConstValues.A_NAME],s.isGlobal="0"==i[t.ConstValues.A_IS_GLOBAL]?!1:!0,e.tempDragonBonesData=s;for(var r=i[t.ConstValues.ARMATURE],o=0,l=r.length;l>o;o++){var h=r[o];s.addArmatureData(e.parseArmatureData(h,n))}return e.tempDragonBonesData=null,s},e.parseArmatureData=function(i,a){var n=new t.ArmatureData;n.name=i[t.ConstValues.A_NAME];var s,r,o=i[t.ConstValues.BONE];for(s=0,r=o.length;r>s;s++){var l=o[s];n.addBoneData(e.parseBoneData(l))}var h=i[t.ConstValues.SKIN];for(s=0,r=h.length;r>s;s++)for(var _=h[s],u=_[t.ConstValues.SLOT],m=0,f=u.length;f>m;m++){var d=u[m];n.addSlotData(e.parseSlotData(d))}for(s=0,r=h.length;r>s;s++){var c=h[s];n.addSkinData(e.parseSkinData(c))}e.tempDragonBonesData.isGlobal&&t.DBDataUtil.transformArmatureData(n),n.sortBoneDataList();var g=i[t.ConstValues.ANIMATION];for(s=0,r=g.length;r>s;s++){var p=g[s],T=e.parseAnimationData(p,a);t.DBDataUtil.addHideTimeline(T,n),t.DBDataUtil.transformAnimationData(T,n,e.tempDragonBonesData.isGlobal),n.addAnimationData(T)}return n},e.parseBoneData=function(i){var a=new t.BoneData;return a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.length=Number(i[t.ConstValues.A_LENGTH])||0,a.inheritRotation=e.getBoolean(i,t.ConstValues.A_INHERIT_ROTATION,!0),a.inheritScale=e.getBoolean(i,t.ConstValues.A_INHERIT_SCALE,!0),e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform),e.tempDragonBonesData.isGlobal&&a.global.copy(a.transform),a},e.parseSkinData=function(i){var a=new t.SkinData;a.name=i[t.ConstValues.A_NAME];for(var n=i[t.ConstValues.SLOT],s=0,r=n.length;r>s;s++){var o=n[s];a.addSlotData(e.parseSkinSlotData(o))}return a},e.parseSkinSlotData=function(i){var a=new t.SlotData;a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=i[t.ConstValues.A_Z_ORDER],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,a.blendMode=i[t.ConstValues.A_BLENDMODE];var n=i[t.ConstValues.DISPLAY];if(n)for(var s=0,r=n.length;r>s;s++){var o=n[s];a.addDisplayData(e.parseDisplayData(o))}return a},e.parseSlotData=function(i){var a=new t.SlotData;
return a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=i[t.ConstValues.A_Z_ORDER],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,a.blendMode=i[t.ConstValues.A_BLENDMODE],a.displayIndex=0,a},e.parseDisplayData=function(i){var a=new t.DisplayData;return a.name=i[t.ConstValues.A_NAME],a.type=i[t.ConstValues.A_TYPE],e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform,a.pivot),null!=e.tempDragonBonesData&&e.tempDragonBonesData.addDisplayData(a),a},e.parseAnimationData=function(i,a){var n=new t.AnimationData;n.name=i[t.ConstValues.A_NAME],n.frameRate=a,n.duration=Math.round(1e3*(e.getNumber(i,t.ConstValues.A_DURATION,1)||1)/a),n.playTimes=e.getNumber(i,t.ConstValues.A_LOOP,1),n.playTimes=0/0!=n.playTimes?n.playTimes:1,n.fadeTime=e.getNumber(i,t.ConstValues.A_FADE_IN_TIME,0)||0,n.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,0/0),n.autoTween=e.getBoolean(i,t.ConstValues.A_AUTO_TWEEN,!0),e._currentAnimationData=n;var s=i[t.ConstValues.FRAME],r=0,o=0;if(s)for(r=0,o=s.length;o>r;r++){var l=s[r],h=new t.Frame;e.parseFrame(l,h,a),n.addFrame(h)}e.parseTimeline(i,n);var _,u=n.duration,m=i[t.ConstValues.TIMELINE];if(m){for(r=0,o=m.length;o>r;r++){var f=m[r],d=e.parseTransformTimeline(f,n.duration,a);u=Math.min(u,d.frameList[d.frameList.length-1].duration),n.addTimeline(d);var c=e.parseSlotTimeline(f,n.duration,a);if(n.addSlotTimeline(c),n.autoTween&&!_)for(var g,p=0,T=c.frameList.length;T>p;p++)if(g=c.frameList[p],g&&g.displayIndex<0){_=!0;break}}var v=n.tweenEasing;if(_){for(o=n.slotTimelineList.length,r=0;o>r;r++){c=n.slotTimelineList[r],d=n.timelineList[r];var D,y,A;for(p=0,T=c.frameList.length;T>p;p++)y=c.frameList[p],D=d.frameList[p],A=p==T-1?c.frameList[0]:c.frameList[p+1],y.displayIndex<0||A.displayIndex<0?D.tweenEasing=y.tweenEasing=0/0:10==v?D.tweenEasing=y.tweenEasing=0:isNaN(v)?10==D.tweenEasing&&(D.tweenEasing=0):D.tweenEasing=y.tweenEasing=v}n.autoTween=!1}}return n.frameList.length>0&&(u=Math.min(u,n.frameList[n.frameList.length-1].duration)),n.lastFrameDuration=u,n},e.parseSlotTimeline=function(i,a,n){var s=new t.SlotTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.duration=a;for(var r=i[t.ConstValues.FRAME],o=0,l=r.length;l>o;o++){var h=r[o],_=e.parseSlotFrame(h,n);s.addFrame(_)}return e.parseTimeline(i,s),s},e.parseSlotFrame=function(i,a){var n=new t.SlotFrame;e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.displayIndex=Math.floor(e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0)||0),n.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,e.tempDragonBonesData.isGlobal?0/0:0);var s=i[t.ConstValues.COLOR_TRANSFORM];return s&&(n.color=new t.ColorTransform,e.parseColorTransform(s,n.color)),n},e.parseTransformTimeline=function(i,a,n){var s=new t.TransformTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.originPivot.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,s.originPivot.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0,s.duration=a;for(var r,o=!1,l=0,h=null,_=i[t.ConstValues.FRAME],u=0,m=_.length;m>u;u++){var f=_[u];r=m-1>u?_[u+1]:0!=u?_[0]:null;var d=e.parseTransformFrame(f,r,n);s.addFrame(d),(d.event||d.sound)&&(o||(o=!0,e._currentAnimationData.frameList.length=0),h?h.duration=l:0!=l&&(h=new t.Frame,h.bone=s.name,h.duration=l,e._currentAnimationData.addFrame(h)),l=0,h=new t.Frame,h.bone=s.name,e.parseFrame(f,h,n),e._currentAnimationData.addFrame(h)),l+=d.duration}return e.parseTimeline(i,s),h&&e.parseTimeline(null,e._currentAnimationData),s},e.parseTransformFrame=function(i,a,n){var s=new t.TransformFrame;return e.parseFrame(i,s,n),s.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),s.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),s.tweenRotate=Math.floor(e.getNumber(i,t.ConstValues.A_TWEEN_ROTATE,0)||0),s.tweenScale=e.getBoolean(i,t.ConstValues.A_TWEEN_SCALE,!0),a&&-1==Math.floor(e.getNumber(a,t.ConstValues.A_DISPLAY_INDEX,0)||0)&&(s.tweenEasing=0/0),e.parseTransform(i[t.ConstValues.TRANSFORM],s.transform,s.pivot),e.tempDragonBonesData.isGlobal&&s.global.copy(s.transform),s.scaleOffset.x=e.getNumber(i,t.ConstValues.A_SCALE_X_OFFSET,0)||0,s.scaleOffset.y=e.getNumber(i,t.ConstValues.A_SCALE_Y_OFFSET,0)||0,s},e.parseTimeline=function(t,e){for(var i,a=0,n=e.frameList,s=0,r=n.length;r>s;s++)i=n[s],i.position=a,a+=i.duration;i&&(i.duration=e.duration-i.position)},e.parseFrame=function(e,i,a){void 0===a&&(a=0),i.duration=Math.round(1e3*(e[t.ConstValues.A_DURATION]||1)/a),i.action=e[t.ConstValues.A_ACTION],i.event=e[t.ConstValues.A_EVENT],i.sound=e[t.ConstValues.A_SOUND]},e.parseTransform=function(i,a,n){void 0===n&&(n=null),i&&(a&&(a.x=e.getNumber(i,t.ConstValues.A_X,0)||0,a.y=e.getNumber(i,t.ConstValues.A_Y,0)||0,a.skewX=e.getNumber(i,t.ConstValues.A_SKEW_X,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.skewY=e.getNumber(i,t.ConstValues.A_SKEW_Y,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.scaleX=e.getNumber(i,t.ConstValues.A_SCALE_X,1)||0,a.scaleY=e.getNumber(i,t.ConstValues.A_SCALE_Y,1)||0),n&&(n.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,n.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0))},e.parseColorTransform=function(i,a){i&&a&&(a.alphaOffset=e.getNumber(i,t.ConstValues.A_ALPHA_OFFSET,0),a.redOffset=e.getNumber(i,t.ConstValues.A_RED_OFFSET,0),a.greenOffset=e.getNumber(i,t.ConstValues.A_GREEN_OFFSET,0),a.blueOffset=e.getNumber(i,t.ConstValues.A_BLUE_OFFSET,0),a.alphaMultiplier=.01*e.getNumber(i,t.ConstValues.A_ALPHA_MULTIPLIER,100),a.redMultiplier=.01*e.getNumber(i,t.ConstValues.A_RED_MULTIPLIER,100),a.greenMultiplier=.01*e.getNumber(i,t.ConstValues.A_GREEN_MULTIPLIER,100),a.blueMultiplier=.01*e.getNumber(i,t.ConstValues.A_BLUE_MULTIPLIER,100))},e.getBoolean=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;case"1":case"true":default:return!0}return i},e.getNumber=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"NaN":case"":case"false":case"null":case"undefined":return 0/0;default:return Number(t[e])}return i},e._currentAnimationData=null,e}();t.Data3Parser=e,egret.registerClass(e,"dragonBones.Data3Parser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.parseTextureAtlasData=function(i,a){void 0===a&&(a=1);for(var n,s={},r=i[t.ConstValues.SUB_TEXTURE],o=0,l=r.length;l>o;o++){var h=r[o],_=h[t.ConstValues.A_NAME],u=new t.Rectangle;u.x=e.getNumber(h,t.ConstValues.A_X,0)/a,u.y=e.getNumber(h,t.ConstValues.A_Y,0)/a,u.width=e.getNumber(h,t.ConstValues.A_WIDTH,0)/a,u.height=e.getNumber(h,t.ConstValues.A_HEIGHT,0)/a;var m="true"==h[t.ConstValues.A_ROTATED],f=e.getNumber(h,t.ConstValues.A_FRAME_WIDTH,0)/a,d=e.getNumber(h,t.ConstValues.A_FRAME_HEIGHT,0)/a;f>0&&d>0?(n=new t.Rectangle,n.x=e.getNumber(h,t.ConstValues.A_FRAME_X,0)/a,n.y=e.getNumber(h,t.ConstValues.A_FRAME_Y,0)/a,n.width=f,n.height=d):n=null,s[_]=new t.TextureData(u,n,m)}return s},e.parseDragonBonesData=function(i){if(!i)throw new Error;var a=i[t.ConstValues.A_VERSION];if(a=a.toString(),a.toString()!=t.DragonBones.DATA_VERSION&&a.toString()!=t.DragonBones.DATA_VERSION_4_5&&a.toString()!=t.DragonBones.PARENT_COORDINATE_DATA_VERSION&&"2.3"!=a.toString())throw new Error(egret.getString(4003));if(a.toString()==t.DragonBones.PARENT_COORDINATE_DATA_VERSION||"2.3"==a.toString())return t.Data3Parser.parseDragonBonesData(i);var n=e.getNumber(i,t.ConstValues.A_FRAME_RATE,0)||0,s=new t.DragonBonesData;s.name=i[t.ConstValues.A_NAME],s.isGlobal="0"==i[t.ConstValues.A_IS_GLOBAL]?!1:!0,s.version=parseFloat(a),e.tempDragonBonesData=s;for(var r=i[t.ConstValues.ARMATURE],o=0,l=r.length;l>o;o++){var h=r[o];s.addArmatureData(e.parseArmatureData(h,n))}return e.tempDragonBonesData=null,s},e.parseArmatureData=function(i,a){var n=new t.ArmatureData;n.name=i[t.ConstValues.A_NAME],e._armatureData=n;var s=i[t.ConstValues.A_DEFAULT_ACTIONS];s&&1==s.length&&(n.defaultAnimation=s[0][t.ConstValues.A_GOTOANDPLAY]),n.frameRate=i[t.ConstValues.A_FRAME_RATE],(isNaN(n.frameRate)||n.frameRate<=0)&&(n.frameRate=a),a=n.frameRate;var r,o,l=i[t.ConstValues.BONE];for(e._rawBones.length=0,r=0,o=l.length;o>r;r++){var h=l[r];n.addBoneData(e.parseBoneData(h))}var _=i[t.ConstValues.IK];if(_)for(r=0,o=_.length;o>r;r++){var u=_[r];n.addIKData(e.parseIKData(u))}n.sortBoneDataList();var m=i[t.ConstValues.SLOT];for(r=0,o=m.length;o>r;r++){var f=m[r];n.addSlotData(e.parseSlotData(f))}var d=i[t.ConstValues.SKIN];for(r=0,o=d.length;o>r;r++){var c=d[r];n.addSkinData(e.parseSkinData(c))}e.tempDragonBonesData.isGlobal&&t.DBDataUtil.transformArmatureData(n);var g=i[t.ConstValues.ANIMATION];for(r=0,o=g.length;o>r;r++){var p=g[r],T=e.parseAnimationData(p,a);t.DBDataUtil.addHideTimeline(T,n,!0),t.DBDataUtil.transformAnimationData(T,n,e.tempDragonBonesData.isGlobal),n.addAnimationData(T)}return n},e.parseBoneData=function(i){var a=new t.BoneData;return e._rawBones.push(a),a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.length=Number(i[t.ConstValues.A_LENGTH])||0,a.inheritRotation=e.getBoolean(i,t.ConstValues.A_INHERIT_ROTATION,!0),a.inheritScale=e.getBoolean(i,t.ConstValues.A_INHERIT_SCALE,!0),e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform),e.tempDragonBonesData.isGlobal&&a.global.copy(a.transform),a},e.parseIKData=function(i){var a=new t.IKData;return a.name=i[t.ConstValues.A_NAME],a.target=i[t.ConstValues.A_TARGET],i.hasOwnProperty(t.ConstValues.A_WEIGHT)?a.weight=Number(i[t.ConstValues.A_WEIGHT]):a.weight=1,a.bendPositive=e.getBoolean(i,t.ConstValues.A_BENDPOSITIVE,!0),i.hasOwnProperty(t.ConstValues.A_CHAIN)?a.chain=i[t.ConstValues.A_CHAIN]:a.chain=0,a.bones=i[t.ConstValues.A_BONES],a},e.parseSkinData=function(i){var a=new t.SkinData;e._skinData=a,a.name=i[t.ConstValues.A_NAME];for(var n=i[t.ConstValues.SLOT],s=0,r=n.length;r>s;s++){var o=n[s];a.addSlotData(e.parseSlotDisplayData(o))}return a},e.parseSlotData=function(i){var a=new t.SlotData;a.name=i[t.ConstValues.A_NAME];var n=i[t.ConstValues.A_ACTIONS];return n&&1==n.length&&(a.gotoAndPlay=n[0][t.ConstValues.A_GOTOANDPLAY]),a.parent=i[t.ConstValues.A_PARENT],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,a.displayIndex=e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0),a.blendMode=i[t.ConstValues.A_BLENDMODE],a},e.parseSlotDisplayData=function(i){var a=new t.SlotData;a.name=i[t.ConstValues.A_NAME],a.parent=i[t.ConstValues.A_PARENT],a.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,0)||0,e._skinSlotData=a,e._displayIndex=0;var n=i[t.ConstValues.DISPLAY];if(n)for(var s=0,r=n.length;r>s;s++){var o=n[s];a.addDisplayData(e.parseDisplayData(o)),e._displayIndex++}return a},e.parseDisplayData=function(i){var a=new t.DisplayData;return"mesh"==i[t.ConstValues.A_TYPE]?a=e.parseMeshData(i):(a.name=i[t.ConstValues.A_NAME],a.type=i[t.ConstValues.A_TYPE],e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform,a.pivot),a.pivot.x=0/0,a.pivot.y=0/0,null!=e.tempDragonBonesData&&e.tempDragonBonesData.addDisplayData(a)),a},e.parseMeshData=function(i){var a=new t.MeshData;a.name=i[t.ConstValues.A_NAME],a.type=i[t.ConstValues.A_TYPE],e.parseTransform(i[t.ConstValues.TRANSFORM],a.transform,a.pivot),a.pivot.x=0/0,a.pivot.y=0/0;var n=i.uvs,s=i.triangles,r=i.weights,o=i.vertices,l=i.bonePose;i.slotPose&&(a.slotPose.a=i.slotPose[0],a.slotPose.b=i.slotPose[1],a.slotPose.c=i.slotPose[2],a.slotPose.d=i.slotPose[3],a.slotPose.tx=i.slotPose[4],a.slotPose.ty=i.slotPose[5]),a.skinned=r&&r.length>0,a.numVertex=n.length/2,a.numTriangle=s.length/3,a.vertices.length=a.numVertex,a.triangles.length=3*a.numTriangle;var h=0,_=0,u=0,m=0,f=null,d=null,c=[];if(e._skinData.hasMesh=!0,a.skinned&&(a.vertexBones.length=a.numVertex,l))for(_=0,h=l.length;h>_;_+=7)m=e._armatureData.boneDataList.indexOf(e._rawBones[l[_]]),f=new t.Matrix,f.a=l[_+1],f.b=l[_+2],f.c=l[_+3],f.d=l[_+4],f.tx=l[_+5],f.ty=l[_+6],f.invert(),c[m]=f;for(_=0,h=n.length;h>_;_+=2){var g=_+1,p=.5*_,T=a.vertices[p]=new t.VertexData;if(T.u=Number(n[_]),T.v=Number(n[g]),T.x=Number(o[_]),T.y=Number(o[g]),a.skinned){var v=a.vertexBones[p]=new t.VertexBoneData;a.slotPose.transformPoint(T.x,T.y,T);for(var D=u+1,y=u+1+2*r[u];y>D;D+=2){d=e._rawBones[r[D]],m=a.bones.indexOf(d),0>m&&(m=a.bones.length,a.bones[m]=d);var A=new t.Point(T.x,T.y);v.indices.push(m),v.weights.push(r[D+1]),v.vertices.push(A),a.inverseBindPose.length<=m&&(a.inverseBindPose.length=m+1),f=a.inverseBindPose[m],f||(f=c[e._armatureData.boneDataList.indexOf(d)],a.inverseBindPose[m]=f),f&&f.transformPoint(A.x,A.y,A),u=D+2}}}for(_=0,h=s.length;h>_;++_)a.triangles[_]=s[_];return a},e.parseAnimationData=function(i,a){var n=new t.AnimationData;n.name=i[t.ConstValues.A_NAME],n.frameRate=a,n.duration=Math.ceil(1e3*(e.getNumber(i,t.ConstValues.A_DURATION,1)||1)/a),n.playTimes=e.getNumber(i,t.ConstValues.A_PLAY_TIMES,1),n.playTimes=0/0!=n.playTimes?n.playTimes:1,n.fadeTime=e.getNumber(i,t.ConstValues.A_FADE_IN_TIME,0)||0,n.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,0/0),n.autoTween=e.getBoolean(i,t.ConstValues.A_AUTO_TWEEN,!0);var s=i[t.ConstValues.FRAME],r=0,o=0;if(s)for(r=0,o=s.length;o>r;r++){var l=s[r],h=e.parseTransformFrame(l,a);n.addFrame(h)}e.parseTimeline(i,n);var _=n.duration,u=i[t.ConstValues.BONE];if(u)for(r=0,o=u.length;o>r;r++){var m=u[r];if(m){var f=e.parseTransformTimeline(m,n.duration,a);f.frameList.length>0&&(_=Math.min(_,f.frameList[f.frameList.length-1].duration)),n.addTimeline(f)}}var d=i[t.ConstValues.SLOT];if(d)for(r=0,o=d.length;o>r;r++){var c=d[r];if(c){var g=e.parseSlotTimeline(c,n.duration,a);g.frameList.length>0&&(_=Math.min(_,g.frameList[g.frameList.length-1].duration),n.addSlotTimeline(g))}}var p=i.ffd;if(p)for(r=0,o=p.length;o>r;r++){var T=p[r];if(T){var v=e.parseFFDTimeline(T,n.duration,a);v.frameList.length>0&&(_=Math.min(_,v.frameList[v.frameList.length-1].duration),n.addFFDTimeline(v))}}return n.frameList.length>0&&(_=Math.min(_,n.frameList[n.frameList.length-1].duration)),n.lastFrameDuration=_,n},e.parseTransformTimeline=function(i,a,n){var s=new t.TransformTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.originPivot.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,s.originPivot.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0,s.duration=a;for(var r=i[t.ConstValues.FRAME],o=0,l=r.length;l>o;o++){var h=r[o],_=e.parseTransformFrame(h,n);s.addFrame(_)}return e.parseTimeline(i,s),s},e.parseSlotTimeline=function(i,a,n){var s=new t.SlotTimeline;s.name=i[t.ConstValues.A_NAME],s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.duration=a;for(var r=i[t.ConstValues.FRAME],o=0,l=r.length;l>o;o++){var h=r[o],_=e.parseSlotFrame(h,n);s.addFrame(_)}return e.parseTimeline(i,s),s},e.parseFFDTimeline=function(i,a,n){var s=new t.FFDTimeline;s.skin=i[t.ConstValues.SKIN],s.name=i[t.ConstValues.SLOT];var r=e._armatureData.getSkinData(s.skin),o=r.getSlotData(s.name),l=o.getDisplayData(i[t.ConstValues.A_NAME]);s.displayIndex=o.displayDataList.indexOf(l),s.scale=e.getNumber(i,t.ConstValues.A_SCALE,1)||0,s.offset=e.getNumber(i,t.ConstValues.A_OFFSET,0)||0,s.duration=a;for(var h=new t.Point,_=new t.Point,u=i[t.ConstValues.FRAME],m=0,f=u.length;f>m;m++){var d=u[m],c=e.parseFFDFrame(d,n);if(l.skinned){for(var g=[],p=0,T=l.vertices.length;T>p;++p){var v=l.vertexBones[p];2*p<c.offset||2*p-c.offset>=c.vertices.length?l.slotPose.transformPoint(0,0,h,!0):l.slotPose.transformPoint(c.vertices[2*p-c.offset],c.vertices[2*p+1-c.offset],h,!0);for(var D=0,y=v.indices.length;y>D;++D){var A=v.indices[D];l.inverseBindPose[A].transformPoint(h.x,h.y,_,!0),g.push(_.x,_.y)}}c.offset=0,c.vertices=g}s.addFrame(c)}return e.parseTimeline(i,s),s},e.parseTransformFrame=function(i,a){var n=new t.TransformFrame;return e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.tweenRotate=Math.floor(e.getNumber(i,t.ConstValues.A_TWEEN_ROTATE,0)||0),n.tweenScale=e.getBoolean(i,t.ConstValues.A_TWEEN_SCALE,!0),n.displayIndex=Math.floor(e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0)||0),e.parseTransform(i[t.ConstValues.TRANSFORM],n.transform,n.pivot),e.tempDragonBonesData.isGlobal&&n.global.copy(n.transform),n.scaleOffset.x=e.getNumber(i,t.ConstValues.A_SCALE_X_OFFSET,0)||0,n.scaleOffset.y=e.getNumber(i,t.ConstValues.A_SCALE_Y_OFFSET,0)||0,n},e.parseSlotFrame=function(i,a){var n=new t.SlotFrame;e.parseFrame(i,n,a),n.visible=!e.getBoolean(i,t.ConstValues.A_HIDE,!1),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.displayIndex=Math.floor(e.getNumber(i,t.ConstValues.A_DISPLAY_INDEX,0)||0);var s=i[t.ConstValues.A_ACTIONS];s&&1==s.length&&(n.gotoAndPlay=s[0][t.ConstValues.A_GOTOANDPLAY]),n.zOrder=e.getNumber(i,t.ConstValues.A_Z_ORDER,e.tempDragonBonesData.isGlobal?0/0:0);var r=i[t.ConstValues.COLOR];return r&&(n.color=new t.ColorTransform,e.parseColorTransform(r,n.color)),n},e.parseFFDFrame=function(i,a){var n=new t.FFDFrame;e.parseFrame(i,n,a),n.tweenEasing=e.getNumber(i,t.ConstValues.A_TWEEN_EASING,10),n.offset=i[t.ConstValues.A_OFFSET]||0;var s=i.vertices,r=[];if(s)for(var o=0,l=s.length;l>o;o++)r.push(Number(s[o]));return n.vertices=r,n},e.parseTimeline=function(t,e){for(var i,a=0,n=e.frameList,s=0,r=n.length;r>s;s++)i=n[s],i.position=a,a+=i.duration;i&&(i.duration=e.duration-i.position)},e.parseFrame=function(e,i,a){void 0===a&&(a=0),i.duration=Math.round(1e3*(e[t.ConstValues.A_DURATION]||1)/a),i.action=e[t.ConstValues.A_ACTION],i.event=e[t.ConstValues.A_EVENT],i.sound=e[t.ConstValues.A_SOUND];var n=e[t.ConstValues.A_CURVE];null!=n&&4==n.length&&(i.curve=new t.CurveData,i.curve.pointList=[new t.Point(n[0],n[1]),new t.Point(n[2],n[3])])},e.parseTransform=function(i,a,n){void 0===n&&(n=null),i&&(a&&(a.x=e.getNumber(i,t.ConstValues.A_X,0)||0,a.y=e.getNumber(i,t.ConstValues.A_Y,0)||0,a.skewX=e.getNumber(i,t.ConstValues.A_SKEW_X,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.skewY=e.getNumber(i,t.ConstValues.A_SKEW_Y,0)*t.ConstValues.ANGLE_TO_RADIAN||0,a.scaleX=e.getNumber(i,t.ConstValues.A_SCALE_X,1)||0,a.scaleY=e.getNumber(i,t.ConstValues.A_SCALE_Y,1)||0),n&&(n.x=e.getNumber(i,t.ConstValues.A_PIVOT_X,0)||0,n.y=e.getNumber(i,t.ConstValues.A_PIVOT_Y,0)||0))},e.parseColorTransform=function(i,a){a&&(a.alphaOffset=e.getNumber(i,t.ConstValues.A_ALPHA_OFFSET,0),a.redOffset=e.getNumber(i,t.ConstValues.A_RED_OFFSET,0),a.greenOffset=e.getNumber(i,t.ConstValues.A_GREEN_OFFSET,0),a.blueOffset=e.getNumber(i,t.ConstValues.A_BLUE_OFFSET,0),a.alphaMultiplier=.01*e.getNumber(i,t.ConstValues.A_ALPHA_MULTIPLIER,100),a.redMultiplier=.01*e.getNumber(i,t.ConstValues.A_RED_MULTIPLIER,100),a.greenMultiplier=.01*e.getNumber(i,t.ConstValues.A_GREEN_MULTIPLIER,100),a.blueMultiplier=.01*e.getNumber(i,t.ConstValues.A_BLUE_MULTIPLIER,100))},e.getBoolean=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;case"1":case"true":default:return!0}return i},e.getNumber=function(t,e,i){if(t&&e in t)switch(String(t[e])){case"NaN":case"":case"false":case"null":case"undefined":return 0/0;default:return Number(t[e])}return i},e._rawBones=[],e._armatureData=null,e._skinData=null,e._skinSlotData=null,e._meshData=null,e._displayIndex=0,e}();t.DataParser=e,egret.registerClass(e,"dragonBones.DataParser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i){this.region=t,this.frame=e,this.rotated=i}var e=(__define,t);e.prototype;return t}();t.TextureData=e,egret.registerClass(e,"dragonBones.TextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.cloneColor=function(e){var i=new t.ColorTransform;return i.redMultiplier=e.redMultiplier,i.greenMultiplier=e.greenMultiplier,i.blueMultiplier=e.blueMultiplier,i.alphaMultiplier=e.alphaMultiplier,i.redOffset=e.redOffset,i.greenOffset=e.greenOffset,i.blueOffset=e.blueOffset,i.alphaOffset=e.alphaOffset,i},e.isEqual=function(t,e){return t.alphaOffset==e.alphaOffset&&t.redOffset==e.redOffset&&t.greenOffset==e.greenOffset&&t.blueOffset==e.blueOffset&&t.alphaMultiplier==e.alphaMultiplier&&t.redMultiplier==e.redMultiplier&&t.greenMultiplier==e.greenMultiplier&&t.blueMultiplier==e.blueMultiplier},e.minus=function(t,e,i){i.alphaOffset=t.alphaOffset-e.alphaOffset,i.redOffset=t.redOffset-e.redOffset,i.greenOffset=t.greenOffset-e.greenOffset,i.blueOffset=t.blueOffset-e.blueOffset,i.alphaMultiplier=t.alphaMultiplier-e.alphaMultiplier,i.redMultiplier=t.redMultiplier-e.redMultiplier,i.greenMultiplier=t.greenMultiplier-e.greenMultiplier,i.blueMultiplier=t.blueMultiplier-e.blueMultiplier},e.originalColor=new t.ColorTransform,e}();t.ColorTransformUtil=e,egret.registerClass(e,"dragonBones.ColorTransformUtil")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t.DRAGON_BONES="dragonBones",t.ARMATURE="armature",t.SKIN="skin",t.BONE="bone",t.IK="ik",t.SLOT="slot",t.DISPLAY="display",t.ANIMATION="animation",t.TIMELINE="timeline",t.FRAME="frame",t.TRANSFORM="transform",t.COLOR_TRANSFORM="colorTransform",t.COLOR="color",t.RECTANGLE="rectangle",t.ELLIPSE="ellipse",t.TEXTURE_ATLAS="TextureAtlas",t.SUB_TEXTURE="SubTexture",t.A_ROTATED="rotated",t.A_FRAME_X="frameX",t.A_FRAME_Y="frameY",t.A_FRAME_WIDTH="frameWidth",t.A_FRAME_HEIGHT="frameHeight",t.A_VERSION="version",t.A_IMAGE_PATH="imagePath",t.A_FRAME_RATE="frameRate",t.A_NAME="name",t.A_IS_GLOBAL="isGlobal",t.A_PARENT="parent",t.A_LENGTH="length",t.A_TYPE="type",t.A_FADE_IN_TIME="fadeInTime",t.A_DURATION="duration",t.A_SCALE="scale",t.A_OFFSET="offset",t.A_LOOP="loop",t.A_PLAY_TIMES="playTimes",t.A_EVENT="event",t.A_EVENT_PARAMETERS="eventParameters",t.A_SOUND="sound",t.A_ACTION="action",t.A_HIDE="hide",t.A_AUTO_TWEEN="autoTween",t.A_TWEEN_EASING="tweenEasing",t.A_TWEEN_ROTATE="tweenRotate",t.A_TWEEN_SCALE="tweenScale",t.A_DISPLAY_INDEX="displayIndex",t.A_Z_ORDER="z",t.A_BLENDMODE="blendMode",t.A_WIDTH="width",t.A_HEIGHT="height",t.A_INHERIT_SCALE="inheritScale",t.A_INHERIT_ROTATION="inheritRotation",t.A_X="x",t.A_Y="y",t.A_SKEW_X="skX",t.A_SKEW_Y="skY",t.A_SCALE_X="scX",t.A_SCALE_Y="scY",t.A_PIVOT_X="pX",t.A_PIVOT_Y="pY",t.A_ALPHA_OFFSET="aO",t.A_RED_OFFSET="rO",t.A_GREEN_OFFSET="gO",t.A_BLUE_OFFSET="bO",t.A_ALPHA_MULTIPLIER="aM",t.A_RED_MULTIPLIER="rM",t.A_GREEN_MULTIPLIER="gM",t.A_BLUE_MULTIPLIER="bM",t.A_CURVE="curve",t.A_SCALE_X_OFFSET="scXOffset",t.A_SCALE_Y_OFFSET="scYOffset",t.A_SCALE_MODE="scaleMode",t.A_FIXED_ROTATION="fixedRotation",t.A_DEFAULT_ACTIONS="defaultActions",t.A_ACTIONS="actions",t.A_GOTOANDPLAY="gotoAndPlay",t.A_TARGET="target",t.A_WEIGHT="weight",t.A_BONES="bone",t.A_BENDPOSITIVE="bendPositive",t.A_CHAIN="chain",t}();t.ConstValues=e,egret.registerClass(e,"dragonBones.ConstValues")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.transformArmatureData=function(e){for(var i=e.boneDataList,a=i.length;a--;){var n=i[a];if(n.parent){var s=e.getBoneData(n.parent);s&&(n.transform.copy(n.global),t.TransformUtil.globalToLocal(n.transform,s.global))}}},e.transformArmatureDataAnimations=function(t){for(var i=t.animationDataList,a=i.length;a--;)e.transformAnimationData(i[a],t,!1)},e.transformRelativeAnimationData=function(t,e){},e.transformAnimationData=function(i,a,n){if(!n)return void e.transformRelativeAnimationData(i,a);var s,r=a.getSkinData(null),o=a.boneDataList;r&&(s=r.slotDataList);for(var l=0;l<o.length;l++){var h=o[l],_=i.getTimeline(h.name),u=i.getSlotTimeline(h.name);if(_||u){var m=null;if(s)for(var f=0,d=s.length;d>f&&(m=s[f],m.parent!=h.name);f++);var c=_.frameList;if(u)var g=u.frameList;for(var p=null,T=c.length,f=0;T>f;f++){var v=c[f];if(e.setFrameTransform(i,a,h,v),v.transform.x-=h.transform.x,v.transform.y-=h.transform.y,v.transform.skewX-=h.transform.skewX,v.transform.skewY-=h.transform.skewY,v.transform.scaleX/=h.transform.scaleX,v.transform.scaleY/=h.transform.scaleY,p){var D=v.transform.skewX-p.transform.skewX;p.tweenRotate?p.tweenRotate>0?(0>D&&(v.transform.skewX+=2*Math.PI,v.transform.skewY+=2*Math.PI),p.tweenRotate>1&&(v.transform.skewX+=2*Math.PI*(p.tweenRotate-1),v.transform.skewY+=2*Math.PI*(p.tweenRotate-1))):(D>0&&(v.transform.skewX-=2*Math.PI,v.transform.skewY-=2*Math.PI),p.tweenRotate<1&&(v.transform.skewX+=2*Math.PI*(p.tweenRotate+1),v.transform.skewY+=2*Math.PI*(p.tweenRotate+1))):(v.transform.skewX=p.transform.skewX+t.TransformUtil.formatRadian(v.transform.skewX-p.transform.skewX),v.transform.skewY=p.transform.skewY+t.TransformUtil.formatRadian(v.transform.skewY-p.transform.skewY))}p=v}if(u&&g){T=g.length;for(var f=0;T>f;f++){var y=g[f];u.transformed||m&&(y.zOrder-=m.zOrder)}u.transformed=!0}_.transformed=!0}}},e.setFrameTransform=function(i,a,n,s){s.transform.copy(s.global);var r=a.getBoneData(n.parent);if(r){var o=i.getTimeline(r.name);if(o){for(var l=[],h=[];o;)l.push(o),h.push(r),r=a.getBoneData(r.parent),o=r?i.getTimeline(r.name):null;for(var _,u=l.length,m=new t.Matrix,f=new t.DBTransform,d=new t.Matrix;u--;)o=l[u],r=h[u],e.getTimelineTransform(o,s.position,f,!_),_?(f.x+=o.originTransform.x+r.transform.x,f.y+=o.originTransform.y+r.transform.y,f.skewX+=o.originTransform.skewX+r.transform.skewX,f.skewY+=o.originTransform.skewY+r.transform.skewY,f.scaleX*=o.originTransform.scaleX*r.transform.scaleX,f.scaleY*=o.originTransform.scaleY*r.transform.scaleY,t.TransformUtil.transformToMatrix(f,d),d.concat(m),t.TransformUtil.matrixToTransform(d,_,f.scaleX*_.scaleX>=0,f.scaleY*_.scaleY>=0)):(_=new t.DBTransform,_.copy(f)),t.TransformUtil.transformToMatrix(_,m);t.TransformUtil.globalToLocal(s.transform,_)}}},e.getTimelineTransform=function(e,i,a,n){for(var s=e.frameList,r=s.length;r--;){var o=s[r];if(o.position<=i&&o.position+o.duration>i){if(r==s.length-1||i==o.position)a.copy(n?o.global:o.transform);else{var l=o.tweenEasing,h=(i-o.position)/o.duration;l&&10!=l&&(h=t.MathUtil.getEaseValue(h,l));var _=s[r+1],u=n?o.global:o.transform,m=n?_.global:_.transform;a.x=u.x+(m.x-u.x)*h,a.y=u.y+(m.y-u.y)*h,a.skewX=t.TransformUtil.formatRadian(u.skewX+(m.skewX-u.skewX)*h),a.skewY=t.TransformUtil.formatRadian(u.skewY+(m.skewY-u.skewY)*h),a.scaleX=u.scaleX+(m.scaleX-u.scaleX)*h,a.scaleY=u.scaleY+(m.scaleY-u.scaleY)*h}break}}},e.addHideTimeline=function(t,e,i){void 0===i&&(i=!1);for(var a=e.boneDataList,n=e.slotDataList,s=a.length;s--;){var r=a[s],o=r.name;t.getTimeline(o)||t.hideTimelineNameMap.indexOf(o)<0&&t.hideTimelineNameMap.push(o)}if(i){s=n.length;for(var l,h;s--;)l=n[s],h=l.name,t.getSlotTimeline(h)||t.hideSlotTimelineNameMap.indexOf(h)<0&&t.hideSlotTimelineNameMap.push(h)}},e}();t.DBDataUtil=e,egret.registerClass(e,"dragonBones.DBDataUtil")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.getEaseValue=function(e,i){var a=1;return i>1?(a=.5*(1-t.cos(e*Math.PI)),i-=1):i>0?a=1-Math.pow(1-e,2):0>i&&(i*=-1,a=Math.pow(e,2)),(a-e)*i+e},t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){e*=t.RADIAN_TO_ANGLE;var i=Math.floor(e),a=i+1,n=t.sinInt(i),s=t.sinInt(a);return(e-i)*s+(a-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),90>t?db_sin_map[t]:180>t?db_sin_map[180-t]:270>t?-db_sin_map[t-180]:-db_sin_map[360-t]},t.cos=function(e){return t.sin(Math.PI/2-e)},t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t}();t.MathUtil=e,egret.registerClass(e,"dragonBones.MathUtil")}(dragonBones||(dragonBones={}));for(var db_sin_map={},dbMathIndex=0;90>=dbMathIndex;dbMathIndex++)db_sin_map[dbMathIndex]=Math.sin(dbMathIndex*dragonBones.MathUtil.ANGLE_TO_RADIAN);var dragonBones;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.isEqual=function(t,i){return t>=i?t-i<=e.ACCURACY:i-t<=e.ACCURACY},e.globalToLocal=function(t,i){e.transformToMatrix(t,e._helpTransformMatrix),e.transformToMatrix(i,e._helpParentTransformMatrix),e._helpParentTransformMatrix.invert(),e._helpTransformMatrix.concat(e._helpParentTransformMatrix),e.matrixToTransform(e._helpTransformMatrix,t,t.scaleX*i.scaleX>=0,t.scaleY*i.scaleY>=0)},e.transformToMatrix=function(e,i){i.a=e.scaleX*t.MathUtil.cos(e.skewY),i.b=e.scaleX*t.MathUtil.sin(e.skewY),i.c=-e.scaleY*t.MathUtil.sin(e.skewX),i.d=e.scaleY*t.MathUtil.cos(e.skewX),i.tx=e.x,i.ty=e.y},e.matrixToTransform=function(t,i,a,n){i.x=t.tx,i.y=t.ty,i.scaleX=Math.sqrt(t.a*t.a+t.b*t.b)*(a?1:-1),i.scaleY=Math.sqrt(t.d*t.d+t.c*t.c)*(n?1:-1),e.tmpSkewXArray[0]=Math.acos(t.d/i.scaleY),e.tmpSkewXArray[1]=-e.tmpSkewXArray[0],e.tmpSkewXArray[2]=Math.asin(-t.c/i.scaleY),e.tmpSkewXArray[3]=e.tmpSkewXArray[2]>=0?Math.PI-e.tmpSkewXArray[2]:e.tmpSkewXArray[2]-Math.PI,e.isEqual(e.tmpSkewXArray[0],e.tmpSkewXArray[2])||e.isEqual(e.tmpSkewXArray[0],e.tmpSkewXArray[3])?i.skewX=e.tmpSkewXArray[0]:i.skewX=e.tmpSkewXArray[1],e.tmpSkewYArray[0]=Math.acos(t.a/i.scaleX),e.tmpSkewYArray[1]=-e.tmpSkewYArray[0],e.tmpSkewYArray[2]=Math.asin(t.b/i.scaleX),e.tmpSkewYArray[3]=e.tmpSkewYArray[2]>=0?Math.PI-e.tmpSkewYArray[2]:e.tmpSkewYArray[2]-Math.PI,e.isEqual(e.tmpSkewYArray[0],e.tmpSkewYArray[2])||e.isEqual(e.tmpSkewYArray[0],e.tmpSkewYArray[3])?i.skewY=e.tmpSkewYArray[0]:i.skewY=e.tmpSkewYArray[1]},e.applyMatrixToPoint=function(e,i,a){return void 0===a&&(a=!1),this._helpMatrix.tx=e.x,this._helpMatrix.ty=e.y,this._helpMatrix.concat(i),a?new t.Point(this._helpMatrix.tx,this._helpMatrix.ty):(e.x=this._helpMatrix.tx,e.y=this._helpMatrix.ty,e)},e.formatRadian=function(t){return t>Math.PI&&(t-=e.DOUBLE_PI),t<-Math.PI&&(t+=e.DOUBLE_PI),t},e.normalizeRotation=function(t){return t=(t+Math.PI)%(2*Math.PI),t=t>0?t:2*Math.PI+t,t-Math.PI},e.matrixToTransformPosition=function(t,e){e.x=t.tx,e.y=t.ty},e.matrixToTransformScale=function(t,e,i,a){e.scaleX=Math.sqrt(t.a*t.a+t.b*t.b)*(i?1:-1),e.scaleY=Math.sqrt(t.d*t.d+t.c*t.c)*(a?1:-1)},e.matrixToTransformRotation=function(t,i,a,n){e.tmpSkewXArray[0]=Math.acos(t.d/n),e.tmpSkewXArray[1]=-e.tmpSkewXArray[0],e.tmpSkewXArray[2]=Math.asin(-t.c/n),e.tmpSkewXArray[3]=e.tmpSkewXArray[2]>=0?Math.PI-e.tmpSkewXArray[2]:e.tmpSkewXArray[2]-Math.PI,e.isEqual(e.tmpSkewXArray[0],e.tmpSkewXArray[2])||e.isEqual(e.tmpSkewXArray[0],e.tmpSkewXArray[3])?i.skewX=e.tmpSkewXArray[0]:i.skewX=e.tmpSkewXArray[1],e.tmpSkewYArray[0]=Math.acos(t.a/a),e.tmpSkewYArray[1]=-e.tmpSkewYArray[0],e.tmpSkewYArray[2]=Math.asin(t.b/a),e.tmpSkewYArray[3]=e.tmpSkewYArray[2]>=0?Math.PI-e.tmpSkewYArray[2]:e.tmpSkewYArray[2]-Math.PI,e.isEqual(e.tmpSkewYArray[0],e.tmpSkewYArray[2])||e.isEqual(e.tmpSkewYArray[0],e.tmpSkewYArray[3])?i.skewY=e.tmpSkewYArray[0]:i.skewY=e.tmpSkewYArray[1]},e.HALF_PI=.5*Math.PI,e.DOUBLE_PI=2*Math.PI,e._helpTransformMatrix=new t.Matrix,e._helpParentTransformMatrix=new t.Matrix,e.tmpSkewXArray=[],e.tmpSkewYArray=[],e.ACCURACY=1e-4,e._helpMatrix=new t.Matrix,e}();t.TransformUtil=e,egret.registerClass(e,"dragonBones.TransformUtil")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var a=(__define,i),n=a.prototype;return n._generateArmature=function(){var e=new t.Armature(new egret.DisplayObjectContainer);return e},n._generateSlot=function(){var e=new t.EgretSlot;return e},n._generateDisplay=function(t,e,i,a){var n=new egret.Bitmap;if(n.texture=t.getTexture(e),isNaN(i)||isNaN(a)){var s=t.getFrame(e);null!=s?(i=s.width/2,a=s.height/2):(i=n.width/2,a=n.height/2)}return n.anchorOffsetX=i,n.anchorOffsetY=a,n},n._generateFastArmature=function(){var e=new t.FastArmature(new egret.DisplayObjectContainer);return e},n._generateFastSlot=function(){var e=new t.EgretFastSlot(new egret.Bitmap);
return e},n._generateMesh=function(t,e,i,a){if("webgl"==egret.Capabilities.renderMode){var n=new egret.Mesh,s=n.$renderNode;n.texture=t.getTexture(e);var r=0,o=0,l=0;for(r=0,l=i.numVertex;l>r;r++){o=2*r;var h=i.vertices[r];s.uvs[o]=h.u,s.uvs[o+1]=h.v,s.vertices[o]=h.x,s.vertices[o+1]=h.y}for(r=0,l=i.triangles.length;l>r;r++)s.indices[r]=i.triangles[r];return a.isMeshEnabled=!0,n}var _=new egret.Bitmap;_.texture=t.getTexture(e);var u=t.getFrame(e),m=0,f=0;return null!=u?(m=u.width/2,f=u.height/2):(m=_.width/2,f=_.height/2),_.anchorOffsetX=m,_.anchorOffsetY=f,_},i}(t.BaseFactory);t.EgretFactory=e,egret.registerClass(e,"dragonBones.EgretFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(t){e.call(this,t),this._egretDisplay=null}__extends(i,e);var a=(__define,i),n=a.prototype;return n.dispose=function(){if(this._displayList)for(var i=this._displayList.length,a=0;i>a;a++){var n=this._displayList[a];n instanceof t.FastArmature&&n.dispose()}e.prototype.dispose.call(this),this._egretDisplay=null},n._updateDisplay=function(t){this._egretDisplay=t},n._addDisplay=function(){var t=this.armature.display;t.addChild(this._egretDisplay)},n._replaceDisplay=function(t){var e=this.armature.display,i=t;e.addChild(this._egretDisplay),e.swapChildren(this._egretDisplay,i),e.removeChild(i)},n._removeDisplay=function(){this._egretDisplay.parent.removeChild(this._egretDisplay)},n._getDisplayIndex=function(){return this._egretDisplay&&this._egretDisplay.parent?this._egretDisplay.parent.getChildIndex(this._egretDisplay):-1},n._addDisplayToContainer=function(t,e){void 0===e&&(e=-1);var i=t;this._egretDisplay&&i&&(0>e?i.addChild(this._egretDisplay):i.addChildAt(this._egretDisplay,Math.min(e,i.numChildren)))},n._removeDisplayFromContainer=function(){this._egretDisplay&&this._egretDisplay.parent&&this._egretDisplay.parent.removeChild(this._egretDisplay)},n._updateTransform=function(){this._displayIndex>=0&&this._egretDisplay.$setMatrix(this._globalTransformMatrix,!1)},n._updateDisplayVisible=function(t){},n._updateDisplayColor=function(t,i,a,n,s,r,o,l,h){void 0===h&&(h=!1),e.prototype._updateDisplayColor.call(this,t,i,a,n,s,r,o,l,h),this._egretDisplay&&this._egretDisplay.$setAlpha(s)},n._updateFrame=function(){var t=this._displayDataList.length,e=this._displayIndex<t?this._displayIndex:t-1,i=0>e?null:this._displayDataList[e][1],a=this._egretDisplay;if(i){var n=i.textureAtlas,s=this.displayDataList[this._displayIndex][0],r=i.frame||i.region,o=i.rotated?r.height:r.width,l=i.rotated?r.width:r.height,h=s.pivot.x==s.pivot.x?s.pivot.x:.5*o,_=s.pivot.y==s.pivot.y?s.pivot.y:.5*l;a.$visible||a.$setVisible(!0),a.$setBitmapData(n.getTexture(s.name)),a.$setAnchorOffsetX(h),a.$setAnchorOffsetY(_)}else a.$visible&&a.$setVisible(!1),a.$setBitmapData(null)},n._updateDisplayBlendMode=function(t){this._egretDisplay&&t&&(this._egretDisplay.blendMode=t)},i}(t.FastSlot);t.EgretFastSlot=e,egret.registerClass(e,"dragonBones.EgretFastSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e,i,a){void 0===a&&(a=1),this.texture=e,this.textureData=i,this._textureDatas={},this.scale=a,this.name=i[t.ConstValues.A_NAME],this.spriteSheet=new egret.SpriteSheet(e),this._textureDatas=i.frames}var i=(__define,e),a=i.prototype;return a.getTexture=function(t){var e=this.spriteSheet.getTexture(t);if(!e){var i=this._textureDatas[t];e=this.spriteSheet.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH)}return e},a.dispose=function(){this.texture=null},a.getRegion=function(t){var i=this._textureDatas[t];return i?e.Region:null},e.Region=new egret.Rectangle,e}();t.EgretSheetAtlas=e,egret.registerClass(e,"dragonBones.EgretSheetAtlas",["dragonBones.ITextureAtlas"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._egretDisplay=null}__extends(i,e);var a=(__define,i),n=a.prototype;return n.dispose=function(){if(this._displayList)for(var i=this._displayList.length,a=0;i>a;a++){var n=this._displayList[a];n instanceof t.Armature&&n.dispose()}e.prototype.dispose.call(this),this._egretDisplay=null},n._updateDisplay=function(t){this._egretDisplay=t},n._getDisplayIndex=function(){return this._egretDisplay&&this._egretDisplay.parent?this._egretDisplay.parent.getChildIndex(this._egretDisplay):-1},n._addDisplayToContainer=function(t,e){void 0===e&&(e=-1);var i=t;this._egretDisplay&&i&&(0>e?i.addChild(this._egretDisplay):i.addChildAt(this._egretDisplay,Math.min(e,i.numChildren)))},n._removeDisplayFromContainer=function(){this._egretDisplay&&this._egretDisplay.parent&&this._egretDisplay.parent.removeChild(this._egretDisplay)},n._updateTransform=function(){!this._egretDisplay||this._meshData&&this._meshData.skinned&&this.isMeshEnabled||this._egretDisplay.$setMatrix(this._globalTransformMatrix,!1)},n._updateDisplayVisible=function(t){this._egretDisplay&&this._parent&&(this._egretDisplay.visible=this._parent._visible&&this._visible&&t)},n._updateDisplayColor=function(t,i,a,n,s,r,o,l,h){void 0===h&&(h=!1),e.prototype._updateDisplayColor.call(this,t,i,a,n,s,r,o,l,h),this._egretDisplay&&(this._egretDisplay.alpha=s)},n._updateDisplayBlendMode=function(t){this._egretDisplay&&t&&(this._egretDisplay.blendMode=t)},n._calculateRelativeParentTransform=function(){this._global.scaleX=this._origin.scaleX*this._offset.scaleX,this._global.scaleY=this._origin.scaleY*this._offset.scaleY,this._global.skewX=this._origin.skewX+this._offset.skewX,this._global.skewY=this._origin.skewY+this._offset.skewY,this._global.x=this._origin.x+this._offset.x+this._parent._tweenPivot.x,this._global.y=this._origin.y+this._offset.y+this._parent._tweenPivot.y,this._displayDataList&&this._currentDisplayIndex>=0&&this._displayDataList[this._currentDisplayIndex]&&1==t.EgretTextureAtlas.rotatedDic[this._displayDataList[this._currentDisplayIndex].name]&&(this._global.skewX-=1.57,this._global.skewY-=1.57)},n._updateMesh=function(){if(this._meshData&&this.isMeshEnabled){var t=this._egretDisplay,e=t.$renderNode,i=0,a=0,n=0,s=0,r=0;if(this._meshData.skinned){var o=(this._armature.getBones(!1),0);for(i=0,n=this._meshData.numVertex;n>i;i++){var l=this._meshData.vertexBones[i],h=0,_=0,u=0;a=2*i,s=0,r=0;for(var m=0,f=l.indices.length;f>m;++m){var d=l.indices[m],c=this._meshBones[d],g=c._globalTransformMatrix,p=l.vertices[h],T=Number(l.weights[h]);!this._ffdVertices||o<this._ffdOffset||o>=this._ffdVertices.length?(_=p.x,u=p.y):(_=p.x+this._ffdVertices[o],u=p.y+this._ffdVertices[o+1]),s+=(g.a*_+g.c*u+g.tx)*T,r+=(g.b*_+g.d*u+g.ty)*T,h++,o+=2}e.vertices[a]=s,e.vertices[a+1]=r}t.$updateVertices(),t.$invalidateTransform()}else if(this._ffdChanged){for(this._ffdChanged=!1,i=0,n=this._meshData.numVertex;n>i;++i){var v=this._meshData.vertices[i];a=2*i,!this._ffdVertices||a<this._ffdOffset||a>=this._ffdVertices.length?(s=v.x,r=v.y):(s=Number(v.x)+this._ffdVertices[a-this._ffdOffset],r=Number(v.y)+this._ffdVertices[a-this._ffdOffset+1]),e.vertices[a]=s,e.vertices[a+1]=r}t.$updateVertices(),t.$invalidateTransform()}}},i}(t.Slot);t.EgretSlot=e,egret.registerClass(e,"dragonBones.EgretSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e,i,a){void 0===a&&(a=1),this.texture=e,this.textureAtlasRawData=i,this._textureDatas={},this.scale=a,this.name=i[t.ConstValues.A_NAME],this.parseData(i),this.spriteSheet=new egret.SpriteSheet(e)}var i=(__define,e),a=i.prototype;return a.getTexture=function(t){var i=this.spriteSheet.getTexture(t);if(!i){var a=this._textureDatas[t];if(a){var n=a.frame;i=n?this.spriteSheet.createTexture(t,a.region.x,a.region.y,a.region.width,a.region.height,-n.x,-n.y,n.width,n.height):this.spriteSheet.createTexture(t,a.region.x,a.region.y,a.region.width,a.region.height),a.rotated&&(e.rotatedDic[t]=1)}}return i},a.dispose=function(){this.texture=null},a.getRegion=function(e){var i=this._textureDatas[e];return i&&i instanceof t.TextureData?i.region:null},a.getFrame=function(e){var i=this._textureDatas[e];return i&&i instanceof t.TextureData?i.frame:null},a.getTextureData=function(t){return this._textureDatas[t]},a.parseData=function(e){this._textureDatas=t.DataParser.parseTextureAtlasData(e,this.scale)},e.rotatedDic={},e}();t.EgretTextureAtlas=e,egret.registerClass(e,"dragonBones.EgretTextureAtlas",["dragonBones.ITextureAtlas"])}(dragonBones||(dragonBones={}));